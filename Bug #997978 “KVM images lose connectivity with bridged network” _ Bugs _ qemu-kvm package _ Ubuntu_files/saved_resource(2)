/* lp/app/javascript/picker/team-min.js */

YUI.add('lp.app.picker.team',function(Y){var ns=Y.namespace('lp.app.picker.team');ns.TEAM_CREATED='teamCreated';ns.CANCEL_TEAM='cancelTeam';ns.CreateTeamForm=Y.Base.create("createTeamWidget",Y.Base,[],{initializer:function(cfg){this.publish(ns.TEAM_CREATED);this.publish(ns.CANCEL_TEAM);this.get('container').appendChild(this._get_template());this.error_handler=new Y.lp.client.FormErrorHandler({form:this.get('container')});var perform_load=false;if(!Y.Lang.isArray(ns.widgets)){perform_load=true;ns.widgets=[];}
ns.widgets.push(this);this._load_form(perform_load);},_get_template:function(){return['<div id=form-placeholder ','class="yui3-overlay-indicator-content">','<img src="/@@/spinner-big/">','</div>','<div class="extra-form-buttons hidden">','<button class="yes_button" type="submit" ','name="field.actions.create" value="Create Team">','Create Team</button>','<button class="no_button" type="button">Cancel</button>','</div>','</div>'].join('');},_load_form:function(perform_load){if(Y.Lang.isValue(ns.team_form)){this.render(ns.team_form,true);return;}
if(!perform_load){return;}
var on_success=function(id,response){ns.team_form=response.responseText;Y.Array.each(ns.widgets,function(widget){widget.render(ns.team_form,true);});};var on_failure=function(id,response){Y.Array.each(ns.widgets,function(widget){widget.render('Sorry, an error occurred while loading the form.',false);});};var cfg={on:{success:on_success,failure:on_failure}};var uri=Y.lp.client.get_absolute_uri('people/+simplenewteam/++form++');uri=uri.replace('api/devel','');this.get("io_provider").io(uri,cfg);},render:function(form_html,show_submit){var container=this.get('container');container.one('#form-placeholder').replace(form_html);var submit_button=container.one(".yes_button");if(show_submit){container.on('submit',function(e){e.halt();this._save_new_team();},this);}else{submit_button.addClass('hidden');}
container.one(".no_button").on('click',function(e){e.halt();this.fire(ns.CANCEL_TEAM);},this);this.membership_policy_edit=Y.lp.app.choice.addPopupChoice('membership_policy',LP.cache.team_membership_policy_data,{container:container,render_immediately:false,field_title:'membership policy'});container.one('.extra-form-buttons').removeClass('hidden');},show:function(){var form_elements=this.get('container').get('elements');if(form_elements.size()>0){form_elements.item(0).focus();}
this.membership_policy_edit.render();},hide:function(){this.error_handler.clearFormErrors();},_showSpinner:function(submit_link){var spinner_node=Y.Node.create('<img class="spinner" src="/@@/spinner" alt="Creating..." />');submit_link.insert(spinner_node,'after');},_hideSpinner:function(submit_link){var spinner=submit_link.get('parentNode').one('.spinner');if(!Y.Lang.isNull(spinner)){spinner.remove(true);}},_save_team_success:function(response,team_data){var value={"api_uri":"/~"+team_data['field.name'],"title":team_data['field.displayname'],"value":team_data['field.name'],"metadata":"team"};this.fire(ns.TEAM_CREATED,value);var container=this.get('container');container.all('button').detachAll();container.all('.spinner').remove(true);container.empty();container.appendChild(this._get_template());this.render(ns.team_form,true);},_save_new_team:function(){var that=this;var submit_link=Y.one("[name='field.actions.create']");this.error_handler.showError=function(error_msg){that._hideSpinner(submit_link);that.error_handler.handleFormValidationError(error_msg,[],[]);};var uri=Y.lp.client.get_absolute_uri('people/+simplenewteam');uri=uri.replace('api/devel','');var form_data={};var container=this.get('container');container.all("[name^='field.']").each(function(field){form_data[field.get('name')]=field.get('value');});form_data.id=container;var y_config={method:"POST",headers:{'Accept':'application/json;'},on:{start:function(){that.error_handler.clearFormErrors();that._showSpinner(submit_link);},end:function(){that._hideSpinner(submit_link);},failure:this.error_handler.getFailureHandler(),success:function(id,response,team_data){that._save_team_success(response,team_data);}},'arguments':form_data};y_config.form=form_data;this.get("io_provider").io(uri,y_config);}},{ATTRS:{container:{valueFn:function(){return Y.Node.create('<form/>');}},io_provider:{value:Y}}});},"0.1",{"requires":["base","node","lp.app.choice"]});
/* lp/app/javascript/picker/person_picker-min.js */

YUI.add('lp.ui.picker-person',function(Y){var ns=Y.namespace('lp.ui.picker');ns.PersonPicker=Y.Base.create('picker',Y.lp.ui.picker.Picker,[],{initializer:function(cfg){if(!Y.Lang.isValue(LP.links.me)){this.set('show_assign_me_button',false);}
if(this.get('show_create_team')){var ctns=Y.lp.app.picker.team;this.new_team_widget=new ctns.CreateTeamForm({io_provider:cfg.io_provider});this.new_team_widget.subscribe(ctns.CANCEL_TEAM,function(e){this.hide_new_team_form();},this);this.new_team_widget.subscribe(ctns.TEAM_CREATED,function(e){this.fire('save',e.details[0]);},this);}else{this.new_team_widget=null;}},hide:function(){this.get('boundingBox').setStyle('display','none');if(Y.Lang.isValue(this.new_team_widget)){this.new_team_widget.hide();this.hide_extra_content(this.new_team_widget.get('container'),false);}
Y.lp.ui.picker.Picker.prototype.hide.call(this);},show:function(){this.get('boundingBox').setStyle('display','block');Y.lp.ui.picker.Picker.prototype.show.call(this);},_update_button_text:function(){var link_text;if(this.get('selected_value_metadata')==='team'){link_text=this.get('remove_team_text');}else{link_text=this.get('remove_person_text');}
this.remove_button.set('text',link_text);},_show_hide_buttons:function(){var selected_value=this.get('selected_value');if(this.remove_button){if(selected_value===null){this.remove_button.addClass('yui3-picker-hidden');}else{this.remove_button.removeClass('yui3-picker-hidden');this._update_button_text();}}
if(this.assign_me_button){if(LP.links.me.match('~'+selected_value+"$")||LP.links.me===selected_value){this.assign_me_button.addClass('yui3-picker-hidden');}else{this.assign_me_button.removeClass('yui3-picker-hidden');}}},remove:function(){this.hide();this.fire('save',{value:null});},assign_me:function(){var name=LP.links.me.replace('/~','');this.fire('save',{image:'/@@/person',title:'Me',api_uri:LP.links.me,value:name});},show_new_team_form:function(){var form=this.new_team_widget.get('container');this.show_extra_content(form,"Enter new team details");this.new_team_widget.show();this.set('centered',true);},hide_new_team_form:function(){this.new_team_widget.hide();var form=this.new_team_widget.get('container');this.hide_extra_content(form);this.set('centered',true);},_assign_me_button_html:function(){return['<a class="yui-picker-assign-me-button sprite person ','js-action" href="javascript:void(0)" ','style="padding-right: 1em">',this.get('assign_me_text'),'</a>'].join('');},_remove_button_html:function(){return['<a class="yui-picker-remove-button sprite remove ','js-action" href="javascript:void(0)" ','style="padding-right: 1em">',this.get('remove_person_text'),'</a>'].join('');},_new_team_button_html:function(){return['<a class="yui-picker-new-team-button sprite add ','js-action" href="javascript:void(0)">','New Team','</a>'].join('');},renderUI:function(){Y.lp.ui.picker.Picker.prototype.renderUI.apply(this,arguments);var extra_buttons=this.get('extra_buttons');var remove_button,assign_me_button,new_team_button;if(this.get('show_remove_button')){remove_button=Y.Node.create(this._remove_button_html());remove_button.on('click',this.remove,this);extra_buttons.appendChild(remove_button);this.remove_button=remove_button;}
if(this.get('show_assign_me_button')){assign_me_button=Y.Node.create(this._assign_me_button_html());assign_me_button.on('click',this.assign_me,this);extra_buttons.appendChild(assign_me_button);this.assign_me_button=assign_me_button;}
if(this.get('show_create_team')){new_team_button=Y.Node.create(this._new_team_button_html());new_team_button.on('click',this.show_new_team_form,this);extra_buttons.appendChild(new_team_button);}
this._search_input.insert(extra_buttons,this._search_input.get('parentNode'));this._show_hide_buttons();this.after("selected_valueChange",function(e){this._show_hide_buttons();});}},{ATTRS:{extra_buttons:{valueFn:function(){return Y.Node.create('<div class="extra-form-buttons"/>');}},show_assign_me_button:{value:true},show_remove_button:{value:true},assign_me_text:{value:'Pick me'},remove_person_text:{value:'Remove person'},remove_team_text:{value:'Remove team'},min_search_chars:{value:2},show_create_team:{value:false}}});},"0.1",{"requires":["base","node","lp.ui.picker-base","lp.app.picker.team"]});
/* lp/app/javascript/picker/picker_patcher-min.js */

YUI.add('lp.app.picker',function(Y){var namespace=Y.namespace('lp.app.picker');var BATCH_SIZE=6;var MAX_BATCHES=20;var _addPicker=function(config,show_widget_id){var picker=null;var vocabulary=config.vocabulary_name;var vocabulary_filters=config.vocabulary_filters;var input_element=config.input_element;var show_widget_node=Y.one('#'+show_widget_id);if(!Y.Lang.isValue(show_widget_node)){return;}
if(show_widget_node.hasClass('js-action')){return;}
var picker_span=show_widget_node.get('parentNode');show_widget_node=Y.Node.create('<a href="#" class="sprite search-icon action-icon js-action">'+'Choose\u2026'+'</a>');show_widget_node.set('id',show_widget_id);picker_span.empty();picker_span.appendChild(show_widget_node);picker_span.removeClass('hidden');show_widget_node.on('click',function(e){if(picker===null){picker=namespace.create(vocabulary,config,input_element,vocabulary_filters);}
picker.show();e.preventDefault();});};namespace.addPicker=function(config,show_widget_id){_addPicker(config,show_widget_id);Y.on('lp.widget.connect',function(e){_addPicker(config,show_widget_id);});};namespace.reconnectPicker=function(show_widget_id){Y.fire('lp.widget.connect');};namespace.addPickerPatcher=function(vocabulary,resource_uri,attribute_name,content_box_id,config){var null_display_value='None';var show_search_box=true;var vocabulary_filters;resource_uri=Y.lp.client.normalize_uri(resource_uri);if(config!==undefined){if(config.null_display_value!==undefined){null_display_value=config.null_display_value;}
if(config.show_search_box!==undefined){show_search_box=config.show_search_box;}
vocabulary_filters=config.vocabulary_filters;}
var content_box=Y.one('#'+content_box_id);var activator=new Y.lp.ui.activator.Activator({contentBox:content_box});var failure_handler=function(xid,response,args){activator.renderFailure(Y.Node.create('<div>'+response.statusText+'<pre>'+response.responseText+'</pre>'+'</div>'));};var save=function(picker_result){activator.renderProcessing();var success_handler=function(entry){var to_render=null_display_value;var selected_value=null;if(entry.get(attribute_name)!==null){to_render=entry.getHTML(attribute_name);selected_value=picker_result.api_uri;}
picker.set('selected_value_metadata',picker_result.metadata);picker.set('selected_value',selected_value);activator.renderSuccess(to_render);};var patch_payload={};if(Y.Lang.isValue(picker_result.api_uri)){patch_payload[attribute_name]=Y.lp.client.get_absolute_uri(picker_result.api_uri);}else{patch_payload[attribute_name]=null;}
var client=new Y.lp.client.Launchpad();client.patch(picker._resource_uri,patch_payload,{accept:'application/json;include=lp_html',on:{success:success_handler,failure:failure_handler}});};config.save=save;var picker=namespace.create(vocabulary,config,undefined,vocabulary_filters);picker._resource_uri=resource_uri;if(!show_search_box){config.temp_spinner=create_temporary_spinner(picker);}
activator.subscribe('act',function(e){if(!show_search_box){config.temp_spinner.removeClass('hidden');picker.set('min_search_chars',0);picker.fire('search','');picker.get('contentBox').one('.yui3-picker-search-box').addClass('hidden');}
picker.show();});activator.render();return picker;};function create_temporary_spinner(picker){var node=picker.get('contentBox').one('.yui3-picker-batches');var temp_spinner=Y.Node.create(['<div class="hidden" align="center">','<img src="/@@/spinner"/>Loading...','</div>'].join(''));node.insert(temp_spinner,node);return temp_spinner;}
function hide_temporary_spinner(temp_spinner){if(temp_spinner!==undefined&&temp_spinner!==null){temp_spinner.addClass('hidden');}}
namespace.yesno_save_confirmation=function(picker,content,yes_label,no_label,yes_fn,no_fn){var existing_validation=picker.get('contentBox').one('.validation-node');if(existing_validation!==null){existing_validation.remove(true);}
var node=Y.Node.create(['<div class="validation-node">','<div class="validation-content-placeholder"></div>','<div class="extra-form-buttons">','<button class="yes_button" type="button"></button>','<button class="no_button" type="button"></button>','</div>','</div>'].join(''));var button_callback=function(e,callback_fn){e.halt();if(Y.Lang.isFunction(callback_fn)){callback_fn();}};node.one(".yes_button").set('text',yes_label).on('click',function(e){button_callback(e,yes_fn);});node.one(".no_button").set('text',no_label).on('click',function(e){button_callback(e,no_fn);});node.one(".validation-content-placeholder").replace(content);picker.show_extra_content(node);};namespace.public_private_warning=function(picker,picker_result,do_save,do_cancel){var client=new Y.lp.client.Launchpad();var config={on:{success:function(person){var private_person=person.get('private');var public_context=true;if(LP.cache.context.private!==undefined){public_context=!(LP.cache.context.private);}
if(private_person&&public_context){var yesno_content="<p>This action will reveal this team's name to "+"the public.</p>";Y.lp.app.picker.yesno_save_confirmation(picker,yesno_content,'Continue','Choose Again',do_save,do_cancel);}else{do_save();}}}};client.get(picker_result.api_uri,config);};function reset_form(picker){var validation_node=picker.get('contentBox').one('.validation-node');picker.hide_extra_content(validation_node);if(Y.Lang.isValue(validation_node)){validation_node.remove(true);}}
namespace.connect_select_menu=function(select_menu,text_input){if(Y.Lang.isValue(select_menu)){var copy_selected_value=function(e){text_input.value=select_menu.value;};Y.on('change',copy_selected_value,select_menu);}};namespace._chained_validator=function(validators,picker,picker_result,do_save,do_cancel){if(validators.length===0){do_save();return;}
var validator_callback=validators.pop();validator_callback(picker,picker_result,function(){namespace._chained_validator(validators,picker,picker_result,do_save,do_cancel);},do_cancel);};namespace.create=function(vocabulary,config,associated_field_id,vocabulary_filters){var header='Choose an item.';var step_title="Enter search terms";var picker_type="default";if(config!==undefined){if(config.header!==undefined){header=config.header;}
if(config.step_title!==undefined){step_title=config.step_title;}
if(config.picker_type!==undefined){picker_type=config.picker_type;}}else{config={};}
var new_config=Y.merge(config,{associated_field_id:associated_field_id,align:{points:[Y.WidgetPositionAlign.CC,Y.WidgetPositionAlign.CC]},progressbar:true,progress:100,headerContent:Y.Node.create("<h2></h2>").set('text',header),steptitle:step_title,zIndex:1000,visible:false,filter_options:vocabulary_filters});var picker=null;if(picker_type==='person'){picker=new Y.lp.ui.picker.PersonPicker(new_config);}else{picker=new Y.lp.ui.picker.Picker(new_config);}
namespace.setup_vocab_picker(picker,vocabulary,config);return picker;};namespace.setup_vocab_picker=function(picker,vocabulary,config){var show_search_box=true;if(config!==undefined){if(config.show_search_box!==undefined){show_search_box=config.show_search_box;}}
if(!Y.Lang.isString(vocabulary)&&!Y.Lang.isObject(vocabulary)){throw new TypeError("vocabulary argument for Y.lp.picker.setup_vocab_picker() "+"must be a string or associative array: "+vocabulary);}
picker.publish('save',{defaultFn:function(){}});var user_has_searched=false;picker.subscribe('validate',function(e){e.preventDefault();var picker_result=e.details[Y.lp.ui.picker.Picker.SAVE_RESULT];var validation_callbacks=[];var config_validate_callbacks=config.validate_callback;if(Y.Lang.isArray(config_validate_callbacks)){Y.Array.forEach(config_validate_callbacks,function(callback){validation_callbacks.push(callback);});}else if(Y.Lang.isFunction(config_validate_callbacks)){validation_callbacks.push(config_validate_callbacks);}
var val_ns=Y.namespace('lp.app.picker.validation');var other_validate_callbacks=val_ns[config.show_widget_id];if(Y.Lang.isArray(other_validate_callbacks)){Y.Array.forEach(other_validate_callbacks,function(callback){validation_callbacks.push(callback);});}else if(Y.Lang.isFunction(other_validate_callbacks)){validation_callbacks.push(other_validate_callbacks);}
var do_save=function(){picker.fire('save',e);};namespace._chained_validator(validation_callbacks,picker,picker_result,do_save,function(){reset_form(picker);});});var save_handler=function(e){Y.log('Got save event.');var picker_result=e.details[Y.lp.ui.picker.Picker.SAVE_RESULT];user_has_searched=false;reset_form(picker);picker.hide();if(Y.Lang.isFunction(config.save)){config.save(picker_result);}
picker._defaultSave(e);};picker.after('save',save_handler);picker.subscribe('cancel',function(e){Y.log('Got cancel event.');reset_form(picker);user_has_searched=false;});if(Y.Object.owns(config,'extra_no_results_message')&&Y.Lang.isValue(config.extra_no_results_message)){picker.before('resultsChange',function(e){var new_results=e.details[0].newVal;if(new_results.length===0){picker.set('footer_slot',Y.Node.create(config.extra_no_results_message));}else{picker.set('footer_slot',null);}});}
var search_handler=function(e){Y.log('Got search event:'+Y.dump(e.details));var search_text=e.details[0];var selected_batch=e.details[1]||0;var automated_search=e.details[2]||false;var search_filter=e.details[3];var start=BATCH_SIZE*selected_batch;var batch=0;user_has_searched=user_has_searched||!automated_search;var display_vocabulary=function(results,total_size,start){var max_size=MAX_BATCHES*BATCH_SIZE;if(show_search_box&&total_size>max_size){picker.set('error','Only displaying first '+max_size+' of '+
total_size+' matches.');results.length=max_size;total_size=max_size;}
picker.set('results',results);if(e.details[1]===undefined){var batches=[];var stop=Math.ceil(total_size/BATCH_SIZE);if(stop>1){for(batch=0;batch<stop;batch++){batches.push({name:batch+1,value:batch});}}
picker.set('batches',batches);}};if(typeof vocabulary==='string'){var success_handler=function(ignore,response,args){var entry=Y.JSON.parse(response.responseText);var total_size=entry.total_size;var start=entry.start;var results=entry.entries;hide_temporary_spinner(config.temp_spinner);if(user_has_searched!==automated_search){display_vocabulary(results,total_size,start);}};var failure_handler=function(ignore,response,args){Y.log("Loading "+uri+" failed.");hide_temporary_spinner(config.temp_spinner);if(user_has_searched===automated_search){return;}
var base_error="Sorry, something went wrong with your search.";if(response.status===500){base_error+=" We've recorded what happened, and we'll fix it "+"as soon as possible.";}else if(response.status>=502&&response.status<=504){base_error+=" Trying again in a couple of minutes might work.";}
var oops_id=response.getResponseHeader('X-Lazr-OopsId');if(oops_id){base_error+=' (Error ID: '+oops_id+')';}
picker.set('error',base_error);picker.set('search_mode',false);};var qs='';qs=Y.lp.client.append_qs(qs,'name',vocabulary);qs=Y.lp.client.append_qs(qs,'search_text',search_text);if(Y.Lang.isValue(search_filter)){qs=Y.lp.client.append_qs(qs,'search_filter',search_filter);}
qs=Y.lp.client.append_qs(qs,'batch',BATCH_SIZE);qs=Y.lp.client.append_qs(qs,'start',start);var uri='';if(Y.Lang.isFunction(config.getContextPath)){uri+=config.getContextPath()+'/';}else if(Y.Lang.isValue(config.context)){uri+=Y.lp.get_url_path(config.context.get('web_link'))+'/';}
uri+='@@+huge-vocabulary?'+qs;var yio=(config.yio!==undefined)?config.yio:Y;yio.io(uri,{headers:{'Accept':'application/json'},timeout:20000,on:{success:success_handler,failure:failure_handler}});}else{display_vocabulary(vocabulary,Y.Object.size(vocabulary),1);}};picker.after('search',search_handler);picker.render();picker.hide();return picker;};},"0.1",{"requires":["io","dom","dump","event","json-parse","lp.client","lp.ui.activator","lp.ui.picker-base","lp.ui.picker-person"]});
/* yui/substitute/substitute-min.js */
YUI.add("substitute",function(e,t){var n=e.Lang,r="dump",i=" ",s="{",o="}",u=/(~-(\d+)-~)/g,a=/\{LBRACE\}/g,f=/\{RBRACE\}/g,l=function(t,l,c,h){var p,d,v,m,g,y,b=[],w,E,S=t.length;for(;;){p=t.lastIndexOf(s,S);if(p<0)break;d=t.indexOf(o,p);if(p+1>=d)break;w=t.substring(p+1,d),m=w,y=null,v=m.indexOf(i),v>-1&&(y=m.substring(v+1),m=m.substring(0,v)),g=l[m],c&&(g=c(m,g,y)),n.isObject(g)?e.dump?n.isArray(g)?g=e.dump(g,parseInt(y,10)):(y=y||"",E=y.indexOf(r),E>-1&&(y=y.substring(4)),g.toString===Object.prototype.toString||E>-1?g=e.dump(g,parseInt(y,10)):g=g.toString()):g=g.toString():n.isUndefined(g)&&(g="~-"+b.length+"-~",b.push(w)),t=t.substring(0,p)+g+t.substring(d+1),h||(S=p-1)}return t.replace(u,function(e,t,n){return s+b[parseInt(n,10)]+o}).replace(a,s).replace(f,o)};e.substitute=l,n.substitute=l},"3.10.3",{requires:["yui-base"],optional:["dump"]});

/* lp/app/javascript/errors-min.js */

YUI.add('lp.app.errors',function(Y){var namespace=Y.namespace('lp.app.errors');var cancel_form_button=function(){var button=Y.Node.create('<button>OK</button>');button.on('click',function(e){e.preventDefault();error_overlay.hide();});return button;};var error_overlay;var create_error_overlay=function(){if(error_overlay===undefined||!Y.Lang.isValue(error_overlay.get('boundingBox').get('parentNode'))){error_overlay=new Y.lp.ui.FormOverlay({headerContent:'<h2>Error</h2>',form_header:'',form_content:'',form_submit_button:Y.Node.create('<button style="display:none"></button>'),form_cancel_button:cancel_form_button(),centered:true,visible:false});error_overlay.render();}};var maybe_red_flash=function(flash_node,callback)
{if(flash_node){var anim=Y.lp.anim.red_flash({node:flash_node});anim.on('end',callback);anim.run();}else{callback();}};namespace.display_error=function(flash_node,msg){create_error_overlay();maybe_red_flash(flash_node,function(){error_overlay.showError(msg);error_overlay.show();});};var info_overlay;namespace.display_info=function(msg){if(info_overlay===undefined){info_overlay=new Y.lp.ui.PrettyOverlay({centered:true,visible:false});info_overlay.render();}
var content=Y.Node.create('<div style="background: url(/@@/info-large) no-repeat; '+'min-height: 32px; padding-left: 40px; padding-top: 16px"/></div>');content.appendChild(Y.Node.create(msg));var button_div=Y.Node.create('<div style="text-align: right"></div>');var ok_button=Y.Node.create('<button>OK</button>');ok_button.on('click',function(e){info_overlay.fire('cancel');});button_div.appendChild(ok_button);content.appendChild(button_div);info_overlay.set('bodyContent',content);info_overlay.show();};},"0.1",{"requires":["lp.ui.formoverlay","lp.ui.overlay","lp.anim"]});
/* lp/bugs/javascript/bug_subscription_portlet-min.js */

YUI.add('lp.bugs.bugtask_index.portlets.subscription',function(Y){var namespace=Y.namespace('lp.bugs.bugtask_index.portlets.subscription');function tag(name){return Y.Node.create('<'+name+'/>');}
function make_link(text,css_class){return tag('a').set('href','#').addClass('sprite').addClass('modify').addClass(css_class).set('text',text);}
function ws(){return Y.Node.create('<span> </span>');}
function lp_client(){if(!Y.Lang.isValue(namespace._lp_client)){namespace._lp_client=new Y.lp.client.Launchpad();}
return namespace._lp_client;}
var MUTED_CLASS=namespace.MUTED_CLASS='unmute';var UNMUTED_CLASS=namespace.UNMUTED_CLASS='mute';function update_subscription_status(skip_animation){var status=Y.one('#current_user_subscription');var span=status.one('span');var whitespace=status.one('span+span');var link=status.one('a');var mute_link=Y.one('.menu-link-mute_subscription');var is_muted=(Y.Lang.isValue(mute_link)&&mute_link.hasClass(MUTED_CLASS));var messages=LP.cache.notifications_text;if(is_muted){span.set('text',messages.muted);if(Y.Lang.isValue(link)){link.remove();}
if(Y.Lang.isValue(whitespace)){whitespace.remove();}}else{if(!Y.Lang.isValue(link)){if(!Y.Lang.isValue(whitespace)){status.appendChild(ws());}
link=tag('a').addClass('menu-link-subscription').addClass('sprite').addClass('modify').addClass('edit');link.set('href',LP.cache.context.web_link+'/+subscribe');status.appendChild(link);setup_subscription_link_handlers();}
span.set('text',messages.not_only_other_subscription);if(Y.Lang.isUndefined(LP.cache.subscription)){if(LP.cache.other_subscription_notifications){span.set('text',messages.only_other_subscription);}
link.set('text',messages.not_direct);}else{switch(LP.cache.subscription.bug_notification_level){case'Discussion':link.set('text',messages.direct_all);break;case'Details':link.set('text',messages.direct_metadata);break;case'Lifecycle':link.set('text',messages.direct_lifecycle);break;default:Y.error('Programmer error: unknown bug notification level: '+
LP.cache.subscription.bug_notification_level);}}}
if(!Y.Lang.isBoolean(skip_animation)||!skip_animation){Y.lp.anim.green_flash({node:status}).run();}}
namespace.update_subscription_status=update_subscription_status;function setup_mute_link_handlers(){var link=Y.one('.menu-link-mute_subscription');if(Y.Lang.isNull(link)){return;}
link.addClass('js-action');link.on('click',function(e){e.halt();var subscribe_link=Y.one('#current_user_subscription a');if(link.hasClass('spinner')||(Y.Lang.isValue(subscribe_link)&&subscribe_link.hasClass('spinner'))){return;}
var is_muted=link.hasClass(MUTED_CLASS);var method_name,current_class,destination_class,destination_text;var destination_title;if(is_muted){method_name='unmute';current_class=MUTED_CLASS;destination_class=UNMUTED_CLASS;destination_text='Mute bug mail';destination_title='Mute this bug so that you will not receive emails about it.';}else{method_name='mute';current_class=UNMUTED_CLASS;destination_class=MUTED_CLASS;destination_text='Unmute bug mail';destination_title='Unmute this bug so that you will receive emails about it.';}
link.replaceClass(current_class,'spinner');var handler=new Y.lp.client.ErrorHandler();handler.showError=function(error_msg){Y.lp.app.errors.display_error(link.get('parentNode'),error_msg);};handler.clearProgressUI=function(){link.replaceClass('spinner',current_class);};var config={on:{success:function(response){link.replaceClass('spinner',destination_class);link.set('text',destination_text);link.set('title',destination_title);update_subscription_status();Y.lp.anim.green_flash({node:link.get('parentNode')}).run();},failure:handler.getFailureHandler()},parameters:{}};lp_client().named_post(LP.cache.context.bug_link,method_name,config);});}
namespace.setup_mute_link_handlers=setup_mute_link_handlers;function setup_subscription_link_handlers(){var link=Y.one('#current_user_subscription a');if(!Y.Lang.isValue(link)){return;}
link.addClass('js-action');var mute_link=Y.one('.menu-link-mute_subscription');var mute_div=mute_link.get('parentNode');var overlay;var clean_up=function(){overlay.hide();overlay.destroy();link.replaceClass('spinner','edit');};var make_action_on_click=function(e,method_name,css_class,parameters){var active_link=e.currentTarget;active_link.replaceClass(css_class,'spinner');var handler=new Y.lp.client.ErrorHandler();handler.showError=function(error_msg){Y.lp.app.errors.display_error(active_link.get('parentNode'),error_msg);};handler.clearProgressUI=function(){active_link.replaceClass('spinner',css_class);};var config={on:{success:function(response){if(Y.Lang.isValue(response)){LP.cache.subscription=response.getAttrs();}
if(method_name==='mute'){mute_link.replaceClass(UNMUTED_CLASS,MUTED_CLASS);mute_link.set('text','Unmute bug mail');Y.lp.anim.green_flash({node:mute_link.get('parentNode')}).run();}else if(method_name==='unsubscribe'){delete LP.cache.subscription;if(!LP.cache.other_subscription_notifications){mute_div.addClass('hidden');}}else if(method_name==='subscribe'){mute_div.removeClass('hidden');}
active_link.replaceClass('spinner',css_class);update_subscription_status();clean_up();},failure:handler.getFailureHandler()},parameters:parameters};lp_client().named_post(LP.cache.context.bug_link,method_name,config);};var make_action=function(text,css_class,method_name,parameters){var result=make_link(text,css_class).addClass('js-action');result.on('click',function(e){e.halt();var method_call=function(){make_action_on_click(e,method_name,css_class,parameters);};var is_private=Y.Lang.isBoolean(LP.cache.bug_is_private)&&LP.cache.bug_is_private;var private_bug_warning=function(){var private_bug_warning_node=Y.Node.create(['<div class="private-bug-warning"><p>You will not ','have access to this bug or any of its pages if you ','unsubscribe. If you want to stop emails, choose the ','"Mute bug mail" option.</p>','<p>Do you really want to unsubscribe from this bug?','</p><div class="extra-form-buttons">','<button class="ok-btn" ','type="submit">Unsubscribe</button>','<button class="cancel-btn" ','type="button">Cancel</button></div></div>'].join(''));var remove_div=Y.one('.remove-direct-subscription');var ok_btn=private_bug_warning_node.one('.ok-btn');ok_btn.on('click',function(internal_e){e.halt();method_call();});var cancel_btn=private_bug_warning_node.one('.cancel-btn');cancel_btn.on('click',function(){private_bug_warning_node.remove();});remove_div.insert(private_bug_warning_node,'after');};if(is_private&&method_name==='unsubscribe'){private_bug_warning();}else{method_call();}});return result;};var header=tag('h2').setStyle('display','block').setStyle('overflow','hidden').setStyle('textOverflow','ellipsis').setStyle('whiteSpace','nowrap').setStyle('width','21em');var status_node=tag('div').addClass('subscription-status').setStyle('margin-top','1em').append(tag('span').addClass('Discussion').set('text','You currently receive all emails about this bug.')).append(tag('span').addClass('Details').set('text','You currently receive all emails about this bug '+'except comments.')).append(tag('span').addClass('Lifecycle').set('text','You currently only receive email when this bug is closed.'));var actions_node=tag('div').addClass('subscription-actions').setStyle('margin-top','1em').append(tag('div').addClass('Discussion').append(make_action('Receive all emails about this bug','edit','subscribe',{person:LP.links.me,level:'Discussion'}))).append(tag('div').addClass('Details').append(make_action('Receive all emails about this bug except comments','edit','subscribe',{person:LP.links.me,level:'Details'}))).append(tag('div').addClass('Lifecycle').append(make_action('Only receive email when this bug is closed','edit','subscribe',{person:LP.links.me,level:'Lifecycle'})));var unsubscribe_node=tag('div').setStyle('margin-top','1.5em').addClass('remove-direct-subscription').append(make_action('Remove your direct subscription','remove','unsubscribe',{}));link.on('click',function(e){e.halt();if(link.hasClass('spinner')||mute_link.hasClass('spinner')){return;}
link.replaceClass('edit','spinner');var body=tag('div');actions_node.all('a').removeClass('hidden');status_node.all('span').addClass('hidden');if(Y.Lang.isValue(LP.cache.subscription)){header.set('text','Change your mail subscription for this bug');var class_id='.'+LP.cache.subscription.bug_notification_level;actions_node.one(class_id+' a').addClass('hidden');status_node.one('span'+class_id).removeClass('hidden');body.append(status_node).append(actions_node).append(unsubscribe_node);}else{header.set('text','Add a mail subscription for this bug');body.append(actions_node);}
overlay=new Y.lp.ui.PrettyOverlay({headerContent:header,bodyContent:body,visible:false,centered:true});overlay.on('cancel',clean_up);overlay.render();overlay.show();});}
namespace.setup_subscription_link_handlers=setup_subscription_link_handlers;namespace.initialize=function(){if(Y.Lang.isUndefined(LP.links.me)){return;}
setup_subscription_link_handlers();setup_mute_link_handlers();};},'0.1',{requires:['dom','event','node','substitute','lp.ui.effects','lp.ui.overlay','lp.app.errors','lp.client']});
/* lp/app/javascript/confirmationoverlay/confirmationoverlay-min.js */

YUI.add('lp.app.confirmationoverlay',function(Y){var NAME='lp-app-confirmationoverlay';function ConfirmationOverlay(config){ConfirmationOverlay.superclass.constructor.apply(this,arguments);}
ConfirmationOverlay.NAME=NAME;ConfirmationOverlay.ATTRS={button:{value:null},submit_form:{value:null},submit_fn:{value:null},form_content_fn:{value:null},header_content_fn:{value:null},display_confirmation_fn:{value:null},submit_text:{value:'OK'},cancel_text:{value:'Cancel'}};Y.extend(ConfirmationOverlay,Y.lp.ui.FormOverlay,{initializer:function(cfg){var submit_button=Y.Node.create('<button type="submit" class="ok-btn" />').set("text",this.get('submit_text'));var cancel_button=Y.Node.create('<button type="button" class="cancel-btn" />').set("text",this.get('cancel_text'));this.set('form_submit_button',submit_button);this.set('form_cancel_button',cancel_button);var self=this;var submit_fn=this.get('submit_fn');if(submit_fn===null){var submit_form=function(){self._createHiddenDispatcher();self._submitForm();};this.set('form_submit_callback',submit_form);}
else{var submit_form_fn=function(){self.hide();submit_fn();};this.set('form_submit_callback',submit_form_fn);}
var button=this.get('button');if(Y.Lang.isValue(button)){this.set('submit_form',this.get('button').ancestor('form'));button.set('disabled',false);button.on('click',Y.bind(this._handleButtonClicked,this));}
this.hide();},_submitForm:function(){this.get('submit_form').submit();},show:function(){this._renderUIFormOverlay();this._fillContent();this._positionOverlay();this._setFormContent();this.render();ConfirmationOverlay.superclass.show.call(this);},_handleButtonClicked:function(e){var display_confirmation_fn=this.get('display_confirmation_fn');if(display_confirmation_fn===null||display_confirmation_fn()){e.preventDefault();this.show();}},_fillContent:function(){var form_content_fn=this.get('form_content_fn');if(form_content_fn!==null){var content=form_content_fn();if(content instanceof Y.Node){content=content.get('innerHTML');}
this.set('form_content',content);}
var header_content_fn=this.get('header_content_fn');if(header_content_fn!==null){this.set('headerContent',header_content_fn());}},_positionOverlay:function(){this.set('align',{points:[Y.WidgetPositionAlign.CC,Y.WidgetPositionAlign.CC]});},_createHiddenDispatcher:function(){var dispatcher=Y.Node.create('<input>').set('type','hidden').addClass('hidden-input').set('name',this.get('button').get('name')).set('value',this.get('button').get('value'));this.get('submit_form').append(dispatcher);}});var namespace=Y.namespace('lp.app.confirmationoverlay');namespace.ConfirmationOverlay=ConfirmationOverlay;},"0.1",{"skinnable":true,"requires":["lp.ui.formoverlay"]});
/* lp/bugs/javascript/bug_picker-min.js */

YUI.add('lp.bugs.bug_picker',function(Y){var namespace=Y.namespace('lp.bugs.bug_picker');namespace.BugPicker=Y.Base.create("bugPickerWidget",Y.lp.ui.picker.Picker,[],{initializer:function(cfg){this.bug_details_node=null;this.save_button=null;this.io_provider=Y.lp.client.get_configured_io_provider(cfg);var that=this;this.after('search',function(e){var bug_id=e.details[0];that._find_bug({id:bug_id});});},_save_button_html:function(){return['<button type="button" name="field.actions.save">',this.get('save_link_text'),'</button>'].join('');},_remove_link_html:function(){return['<div class="centered">','<a class="sprite remove ','js-action" href="javascript:void(0)">',this.get('remove_link_text'),'</a></div>'].join('');},hide:function(){this.get('boundingBox').setStyle('display','none');Y.lp.ui.picker.Picker.prototype.hide.call(this);},show:function(){this.get('boundingBox').setStyle('display','block');Y.lp.ui.picker.Picker.prototype.show.call(this);},_bug_search_header:function(){return this._remove_link_html();},_xaxis_centre:function(){var viewport=Y.DOM.viewportRegion();var new_x=(viewport.right+viewport.left)/2-
this.get('contentBox').get('offsetWidth')/2;this.move([new_x,this._getY()]);},renderUI:function(){Y.lp.ui.picker.Picker.prototype.renderUI.apply(this,arguments);var search_header=Y.Node.create(this._bug_search_header());var search_node=this._search_input.get('parentNode');search_node.insert(search_header,'before');this.remove_link=search_node.get('parentNode').one('a.remove');},bindUI:function(){Y.lp.ui.picker.Picker.prototype.bindUI.apply(this,arguments);var that=this;if(Y.Lang.isValue(this.remove_link)){this.remove_link.on('click',function(e){e.halt();that.fire(namespace.BugPicker.REMOVE);});}
this.after('visibleChange',function(){if(!this.get('visible')){that._hide_bug_results();}else{if(Y.Lang.isValue(that.remove_link)&&that.get('remove_link_visible')){that.remove_link.removeClass('hidden');}else{that.remove_link.addClass('hidden');}}});},_show_bug_spinner:function(node){if(Y.Lang.isValue(node)){node.addClass('update-in-progress-message');node.set('disabled',true);}},_hide_bug_spinner:function(node){if(Y.Lang.isValue(node)){node.removeClass('update-in-progress-message');node.set('disabled',false);}},_find_bug:function(data){var bug_id=parseInt(Y.Lang.trim(data.id),10);if(isNaN(bug_id)){this.set('error','Please enter a valid bug number.');return;}
var qs_data=Y.lp.client.append_qs("","ws.accept","application.json");qs_data=Y.lp.client.append_qs(qs_data,"ws.op","getBugData");qs_data=Y.lp.client.append_qs(qs_data,"bug_id",bug_id);if(Y.Lang.isValue(LP.cache.bug)){qs_data=Y.lp.client.append_qs(qs_data,"related_bug",LP.cache.bug.self_link);}
var that=this;var config={on:{end:function(){that.set('search_mode',false);},success:function(id,response){if(response.responseText===''){return;}
var bug_data=Y.JSON.parse(response.responseText);if(!Y.Lang.isArray(bug_data)||bug_data.length===0){var error_msg=bug_id+' is not a valid bug number.';that._hide_bug_results();that.set('error',error_msg);return;}
that.set('results',bug_data);},failure:function(id,response){that._hide_bug_results();that.set('error',response.responseText);}},data:qs_data};var uri=Y.lp.client.get_absolute_uri("/api/devel/bugs");this.io_provider.io(uri,config);},_bug_details_template:function(){return['<table class="confirm-bug-details"><tbody><tr><td>','<div id="client-listing">','  <div class="buglisting-col1">','      <div class="importance {{importance_class}}">','          {{importance}}','      </div>','      <div class="status {{status_class}}">','          {{status}}','      </div>','      <div class="buginfo-extra">','              <div class="information_type">','                  {{information_type}}','              </div>','      </div>','  </div>','  <div class="buglisting-col2">','  <a href="{{bug_url}}" class="bugtitle sprite new-window" ','  style="padding-top: 3px">','  <p class="ellipsis single-line">','  <span class="bugnumber">#{{id}}</span>','  &nbsp;{{bug_summary}}</p></a>','  <div class="buginfo-extra">','      <p class="ellipsis single-line">{{description}}</p></div>','  </div>','</div></td></tr>','{{> private_warning}}','</tbody></table>'].join(' ');},_private_warning_template:function(message){return['{{#private_warning}}','<tr><td><p id="privacy-warning" ','class="block-sprite large-warning">',message,'</p></td></tr>','{{/private_warning}}'].join(' ');},_bug_confirmation_form_template:function(){return['<div class="bug-details-node" ','style="margin-top: 6px;">','{{> bug_details}}','</div>'].join('');},_syncResultsUI:function(){var bug_data=this.get('results');if(!bug_data.length){this._hide_bug_results();return;}
bug_data=bug_data[0];bug_data.private_warning=this.get('public_context')&&bug_data.is_private;var private_warning_message=this.get('private_warning_message');var html=Y.lp.mustache.to_html(this._bug_confirmation_form_template(),bug_data,{bug_details:this._bug_details_template(),private_warning:this._private_warning_template(private_warning_message)});var bug_details_node=Y.Node.create(html);var bug_link=bug_details_node.one('.bugtitle');bug_link.on('click',function(e){e.halt();window.open(bug_link.get('href'));});this._show_bug_results(bug_details_node);var that=this;this.save_button.on('click',function(e){e.halt();that.fire(namespace.BugPicker.SAVE,bug_data);});},_show_bug_results:function(new_bug_details_node){this._results_box.empty(true);this._results_box.appendChild(new_bug_details_node);if(!Y.Lang.isValue(this.save_button)){this.save_button=Y.Node.create(this._save_button_html());this.set('footer_slot',this.save_button);}else{this.save_button.detachAll();}
this.save_button.focus();this._xaxis_centre();var use_animation=this.get('use_animation');if(!use_animation){this.bug_details_node=new_bug_details_node;return;}
new_bug_details_node.addClass('transparent');new_bug_details_node.setStyle('opacity',0);var fade_in=new Y.Anim({node:new_bug_details_node,to:{opacity:1},duration:0.8});var that=this;fade_in.on('end',function(){that.bug_details_node=new_bug_details_node;});fade_in.run();},_hide_bug_results:function(){if(Y.Lang.isValue(this.bug_details_node)){this._results_box.empty(true);}
this.set('error',null);this.bug_details_node=null;if(Y.Lang.isValue(this.save_button)){this.save_button.detachAll();this.save_button.remove(true);this.save_button=null;}
this._xaxis_centre();}},{ATTRS:{public_context:{getter:function(){return!Y.one(document.body).hasClass('private');}},private_warning_message:{value:'You are selecting a private bug.'},save_link_text:{value:"Save bug"},remove_link_text:{value:"Remove bug"},remove_link_visible:{value:false},use_animation:{value:true},align:{value:{points:[Y.WidgetPositionAlign.CC,Y.WidgetPositionAlign.CC]}},progressbar:{value:true},progress:{value:0},header_text:{value:'Select a bug'},headerContent:{getter:function(){return Y.Node.create("<h2></h2>").set('text',this.get('header_text'));}},search_text_too_short_message:{getter:function(){return'Please enter a valid bug number.';}},min_search_chars:{value:1},clear_on_cancel:{value:true}}});namespace.BugPicker.SAVE='save';namespace.BugPicker.REMOVE='remove';},"0.1",{"requires":["base","io","oop","node","event","json","lp.ui.effects","lp.mustache","lp.ui.picker-base"]});
/* lp/bugs/javascript/bugtask_index-min.js */

YUI.add('lp.bugs.bugtask_index',function(Y){var namespace=Y.namespace('lp.bugs.bugtask_index');namespace.ANIM_DURATION=1;var lp_client;var lp_bug_entry;var bug_repr;var privacy_link;var link_branch_link;namespace.setup_bugtask_index=function(){Y.on('domready',function(){if(LP.links.me===undefined){return;}
setup_client_and_bug();var config={picker_activator:'.menu-link-mark-dupe, .change_duplicate_bug'};var dup_widget=new Y.lp.bugs.duplicates.DuplicateBugPicker(config);dup_widget.render();dup_widget.hide();privacy_link=Y.one('#privacy-link');if(privacy_link){var sub_list_node=Y.one('#other-bug-subscribers');var subscribers_list=sub_list_node.getData('subscribers_loader');Y.lp.app.information_type.setup_choice(privacy_link,lp_client,LP.cache.bug,subscribers_list);}
setup_add_attachment();setup_link_branch_picker();namespace.setup_load_comments(true);namespace.setup_bugwatch_expand_comments();},window);};function setup_client_and_bug(){lp_client=new Y.lp.client.Launchpad();if(bug_repr===undefined){bug_repr=LP.cache.bug;lp_bug_entry=new Y.lp.client.Entry(lp_client,bug_repr,bug_repr.self_link);}}
function do_pre_search(picker,bug_id){if(!Y.Lang.isValue(bug_id)){bug_id=LP.cache.bug.id;}
picker.set('footer_slot','Loading suggestions...');var original_min_search_chars=picker.get('min_search_chars');picker.set('min_search_chars',0);picker.fire('search',bug_id.toString(),undefined,true);picker.set('search_mode',false);picker.set('min_search_chars',original_min_search_chars);}
namespace._do_pre_search=do_pre_search;function setup_link_branch_picker(){setup_client_and_bug();var error_handler=new Y.lp.client.ErrorHandler();error_handler.clearProgressUI=function(){link_branch_link.toggleClass('update-in-progress-message');};error_handler.showError=function(error_msg){Y.lp.app.errors.display_error(Y.one('.menu-link-addbranch'),error_msg);};function get_branch_and_link_to_bug(data){var branch_url=data.api_uri;config={on:{success:link_branch_to_bug,failure:error_handler.getFailureHandler()}};link_branch_link.toggleClass('update-in-progress-message');lp_client.get(branch_url,config);}
link_branch_link=Y.one('.menu-link-addbranch');if(Y.Lang.isValue(link_branch_link)){var config={header:'Link a related branch',step_title:'Search',picker_activator:'.menu-link-addbranch'};config.save=get_branch_and_link_to_bug;var picker=Y.lp.app.picker.create('Branch',config);link_branch_link.once('click',function(e){do_pre_search(picker);});}}
function link_branch_to_bug(branch){var error_handler=new Y.lp.client.ErrorHandler();error_handler.clearProgressUI=function(){link_branch_link.toggleClass('update-in-progress-message');};error_handler.showError=function(error_msg){Y.lp.app.errors.display_error(Y.one('.menu-link-addbranch'),error_msg);};var config={on:{success:function(bug_branch_entry){link_branch_link.toggleClass('update-in-progress-message');config={on:{success:function(branch_html){add_branch_to_linked_branches(branch_html);}},accept:Y.lp.client.XHTML};lp_client.get(bug_branch_entry.get('self_link'),config);},failure:error_handler.getFailureHandler()},parameters:{branch:branch.get('self_link')}};lp_client.named_post(lp_bug_entry.get('self_link'),'linkBranch',config);}
function add_branch_to_linked_branches(branch_html){var anim;var bug_branch_node=Y.Node.create(branch_html);var bug_branch_list=Y.one('#bug-branches');if(!Y.Lang.isValue(bug_branch_list)){bug_branch_list=Y.Node.create('<div id="bug-branches">'+'  <h2>Related branches</h2>'+'</div>');var bug_branch_container=Y.one('#bug-branches-container');bug_branch_container.appendChild(bug_branch_list);anim=Y.lp.anim.green_flash({node:bug_branch_list,duration:namespace.ANIM_DURATION});}else{anim=Y.lp.anim.green_flash({node:bug_branch_node,duration:namespace.ANIM_DURATION});}
var existing_bug_branch_node=bug_branch_list.one('#'+bug_branch_node.getAttribute('id'));if(!Y.Lang.isValue(existing_bug_branch_node)){bug_branch_list.appendChild(bug_branch_node);}else{anim=Y.lp.anim.green_flash({node:existing_bug_branch_node,duration:namespace.ANIM_DURATION});}
anim.run();Y.fire('lp:branch-linked',bug_branch_node);}
var status_choice_data=[];var update_maybe_confirmed_status=function(){Y.Array.each(status_choice_data,function(rowdata){if(rowdata.widget.get('value')==='New'){lp_client.get(rowdata.config.bugtask_path,{on:{success:function(bugtask){var status=bugtask.get('status');if(status!==rowdata.widget.get('value')){rowdata.widget.set('value',status);rowdata.widget.fire('save');}}}});}});};namespace.setup_bugtask_table=function(){var bugtask_data=LP.cache.bugtask_data;if(!Y.Lang.isValue(bugtask_data)){return;}
var process_link=function(link){if(link.hasClass('js-action')){return;}
var widget_id=link.get('id');if(widget_id!==''){Y.lp.app.picker.reconnectPicker(widget_id);}};var id;for(id in bugtask_data){if(bugtask_data.hasOwnProperty(id)){var conf=bugtask_data[id];var form_row=Y.one('#'+conf.form_row_id);if(form_row!==null){form_row.all('a').each(process_link);}
namespace.setup_bugtask_row(conf);}}};namespace._showDeleteSpinner=function(delete_link){var spinner_node=Y.Node.create('<img class="spinner" src="/@@/spinner" alt="Deleting..." />');delete_link.insertBefore(spinner_node,delete_link);delete_link.addClass('hidden');};namespace._hideDeleteSpinner=function(delete_link,show_link){if(show_link){delete_link.removeClass('hidden');}
var spinner=delete_link.get('parentNode').one('.spinner');if(spinner!==null){spinner.remove();}};namespace._render_bugtask_table=function(new_table){var bugtask_table=Y.one('#affected-software');bugtask_table.replace(new_table);namespace.setup_bugtask_table();};namespace._confirm_bugtask_delete=function(delete_link,conf){var delete_text=Y.lp.mustache.to_html(['<p class="block-sprite large-warning">','    You are about to mark bug "{{bug}}"<br/>as no longer affecting','    {{target}}.','</p><p>','    <strong>Please confirm you really want to do this.</strong>','</p>'].join(''),{bug:conf.bug_title,target:conf.targetname});var co=new Y.lp.app.confirmationoverlay.ConfirmationOverlay({submit_fn:function(){namespace.delete_bugtask(delete_link,conf);},form_content:delete_text,headerContent:'<h2>Confirm bugtask deletion</h2>',submit_text:'Delete'});co.show();};namespace._redirect=function(url){window.location.replace(url);};namespace._process_bugtask_delete_response=function(response,bugtask_id,row_id,delete_link){var animate_deletion=function(after_callback){var row=Y.one('#'+row_id);row.setStyle('opacity',1);row.addClass('transparent');var row_fade_out=new Y.Anim({node:row,to:{opacity:0},duration:namespace.ANIM_DURATION});if(Y.Lang.isFunction(after_callback)){row_fade_out.on('end',after_callback);}
row_fade_out.run();};if(response.status===404){var message=Y.Lang.sub("Bug task affecting {targetname} has already been deleted.",{targetname:LP.cache.bugtask_data[bugtask_id].targetname});var notification=Y.Lang.sub('[[20, "{message}"]]',{message:message});Y.lp.client.display_notifications(notification);animate_deletion(function(){var tr=Y.one('#'+row_id);if(tr!==null){tr.remove(true);}
delete LP.cache.bugtask_data[bugtask_id];});return;}
var content_type=response.getResponseHeader('Content-type');if(content_type==='application/json'){Y.lp.client.display_notifications(response.getResponseHeader('X-Lazr-Notifications'));var redirect=Y.JSON.parse(response.responseText);if(!Y.Lang.isValue(redirect)){namespace._hideDeleteSpinner(delete_link,false);return;}
animate_deletion();namespace._redirect(redirect.bugtask_url);return;}
animate_deletion(function(){delete LP.cache.bugtask_data[bugtask_id];namespace._render_bugtask_table(response.responseText);Y.lp.client.display_notifications(response.getResponseHeader('X-Lazr-Notifications'));});};namespace.delete_bugtask=function(delete_link,conf){Y.lp.client.remove_notifications();var error_handler=new Y.lp.client.ErrorHandler();var module=this;error_handler.showError=Y.bind(function(error_msg){namespace._hideDeleteSpinner(delete_link,true);Y.lp.app.errors.display_error(undefined,error_msg);},this);error_handler.handleError=Y.bind(function(id,response){if(response.status===404){module._process_bugtask_delete_response(response,conf.id,conf.row_id,delete_link);return true;}
return false;},this);var submit_url=delete_link.get('href');var qs=Y.lp.client.append_qs('','field.actions.delete_bugtask','Delete');var y_config={method:"POST",headers:{'Accept':'application/json; application/xhtml'},on:{start:Y.bind(namespace._showDeleteSpinner,namespace,delete_link),failure:error_handler.getFailureHandler(),success:function(id,response){namespace._process_bugtask_delete_response(response,conf.id,conf.row_id,delete_link);}},data:qs};var io_provider=Y.lp.client.get_configured_io_provider(conf);io_provider.io(submit_url,y_config);};namespace.setup_bugtask_row=function(conf){var tr=Y.one('#'+conf.row_id);var bugtarget_content=Y.one('#bugtarget-picker-'+conf.row_id);var status_content=tr.one('.status-content');var importance_content=tr.one('.importance-content');var assignee_content=Y.one('#assignee-picker-'+conf.row_id);var milestone_content=tr.one('.milestone-content');var delete_link=tr.one('.bugtask-delete');if(Y.Lang.isValue(LP.links.me)&&Y.Lang.isValue(delete_link)&&conf.user_can_delete){delete_link.on('click',function(e){e.preventDefault();namespace._confirm_bugtask_delete(delete_link,conf);});}
if(status_content===null){return;}
if(Y.Lang.isValue(LP.cache.bug)&&Y.Lang.isValue(LP.cache.bug.duplicate_of_link)){status_content.on('click',function(e){e.halt();});importance_content.on('click',function(e){e.halt();});return;}
if((LP.links.me!==undefined)&&(LP.links.me!==null)){if(Y.Lang.isValue(bugtarget_content)){if(conf.target_is_product){Y.lp.app.picker.addPickerPatcher('Product',conf.bugtask_path,"target_link",bugtarget_content.get('id'),{"step_title":"Search projects","header":"Change project"});}}
if(conf.user_can_edit_status){var status_choice_edit=new Y.ChoiceSource({contentBox:status_content,value:conf.status_value,title:'Change status to',items:conf.status_widget_items,elementToFlash:status_content.get('parentNode'),backgroundColor:tr.hasClass('highlight')?'#FFFF99':'#FFFFFF'});status_choice_edit.showError=function(err){Y.lp.app.errors.display_error(null,err);};status_choice_edit.on('save',function(e){var cb=status_choice_edit.get('contentBox');Y.Array.each(conf.status_widget_items,function(item){if(item.value===status_choice_edit.get('value')){cb.addClass(item.css_class);}else{cb.removeClass(item.css_class);}});Y.one(document.getElementById(conf.prefix+'.status')).set('value',status_choice_edit.get('value'));});status_choice_edit.plug({fn:Y.lp.client.plugins.PATCHPlugin,cfg:{patch:'status',resource:conf.bugtask_path}});status_choice_edit.render();status_choice_data.push({widget:status_choice_edit,config:conf});}
if(conf.user_can_edit_importance){var importance_choice_edit=new Y.ChoiceSource({contentBox:importance_content,value:conf.importance_value,title:'Change importance to',items:conf.importance_widget_items,elementToFlash:importance_content.get('parentNode'),backgroundColor:tr.hasClass('highlight')?'#FFFF99':'#FFFFFF'});importance_choice_edit.showError=function(err){Y.lp.app.errors.display_error(null,err);};importance_choice_edit.on('save',function(e){var cb=importance_choice_edit.get('contentBox');Y.Array.each(conf.importance_widget_items,function(item){if(item.value===importance_choice_edit.get('value')){cb.addClass(item.css_class);}else{cb.removeClass(item.css_class);}});Y.one(document.getElementById(conf.prefix+'.importance')).set('value',importance_choice_edit.get('value'));});importance_choice_edit.plug({fn:Y.lp.client.plugins.PATCHPlugin,cfg:{patch:'importance',resource:conf.bugtask_path}});importance_choice_edit.render();}}
if(Y.Lang.isValue(milestone_content)&&conf.user_can_edit_milestone){var milestone_choice_edit=new Y.NullChoiceSource({contentBox:milestone_content,value:conf.milestone_value,title:'Target to milestone',items:conf.milestone_widget_items,elementToFlash:milestone_content.get('parentNode'),backgroundColor:tr.hasClass('highlight')?'#FFFF99':'#FFFFFF',clickable_content:false});milestone_choice_edit.showError=function(err){Y.lp.app.errors.display_error(null,err);};milestone_choice_edit.plug({fn:Y.lp.client.plugins.PATCHPlugin,cfg:{patch:'milestone_link',resource:conf.bugtask_path}});milestone_choice_edit.after('save',function(){var new_value=milestone_choice_edit.get('value');if(Y.Lang.isValue(new_value)){milestone_content.one('.value').setAttribute('href',new_value.replace('/api/devel',''));}
var inline_combo=Y.one(document.getElementById(conf.prefix+'.milestone'));if(Y.Lang.isValue(inline_combo)){inline_combo.set('value',null);Y.Array.each(milestone_choice_edit.get('items'),function(item){if(item.value===milestone_choice_edit.get('value')){inline_combo.all('option').each(function(opt){if(opt.get('innerHTML')===item.name){opt.set('selected',true);}});}});}
milestone_choice_edit._uiClearWaiting();});milestone_content.one('.nulltext').on('click',milestone_choice_edit.onClick,milestone_choice_edit);milestone_choice_edit.render();}
if(Y.Lang.isValue(assignee_content)&&conf.user_can_edit_assignee){var validate_assignee=function(picker,value,save_fn,cancel_fn){if(value===null||!Y.Lang.isValue(value.api_uri)){if(Y.Lang.isFunction(save_fn)){save_fn();return;}}
var assignee_uri=Y.lp.client.normalize_uri(value.api_uri);assignee_uri=Y.lp.client.get_absolute_uri(assignee_uri);var error_handler=new Y.lp.client.ErrorHandler();error_handler.showError=function(error_msg){Y.lp.app.errors.display_error(null,error_msg);};var process_contributor_result=function(contributor_info){var is_contributor=contributor_info.is_contributor;if(!is_contributor){var person=Y.Escape.html(contributor_info.person_name);var pillar=Y.Escape.html(contributor_info.pillar_name);var yesno_content_template="<p>{person_name} did not previously have any "+"assigned bugs in {pillar}.</p>"+"<p>Do you really want to assign them to this bug?"+"</p>";var yesno_content=Y.Lang.sub(yesno_content_template,{person_name:person,pillar:pillar});Y.lp.app.picker.yesno_save_confirmation(picker,yesno_content,"Assign","Choose Again",save_fn,cancel_fn);}else{if(Y.Lang.isFunction(save_fn)){save_fn();}}};var y_config={on:{success:process_contributor_result,failure:error_handler.getFailureHandler()},parameters:{person:assignee_uri}};lp_client.named_get(conf.bugtask_path,"getContributorInfo",y_config);};var step_title;if(conf.hide_assignee_team_selection){step_title=null;}else{step_title=(conf.assignee_vocabulary==='ValidAssignee')?"Search for people or teams":"Select a team of which you are a member";}
var assignee_picker=Y.lp.app.picker.addPickerPatcher(conf.assignee_vocabulary,conf.bugtask_path,"assignee_link",assignee_content.get('id'),{"picker_type":"person","vocabulary_filters":conf.assignee_vocabulary_filters,"step_title":step_title,"header":"Change assignee","selected_value":conf.assignee_value,"selected_value_metadata":conf.assignee_is_team?"team":"person","assign_me_text":"Assign me","remove_person_text":"Remove assignee","remove_team_text":"Remove assigned team","null_display_value":"Unassigned","show_remove_button":conf.user_can_unassign,"show_assign_me_button":true,"validate_callback":[validate_assignee,Y.lp.app.picker.public_private_warning]});if(conf.hide_assignee_team_selection){var content_box=assignee_picker.get('contentBox');var search_box=content_box.one('.yui3-picker-search-box');search_box.setStyle('display','none');var info=Y.Node.create('<p style="padding-top: 1em;"></p>').set('text','You may only assign yourself because you are '+'not affiliated with this project and do not have any team '+'memberships.');search_box.insert(info,search_box);}
assignee_picker.render();}
var icon_node=Y.one('tr#'+conf.row_id+' a.bugtask-expander');var row_node=Y.one('tr#'+conf.form_row_id);if(Y.Lang.isValue(row_node)){var content_node=row_node.one('td form');var expander=new Y.lp.app.widgets.expander.Expander(icon_node,row_node,{animate_node:content_node});expander.setUp();}};namespace.setup_me_too=function(user_is_affected,others_affected_count){var me_too_content=Y.one('#affectsmetoo');var me_too_edit=new MeTooChoiceSource({contentBox:me_too_content,value:user_is_affected,elementToFlash:me_too_content,editicon:".dynamic img.editicon",others_affected_count:others_affected_count});me_too_edit.render();};function MeTooChoiceSource(){MeTooChoiceSource.superclass.constructor.apply(this,arguments);}
MeTooChoiceSource.NAME='metoocs';MeTooChoiceSource.NS='metoocs';MeTooChoiceSource.ATTRS={title:{value:'Does this bug affect you?'},items:{value:[{name:'Yes, it affects me',value:true,disabled:false},{name:"No, it doesn't affect me",value:false,disabled:false}]},others_affected_count:{value:null}};namespace._MeTooChoiceSource=MeTooChoiceSource;Y.extend(MeTooChoiceSource,Y.ChoiceSource,{initializer:function(){var widget=this;this.error_handler=new Y.lp.client.ErrorHandler();this.error_handler.clearProgressUI=function(){widget._uiClearWaiting();};this.error_handler.showError=function(error_msg){widget.showError(error_msg);};var others_affected_count=this.get('others_affected_count');var source_names=this._getSourceNames(others_affected_count);Y.each(this.get('items'),function(item){if(source_names.hasOwnProperty(item.value)){item.source_name=source_names[item.value];}});},_getSourceNames:function(others_affected_count){var source_names={};if(others_affected_count===1){source_names[true]=('This bug affects you and 1 other person');}
else if(others_affected_count>1){source_names[true]=('This bug affects you and '+
others_affected_count+' other people');}
else{source_names[true]='This bug affects you';}
if(others_affected_count===1){source_names[false]=('This bug affects 1 person, but not you');}
else if(others_affected_count>1){source_names[false]=('This bug affects '+others_affected_count+' people, but not you');}
else{source_names[false]="This bug doesn't affect you";}
return source_names;},showError:function(err){Y.lp.app.errors.display_error(null,err);},render:function(){MeTooChoiceSource.superclass.render.apply(this,arguments);this.get('boundingBox').setStyle('display','inline');this.get('contentBox').one('.static').addClass('hidden');this.get('contentBox').one('.dynamic').removeClass('hidden');},_saveData:function(){this._uiSetWaiting();var value=this.getInput();var client=new Y.lp.client.Launchpad();var widget=this;var config={on:{success:function(entry){widget._uiClearWaiting();MeTooChoiceSource.superclass._saveData.call(widget,value);if(value&&widget.get('others_affected_count')>0){update_maybe_confirmed_status();}},failure:this.error_handler.getFailureHandler()},parameters:{affected:value}};client.named_post(LP.cache.bug.self_link,'markUserAffected',config);}});function setup_add_attachment(){var attachment_link=Y.all('.menu-link-addcomment');attachment_link.on('click',function(e){var comment_input=Y.one('[id="field.comment"]');if(comment_input.get('value')!==''){var current_url=attachment_link.getAttribute('href');var attachment_url=current_url+'?field.comment='+
encodeURIComponent(comment_input.get('value'));attachment_link.setAttribute('href',attachment_url);}});}
namespace.load_more_comments=function(batched_comments_url,comments_container,io_provider){var spinner_span=Y.one('#more-comments-spinner');spinner_span.setStyle('display','inline');var handlers={success:function(transactionid,response,args){var new_comments_node=Y.Node.create("<div></div>");new_comments_node.set('innerHTML',response.responseText);comments_container.setStyle('display','block');spinner_span.setStyle('display','none');comments_container.appendChild(new_comments_node);if(Y.Lang.isValue(Y.lp.anim)){var success_anim=Y.lp.anim.green_flash({node:new_comments_node,duration:namespace.ANIM_DURATION});success_anim.run();}
var batch_url_div=Y.one('#next-batch-url');if(Y.Lang.isValue(batch_url_div)){batched_comments_url=batch_url_div.get('innerHTML');batch_url_div.remove();namespace.load_more_comments(batched_comments_url,comments_container,io_provider);}else{Y.each(Y.all('.comments-hidden-message'),function(message){message.remove();});var comment_form_container=Y.one('#add-comment-form-container');if(Y.Lang.isValue(comment_form_container)){comment_form_container.toggleClass('hidden');}}}};if(!Y.Lang.isValue(io_provider)){io_provider=Y.lp.client.get_configured_io_provider();}
io_provider.io(batched_comments_url,{on:handlers});};namespace.setup_show_more_comments_link=function(link,url,container){link.on('click',function(e){e.preventDefault();namespace.load_more_comments(url,container);});link.addClass('js-action');};namespace.setup_load_comments=function(load_more_comments){var comments_container=Y.one('#comments-container');if(Y.Lang.isValue(comments_container)){var current_offset=LP.cache.initial_comment_batch_offset;var batched_comments_url=LP.cache.context.self_link.replace('/api/devel','')+"/+batched-comments?offset="+
current_offset;var show_comments_links=Y.all('.show-comments-link');if(show_comments_links){Y.each(show_comments_links,function(link){namespace.setup_show_more_comments_link(link,batched_comments_url,comments_container);});}
if(load_more_comments===true){namespace.load_more_comments(batched_comments_url,comments_container);}}};namespace.setup_bugwatch_expand_comments=function(){var bw_comments=Y.all('.remote-comment-reply-parent');bw_comments.each(function(el){var link=el.one('.remote-comment-reply-link');link.addClass('js-action');var content_node=el.one('.remote-comment-reply');var content_form=el.one('form');var expander=new Y.lp.app.widgets.expander.Expander(link,content_node,{animate_node:content_form});expander.setUp();});};},"0.1",{"requires":["base","oop","node","event","io-base","json-parse","lp.mustache","lp.ui.formoverlay","lp.anim","lp.ui.overlay","lp.ui.choiceedit","lp.app.picker","lp.bugs.bugtask_index.portlets.subscription","lp.app.information_type","lp.app.widgets.expander","lp.client","escape","lp.client.plugins","lp.app.errors","lp.app.confirmationoverlay","lp.bugs.duplicates"]});
/* lp/app/javascript/information_type-min.js */

YUI.add('lp.app.information_type',function(Y){var ns=Y.namespace('lp.app.information_type');ns.EV_CHANGE='information_type:change';ns.EV_ISPUBLIC='information_type:is_public';ns.EV_ISPRIVATE='information_type:is_private';Y.publish(ns.EV_CHANGE,{emitFacade:true});Y.publish(ns.EV_ISPUBLIC,{emitFacade:true});Y.publish(ns.EV_ISPRIVATE,{emitFacade:true});var is_private_event=function(value){var is_private=false;if(ns.get_cache_data_from_key(value,'value','is_private')){is_private=true;}
if(value.indexOf('PRIVATESECURITY')!==-1){is_private=true;}
return is_private;};Y.on(ns.EV_CHANGE,function(ev){if(!ev.value){Y.error('Information type change event without new value');}
if(is_private_event(ev.value)){Y.fire(ns.EV_ISPRIVATE,{text:ns.get_banner_text(ev.value),value:ev.value});}else{Y.fire(ns.EV_ISPUBLIC,{value:ev.value});}});var skip_animation=false;ns.save=function(widget,initial_value,value,lp_client,context,subscribers_list,validate_change){var error_handler=new Y.lp.client.FormErrorHandler();error_handler.showError=function(error_msg){Y.lp.app.errors.display_error(Y.one('#information-type'),error_msg);};error_handler.handleError=function(ioId,response){if(response.status===400&&response.statusText==='Bug Visibility'){ns._confirm_change(widget,initial_value,lp_client,context,subscribers_list);return true;}
var orig_value=ns.get_cache_data_from_key(context.information_type,'name','value');widget.set('value',orig_value);widget._showFailed();ns.update_privacy_portlet(orig_value);return false;};var submit_url=document.URL+"/+secrecy";var qs=Y.lp.client.append_qs('','field.actions.change','Change');qs=Y.lp.client.append_qs(qs,'field.information_type',value);qs=Y.lp.client.append_qs(qs,'field.validate_change',validate_change?'on':'off');var config={method:"POST",headers:{'Accept':'application/xhtml;application/json'},data:qs,on:{start:function(){widget._uiSetWaiting();if(Y.Lang.isValue(subscribers_list)){subscribers_list.subscribers_list.startActivity('Updating subscribers...');}},end:function(){widget._uiClearWaiting();if(Y.Lang.isValue(subscribers_list)){subscribers_list.subscribers_list.stopActivity();}},success:function(id,response){var result_data=null;if(response.responseText!==''&&response.getResponseHeader('Content-Type')==='application/json')
{result_data=Y.JSON.parse(response.responseText);}
ns.save_success(widget,context,value,subscribers_list,result_data);Y.lp.client.display_notifications(response.getResponseHeader('X-Lazr-Notifications'));},failure:error_handler.getFailureHandler()}};lp_client.io_provider.io(submit_url,config);};ns.get_banner_text=function(value){var text;if(value.indexOf('PRIVATESECURITY')!==-1){var security_text="This report will be private "+"because it is a security "+"vulnerability. You can "+"disclose it later.";text=security_text;}else{var text_template="This page contains {info_type} information.";var info_type=ns.get_cache_data_from_key(value,'value','name');text=Y.Lang.sub(text_template,{'info_type':info_type});}
return text;};ns.save_success=function(widget,context,value,subscribers_list,result_data){context.information_type=ns.get_cache_data_from_key(value,'value','name');Y.fire(ns.EV_CHANGE,{value:value});widget._showSucceeded();if(Y.Lang.isObject(result_data)){var subscribers=result_data.subscription_data;subscribers_list._loadSubscribersFromList(subscribers);var cache_data=result_data.cache_data;var item;for(item in cache_data){if(cache_data.hasOwnProperty(item)){LP.cache[item]=cache_data[item];}}
var project_span=Y.one('#also-affects-product');if(Y.Lang.isValue(project_span)){project_span.toggleClass('private-disallow',!result_data.can_add_project_task);}
var package_span=Y.one('#also-affects-package');if(Y.Lang.isValue(project_span)){package_span.toggleClass('private-disallow',!result_data.can_add_package_task);}}
if(Y.Lang.isValue(subscribers_list)){var subscription_ns=Y.lp.bugs.bugtask_index.portlets.subscription;subscription_ns.update_subscription_status(skip_animation);}};ns._confirm_change=function(widget,initial_value,lp_client,context,subscribers_list){var value=widget.get('value');var do_save=function(){ns.update_privacy_portlet(value);ns.save(widget,initial_value,value,lp_client,context,subscribers_list,false);};var new_value=widget.get('value');widget.set('value',initial_value);ns.update_privacy_portlet(initial_value);var confirm_text_template=['<p class="block-sprite large-warning">','    You are about to mark this bug as ','    <strong>{{information_type}}</strong>.<br/>','    The bug will become invisible because there is no-one with','    permissions to see {{information_type}} bugs.','</p><p>','    <strong>Please confirm you really want to do this.</strong>','</p>'].join('');var title=ns.get_cache_data_from_key(value,'value','name');var confirm_text=Y.lp.mustache.to_html(confirm_text_template,{information_type:title});var co=new Y.lp.app.confirmationoverlay.ConfirmationOverlay({submit_fn:function(){widget.set('value',new_value);ns.update_privacy_portlet(new_value);do_save();},form_content:confirm_text,headerContent:'<h2>Confirm information type change</h2>',submit_text:'Confirm'});co.show();};ns.setup_choice=function(privacy_link,lp_client,context,subscribers_list,skip_anim){skip_animation=skip_anim;var initial_value=ns.get_cache_data_from_key(context.information_type,'name','value');var information_type_value=Y.one('#information-type');var choice_list=ns.cache_to_choicesource(LP.cache.information_type_data);var information_type_edit=new Y.ChoiceSource({editicon:privacy_link,contentBox:Y.one('#privacy'),value_location:information_type_value,value:initial_value,title:"Change information type",items:choice_list,backgroundColor:'#FFFF99',flashEnabled:false});Y.lp.app.choice.hook_up_choicesource_spinner(information_type_edit);information_type_edit.render();information_type_edit.on("save",function(e){var value=information_type_edit.get('value');ns.update_privacy_portlet(value);ns.save(information_type_edit,initial_value,value,lp_client,context,subscribers_list,true);});privacy_link.addClass('js-action');return information_type_edit;};ns.get_cache_data_from_key=function(cache_value,cache_field,data_field){var cache=LP.cache.information_type_data;var key;for(key in cache){if(cache.hasOwnProperty(key)){if(cache[key][cache_field]===cache_value){return cache[key][data_field];}}}};ns.cache_to_choicesource=function(cache){var data=[];var key;for(key in cache){if(cache.hasOwnProperty(key)){data.push(cache[key]);}}
data.sort(function(a,b){return a.order-b.order;});return data;};ns.update_privacy_portlet=function(value){var description=ns.get_cache_data_from_key(value,'value','description');var desc_node=Y.one('#information-type-description');if(Y.Lang.isValue(desc_node)){desc_node.set('text',description);}
var summary=Y.one('#information-type-summary');var private_type=LP.cache.information_type_data[value].is_private;if(private_type){summary.replaceClass('public','private');}else{summary.replaceClass('private','public');}};},"0.1",{"requires":["base","oop","node","event","io-base","lp.mustache","lp.app.choice","lp.bugs.bugtask_index","lp.ui.choiceedit"]});
/* lp/bugs/javascript/duplicates-min.js */

YUI.add('lp.bugs.duplicates',function(Y){var namespace=Y.namespace('lp.bugs.duplicates');var superclass=Y.lp.bugs.bug_picker.BugPicker;namespace.DuplicateBugPicker=Y.Base.create("duplicateBugPickerWidget",Y.lp.bugs.bug_picker.BugPicker,[],{initializer:function(cfg){this.lp_client=new Y.lp.client.Launchpad(cfg);},bindUI:function(){superclass.prototype.bindUI.apply(this,arguments);var that=this;this.subscribe(Y.lp.bugs.bug_picker.BugPicker.SAVE,function(e){e.halt();that.set('progress',100);var bug_data=e.details[0];var bug_id=bug_data.id;var bug_title=bug_data.bug_summary;that._submit_bug(bug_id,bug_title,that.save_button);});this.subscribe(Y.lp.bugs.bug_picker.BugPicker.REMOVE,function(e){e.halt();that.set('progress',100);that._submit_bug('',null,that.remove_link);});this._connect_links();},_connect_links:function(){Y.all('.change-duplicate-bug, .menu-link-mark-dupe, '+'.remove-duplicate-bug').detachAll();var that=this;Y.all('.remove-duplicate-bug').on('click',function(e){e.halt();that._submit_bug('',null,e.currentTarget);});Y.all('.change-duplicate-bug, .menu-link-mark-dupe').on('click',function(e){e.halt();that.show();});},_syncResultsUI:function(){Y.lp.bugs.bug_picker.BugPicker.prototype._syncResultsUI.call(this);var bug_data=this.get('results');if(!bug_data.length){this._hide_bug_results();return;}
bug_data=bug_data[0];if(!bug_data.different_pillars){return;}
var bug_details_table=this._results_box.one('table.confirm-bug-details tbody');var different_project_warning='<p id="different-project-warning" '+'class="block-sprite large-warning">'+'This bug affects a different project to the bug you '+'are specifying here.'+'</p>';var warning_node_row=Y.Node.create('<tr></tr>');warning_node_row.appendChild(Y.Node.create('<td></td>').setContent(different_project_warning));bug_details_table.appendChild(warning_node_row);},_bug_search_header:function(){var search_header='<p class="search-header">'+'Marking this bug as a duplicate will, '+'by default, hide it from search results listings.</p>';var duplicatesNode=this.get('duplicatesNode');if(Y.Lang.isValue(duplicatesNode)){search_header+='<p class="block-sprite large-warning">'+'<strong>Note:</strong> '+'This bug has duplicates of its own. '+'If you go ahead, they too will become duplicates of '+'the bug you specify here.  This cannot be undone.'+'</p>';}
return search_header+
superclass.prototype._bug_search_header.call(this);},_find_bug:function(data){var new_dup_id=Y.Lang.trim(data.id);var error=false;if(new_dup_id===LP.cache.bug.id.toString()){this._hide_bug_results();this.set('error','A bug cannot be marked as a duplicate of itself.');error=true;}
var duplicate_of_link=LP.cache.bug.duplicate_of_link;var new_dupe_link=Y.lp.client.get_absolute_uri("/api/devel/bugs/"+new_dup_id);if(new_dupe_link===duplicate_of_link){this._hide_bug_results();this.set('error','This bug is already marked as a duplicate of bug '+
new_dup_id+'.');error=true;}
if(error){this.set('search_mode',false);return;}
Y.lp.bugs.bug_picker.BugPicker.prototype._find_bug.call(this,data);},_error_handler:function(widget){var that=this;var error_handler=new Y.lp.client.ErrorHandler();error_handler.handleError=function(id,response){var error_msg=response.responseText;if(response.status===400){var response_info=Y.JSON.parse(response.responseText);var dup_error=response_info.errors['field.duplicateof'];if(Y.Lang.isString(dup_error)){var error_info=dup_error.split('\n');if(error_info.length===1){error_msg=error_info;}else{error_msg=error_info.slice(1).join(' ');}
that.set('error',error_msg);return true;}}
return false;};error_handler.showError=function(error_msg){that.set('error',error_msg);};error_handler.clearProgressUI=function(){that._hide_bug_spinner(widget);var dupe_span=that.get('dupe_span');dupe_span.removeClass('update-in-progress-message');Y.all('.remove-duplicate-bug').each(function(node){node.removeClass('update-in-progress-message');node.addClass('remove');});if(Y.Lang.isValue(this.remove_link)){this.remove_link.removeClass('update-in-progress-message');this.remove_link.addClass('remove');}};return error_handler;},_render_bugtask_table:function(new_table){var bugtask_table=Y.one('#affected-software');bugtask_table.replace(new_table);Y.lp.bugs.bugtask_index.setup_bugtask_table();},_dupe_edit_link:function(link_id,url,dup_id){var template=['<a id="{link_id}" ','title="Edit or remove linked duplicate bug" ','href={url} ','class="sprite edit action-icon change-duplicate-bug"','style="margin-left: 0">Edit</a>','<span id="mark-duplicate-text">','Duplicate of <a href="/bugs/{dup_id}">bug #{dup_id}</a>','</span>'].join("");return Y.Lang.sub(template,{link_id:link_id,url:url,dup_id:dup_id});},_dupe_remove_link:function(link_id,url){var template=['<a id="{link_id}" ','title="Edit or remove linked duplicate bug" ','href={url} ','class="sprite remove action-icon remove-duplicate-bug"','style="float: right;">Remove</a>'].join("");return Y.Lang.sub(template,{link_id:link_id,url:url});},_submit_bug_success:function(response,new_dup_url,new_dup_id,new_dupe_title){this._performDefaultSave();LP.cache.bug.duplicate_of_link=new_dup_url;this._render_bugtask_table(response.responseText);if(Y.Lang.isValue(new_dup_url)){this._render_dupe_information(new_dup_id,new_dupe_title);}else{Y.all('.remove-duplicate-bug').each(function(node){node.removeClass('update-in-progress-message');node.addClass('remove');});if(Y.Lang.isValue(this.remove_link)){this.remove_link.removeClass('update-in-progress-message');this.remove_link.addClass('remove');}
this._remove_dupe_information();}
var dupe_portlet_node=this.get('portletNode').one('#mark-duplicate-text');this.set('dupe_portlet_node',dupe_portlet_node);this._connect_links();},_render_dupe_information:function(new_dup_id,new_dupe_title){var dupe_portlet_node=this.get('dupe_span').ancestor('li');var update_dup_url=dupe_portlet_node.one('a').get('href');dupe_portlet_node.empty(true);dupe_portlet_node.removeClass('sprite bug-dupe');var edit_link=this._dupe_edit_link('change-duplicate-bug',update_dup_url,new_dup_id);dupe_portlet_node.appendChild(edit_link);var remove_link=this._dupe_remove_link('remove-duplicate-bug',update_dup_url);dupe_portlet_node.appendChild(remove_link);var duplicatesNode=this.get('duplicatesNode');if(Y.Lang.isValue(duplicatesNode)){duplicatesNode.remove(true);}
this._show_comment_on_duplicate_warning(new_dup_id,new_dupe_title);this._show_bugtasks_duplicate_message(new_dup_id,new_dupe_title);var anim_duration=1;if(!this.get('use_animation')){anim_duration=0;}
Y.lp.anim.green_flash({node:'.bug-duplicate-details',duration:anim_duration}).run();},_remove_dupe_information:function(){var dupe_portlet_node=this.get('dupe_span').ancestor('li');var update_dup_url=dupe_portlet_node.one('a').get('href');dupe_portlet_node.addClass('sprite bug-dupe');dupe_portlet_node.setContent(['<span id="mark-duplicate-text">','<a class="menu-link-mark-dupe js-action">','Mark as duplicate</a></span>'].join(""));var edit_link=dupe_portlet_node.one('a');edit_link.set('href',update_dup_url);this._hide_comment_on_duplicate_warning();var that=this;var hide_dupe_message=function(){that._hide_bugtasks_duplicate_message();};if(!this.get('use_animation')){hide_dupe_message();return;}
var anim=Y.lp.anim.green_flash({node:'.bug-duplicate-details',duration:1});anim.on('end',hide_dupe_message);anim.run();},_submit_bug:function(new_dup_id,new_dupe_title,widget){var new_dup_url=null;var qs;var setting_dupe=new_dup_id!=='';if(setting_dupe){var bug_link=LP.cache.bug.self_link;var last_slash_index=bug_link.lastIndexOf('/');new_dup_url=bug_link.slice(0,last_slash_index+1)+new_dup_id;qs=Y.lp.client.append_qs('','field.actions.change','Set Duplicate');qs=Y.lp.client.append_qs(qs,"field.duplicateof",new_dup_id);}else{qs=Y.lp.client.append_qs('','field.actions.remove','Remove Duplicate');}
var that=this;var error_handler=this._error_handler(widget);var submit_url=LP.cache.context.web_link+'/+duplicate';var y_config={method:"POST",headers:{'Accept':'application/json; application/xhtml'},on:{start:function(){var dupe_span=that.get('dupe_span');dupe_span.removeClass('sprite bug-dupe');dupe_span.addClass('update-in-progress-message');if(!setting_dupe){Y.all('.remove-duplicate-bug').each(function(node){node.removeClass('remove');node.addClass('update-in-progress-message');});if(Y.Lang.isValue(that.remove_link)){that.remove_link.removeClass('remove');that.remove_link.addClass('update-in-progress-message');}}
that.set('error',null);that._show_bug_spinner(widget);},success:function(id,response){that._submit_bug_success(response,new_dup_url,new_dup_id,new_dupe_title);},failure:error_handler.getFailureHandler()},data:qs};var io_provider=this.lp_client.io_provider;io_provider.io(submit_url,y_config);},_duplicate_bug_info_message:function(dup_id,dup_title){return Y.lp.mustache.to_html(['<span class="bug-duplicate-details ellipsis ','single-line wide">','<span class="sprite info"></span>','This bug report is a duplicate of:&nbsp;','<a href="/bugs/{{dup_id}}">Bug #{{dup_id}} {{dup_title}}','</a></span>','<a id="change-duplicate-bug-bugtasks"','    href="+duplicate"','    title="Edit or remove linked duplicate bug"','    class="sprite edit action-icon standalone ','    change-duplicate-bug">Edit</a>','<a id="remove-duplicate-bug-bugtasks"','    href="+duplicate"','    title="Remove linked duplicate bug"','    class="sprite remove action-icon standalone ','    remove-duplicate-bug">Remove</a>'].join(" "),{dup_id:dup_id,dup_title:dup_title});},_show_bugtasks_duplicate_message:function(dup_id,dup_title){var dupe_info=Y.one("#bug-is-duplicate");if(Y.Lang.isValue(dupe_info)){dupe_info.setContent(Y.Node.create(this._duplicate_bug_info_message(dup_id,dup_title)));}},_hide_bugtasks_duplicate_message:function(){var dupe_info=Y.one("#bug-is-duplicate");if(Y.Lang.isValue(dupe_info)){dupe_info.empty();}},_show_comment_on_duplicate_warning:function(bug_id,title){var dupe_link=Y.lp.mustache.to_html('<a title="{{title}}" id="duplicate-of-warning-link" '+'href="/bugs/{{id}}" style="margin-right: 4px">bug #{{id}}.</a>',{id:bug_id,title:title});var new_duplicate_warning=Y.Node.create(['<div class="block-sprite large-warning"','id="warning-comment-on-duplicate">','Remember, this bug report is a duplicate of ',dupe_link,'<br/>Comment here only if you think the duplicate status ','is wrong.','</div>'].join(''));var duplicate_warning=Y.one('#warning-comment-on-duplicate');if(!Y.Lang.isValue(duplicate_warning)){var container=Y.one('#add-comment-form');var first_node=container.get('firstChild');container.insertBefore(new_duplicate_warning,first_node);}else{duplicate_warning.replace(new_duplicate_warning);}},_hide_comment_on_duplicate_warning:function(){var duplicate_warning=Y.one('#warning-comment-on-duplicate');if(duplicate_warning!==null){duplicate_warning.ancestor().removeChild(duplicate_warning);}}},{ATTRS:{dupe_span:{getter:function(){return Y.one('#mark-duplicate-text');}},duplicatesNode:{getter:function(){return Y.one('#portlet-duplicates');}},portletNode:{getter:function(){return Y.one('#duplicate-actions');}},header_text:{value:'Mark bug report as duplicate'},save_link_text:{value:'Save Duplicate'},remove_link_text:{value:'Bug is not a duplicate'},remove_link_visible:{getter:function(){var existing_dupe=LP.cache.bug.duplicate_of_link;return Y.Lang.isString(existing_dupe)&&existing_dupe!=='';}},private_warning_message:{value:'Marking this bug as a duplicate of a private bug means '+'that it won\'t be visible to contributors and encourages '+'the reporting of more duplicate bugs.<br/>'+'Perhaps there is a public bug that can be used instead.'}}});},"0.1",{"requires":["base","io","oop","node","event","json","lp.app.errors","lp.mustache","lp.bugs.bug_picker","lp.bugs.bugtask_index"]});
/* lp/app/javascript/lp-names-min.js */

YUI.add('lp.names',function(Y){var namespace=Y.namespace('lp.names');function launchpad_to_css(name){if(!name.match(/^[a-z0-9][a-z0-9+.-]*$/)){Y.error('Passed value "'+name+'" is not a valid Launchpad name.');return;}
if(name.match(/^[a-z][a-z0-9-]*$/)){return name;}else{var first_char=name.charAt(0);if(first_char>='0'&&first_char<='9'){name='_'+name;}
name=name.replace(/\+/g,'_y');name=name.replace(/\./g,'_z');}
return name;}
namespace.launchpad_to_css=launchpad_to_css;function css_to_launchpad(name){if(!name.match(/^-?[_a-z][_a-z0-9-]*$/)){Y.error('Passed value "'+name+'" is not a valid CSS class name.');}
if(!name.match(/^((_[0-9yz])|[a-z])([a-z0-9-]|(_[yz]))*$/)){Y.error('Passed value "'+name+'" is not produced by launchpad_to_css.');}
if(name.match(/^[a-z][a-z0-9-]*$/)){return name;}
if(name.charAt(0)==='_'){var second_char=name.charAt(1);if(second_char>='0'&&second_char<='9'){name=name.substr(1);}}
name=name.replace(/_y/g,'+');name=name.replace(/_z/g,'.');return name;}
namespace.css_to_launchpad=css_to_launchpad;},"0.1",{"requires":[]});
/* lp/app/subscribers/subscribers_list-min.js */

YUI.add('lp.app.subscribers.subscribers_list',function(Y){var namespace=Y.namespace('lp.app.subscribers.subscribers_list');var CSS_CLASSES={section:'subscribers-section',list:'subscribers-list',subscriber:'subscriber',no_subscribers:'no-subscribers-indicator',activity:'global-activity-indicator',activity_text:'global-activity-text',subscriber_activity:'subscriber-activity-indicator',actions:'subscriber-actions',unsubscribe:'unsubscribe-action'};var MAX_DISPLAYNAME_LENGTH=20;var CONFIG_DEFAULTS={default_subscriber_level:'',subscribers_label:'subscribers',subscribe_label:'Subscribe',unsubscribe_label:'Unsubscribe',subscribe_api:'subscribe',unsubscribe_api:'unsubscribe'};function SubscribersLoader(config){if(!Y.Lang.isValue(config.subscriber_levels)){Y.error("No subscriber levels specified in `config'.");}
var config_var;for(config_var in CONFIG_DEFAULTS){if(Y.Object.owns(CONFIG_DEFAULTS,config_var)){if(Y.Object.owns(config,config_var)&&Y.Lang.isString(config[config_var])){this[config_var]=config[config_var];}else{this[config_var]=CONFIG_DEFAULTS[config_var];config[config_var]=CONFIG_DEFAULTS[config_var];}}}
this.subscriber_levels=config.subscriber_levels;var sl=this.subscribers_list=new SubscribersList(config);sl.container_node.setData('subscribers_loader',this);if(!Y.Lang.isValue(config.context)||!Y.Lang.isString(config.context.web_link)){Y.error("No context specified in `config' or "+"context.web_link is invalid.");}
this.context=config.context;if(!Y.Lang.isString(config.subscribers_details_view)){Y.error("No config.subscribers_details_view specified to load "+"other subscribers from.");}
this.subscribers_portlet_uri=(this.context.web_link+config.subscribers_details_view);this.error_handler=new Y.lp.client.FormErrorHandler();this.error_handler.showError=function(error_msg){sl.stopActivity("Problem loading subscribers. "+error_msg);};if(Y.Object.owns(config,'lp_client')&&Y.Lang.isValue(config.lp_client)){this.lp_client=config.lp_client;}else{this.lp_client=new Y.lp.client.Launchpad();}
if(Y.Object.owns(config,'subscribe_me_link')&&Y.Lang.isString(config.subscribe_me_link)){if(!Y.Object.owns(config,'subscribe_me_level')||!Y.Lang.isString(config.subscribe_me_level)){Y.error("No config.subscribe_me_level specified.");}
this.subscribe_me_link=config.subscribe_me_link;this.subscribe_me_level=config.subscribe_me_level;this.subscribed_help_text='';if(Y.Lang.isString(config.subscribed_help_text)){this.subscribed_help_text=config.subscribed_help_text;}
this.unsubscribed_help_text='';if(Y.Lang.isString(config.unsubscribed_help_text)){this.unsubscribed_help_text=config.unsubscribed_help_text;}}
this.display_me_in_list=false;if(Y.Object.owns(config,'display_me_in_list')&&Y.Lang.isBoolean(config.display_me_in_list)){this.display_me_in_list=config.display_me_in_list;}
this._unsubscribe_me=undefined;this._loadSubscribers();if(Y.Object.owns(config,'subscribe_someone_else_link')&&Y.Lang.isString(config.subscribe_someone_else_link)){if(!Y.Object.owns(config,'subscribe_someone_else_level')||!Y.Lang.isString(config.subscribe_someone_else_level)){Y.error("No config.subscribe_someone_else_level specified.");}
this.subscribe_someone_else_link=config.subscribe_someone_else_link;this._setupSubscribeSomeoneElse(config.subscribe_someone_else_level);}}
namespace.SubscribersLoader=SubscribersLoader;SubscribersLoader.prototype._subscriber_is_me=function(subscriber){return subscriber.self_link.match(LP.links.me+"$")!==null;};SubscribersLoader.prototype._addSubscriber=function(subscriber,level){if(!this.subscriber_levels.hasOwnProperty(level)){level=this.default_subscriber_level;}
var unsubscribe_callback=this._getUnsubscribeCallback();var is_me=this._subscriber_is_me(subscriber);if(is_me){this._unsubscribe_me=function(){unsubscribe_callback(this.subscribers_list,subscriber);};}
if(this._updateSubscribersList(subscriber)){if(subscriber.can_edit===true){this.subscribers_list.addSubscriber(subscriber,level,false,{unsubscribe_callback:unsubscribe_callback});}else{this.subscribers_list.addSubscriber(subscriber,level,false);}}};SubscribersLoader.prototype._loadSubscribersFromList=function(details){if(!Y.Lang.isArray(details)){Y.error('Got non-array "'+details+'" in _loadSubscribersFromList().');}
this.subscribers_list.container_node.empty();var index,subscriber;for(index=0;index<details.length;index++){subscriber=details[index].subscriber;if(!Y.Lang.isObject(details[index])){Y.error('Subscriber details at index '+index+' ('+
details[index]+') are not an object.');}
this._addSubscriber(subscriber,details[index].subscription_level);}};SubscribersLoader.prototype._loadSubscribers=function(){var sl=this.subscribers_list;var loader=this;var on_success=function(subscribers){loader._loadSubscribersFromList(subscribers);if(Y.Object.owns(loader,'subscribe_me_link')&&Y.Lang.isString(loader.subscribe_me_link)){loader._setupSubscribeMe();}
loader.subscribers_list.stopActivity();};var config={on:{success:on_success,failure:this.error_handler.getFailureHandler()}};sl.startActivity("Loading "+this.subscribers_label+"...");this.lp_client.get(this.subscribers_portlet_uri,config);};SubscribersLoader.prototype._updateSubscribersList=function(subscriber){var is_me=this._subscriber_is_me(subscriber);return!is_me||this.display_me_in_list;};SubscribersLoader.prototype._getUnsubscribeCallback=function(){var loader=this;return function(subscribers_list,subscriber){var is_me=loader._subscriber_is_me(subscriber);var update_subscribers_list=loader._updateSubscribersList(subscriber);function on_success(){if(update_subscribers_list){subscribers_list.stopSubscriberActivity(subscriber,true,function(){subscribers_list.removeSubscriber(subscriber);});}else{subscribers_list.stopActivity();}
if(is_me&&Y.Object.owns(loader,'subscribe_me_link')&&Y.Lang.isString(loader.subscribe_me_link)){loader._updateSubscribeMeLink(false);}}
function on_failure(t_id,response){if(update_subscribers_list){subscribers_list.stopSubscriberActivity(subscriber,false);}else{subscribers_list.stopActivity();}
Y.lp.app.errors.display_error(false,response.status+" ("+response.statusText+").");}
var config={on:{success:on_success,failure:on_failure},parameters:{person:subscriber.self_link}};if(update_subscribers_list){subscribers_list.indicateSubscriberActivity(subscriber);}else{subscribers_list.startActivity("Unsubscribing...");}
loader.lp_client.named_post(loader.context.self_link,loader.unsubscribe_api,config);};};SubscribersLoader.prototype._setupSubscribeMe=function(){var loader=this;if(!Y.Lang.isValue(LP.links.me)){return;}
var link=Y.one(this.subscribe_me_link);if(link===null){Y.error("No link matching CSS selector '"+
this.subscribe_me_link+"' for subscribing me found.");}
var is_subscribed=Y.Lang.isFunction(loader._unsubscribe_me);this._updateSubscribeMeLink(is_subscribed);link.on('click',function(e){e.halt();var is_subscribed=Y.Lang.isFunction(loader._unsubscribe_me);if(is_subscribed){loader._unsubscribe_me();}else{if(!loader.display_me_in_list){loader.subscribers_list.startActivity("Subscribing...");}
loader._subscribePersonURI(LP.links.me,loader.subscribe_me_level);}});link.addClass('js-action');};SubscribersLoader.prototype._updateSubscribeMeLink=function(is_subscribed){var link=Y.one(this.subscribe_me_link);if(is_subscribed){link.set('text',this.unsubscribe_label).removeClass('add').addClass('remove').set('title',this.subscribed_help_text);}else{this._unsubscribe_me=undefined;link.set('text',this.subscribe_label).removeClass('remove').addClass('add').set('title',this.unsubscribed_help_text);}};SubscribersLoader.prototype._setupSubscribeSomeoneElse=function(level){var loader=this;var config={header:'Subscribe someone else',step_title:'Search',picker_activator:this.subscribe_someone_else_link};if(!Y.Lang.isValue(LP.links.me)){return;}
if(Y.one(this.subscribe_someone_else_link)===null){Y.error("No link matching CSS selector '"+
this.subscribe_someone_else_link+"' for subscribing someone else found.");}
config.save=function(result){var person_uri=Y.lp.client.get_absolute_uri(result.api_uri);loader._subscribePersonURI(person_uri,level);};this._picker=Y.lp.app.picker.create('ValidPersonOrTeam',config);};SubscribersLoader.prototype._subscribePersonURI=function(person_uri,level){var loader=this;loader.lp_client.get(person_uri,{on:{success:function(person){loader._subscribe(person,level);},failure:function(t_id,response){Y.lp.app.errors.display_error(false,response.status+" ("+response.statusText+")\n"+"Couldn't get subscriber details from the "+"server, so they have not been subscribed.\n");}}});};SubscribersLoader.prototype._subscribe=function(person,level){var subscriber=person.getAttrs();var is_me=this._subscriber_is_me(subscriber);var update_subscribers_list=this._updateSubscribersList(subscriber);if(update_subscribers_list){this.subscribers_list.addSubscriber(subscriber,level,true);this.subscribers_list.indicateSubscriberActivity(subscriber);}
var loader=this;var on_success=function(){var unsubscribe_callback=loader._getUnsubscribeCallback();if(update_subscribers_list){loader.subscribers_list.stopSubscriberActivity(subscriber,true);loader.subscribers_list.addUnsubscribeAction(subscriber,unsubscribe_callback);}else{loader.subscribers_list.stopActivity();}
if(is_me&&Y.Object.owns(loader,'subscribe_me_link')&&loader.subscribe_me_link){loader._unsubscribe_me=function(){unsubscribe_callback(loader.subscribers_list,subscriber);};loader._updateSubscribeMeLink(true);}};var on_failure=function(t_id,response){if(update_subscribers_list){loader.subscribers_list.stopSubscriberActivity(subscriber,false,function(){loader.subscribers_list.removeSubscriber(subscriber);});}else{loader.subscribers_list.stopActivity();}
var error_msg;if(response.status===400&&response.responseText!==undefined){error_msg=response.responseText;}else{error_msg=(response.status+" ("+response.statusText+"). "+"Failed to subscribe "+subscriber.display_name+".");}
Y.lp.app.errors.display_error(false,error_msg);};var config={on:{success:on_success,failure:on_failure},parameters:{person:subscriber.self_link}};this.lp_client.named_post(this.context.self_link,this.subscribe_api,config);};function SubscribersList(config){if(!Y.Lang.isValue(config.subscriber_levels)){Y.error("No subscriber levels specified in `config'.");}
this.subscriber_levels=config.subscriber_levels;this.subscribers_label=config.subscribers_label;this.unsubscribe_label=config.unsubscribe_label;if(!Y.Lang.isValue(config.subscriber_level_order)){this.subscriber_level_order=[];var level;for(level in this.subscriber_levels){if(this.subscriber_levels.hasOwnProperty(level)){this.subscriber_level_order.push(level);}}}else{this.subscriber_level_order=config.subscriber_level_order;}
var container_nodes=Y.all(config.container_box);if(container_nodes.size()===0){Y.error('Container node must be specified in config.container_box.');}else if(container_nodes.size()>1){Y.error("Multiple container nodes for selector '"+
config.container_box+"' present in the page. "+"You need to be more explicit.");}else{this.container_node=container_nodes.item(0);}}
namespace.SubscribersList=SubscribersList;SubscribersList.prototype.resetNoSubscribers=function(force_hide){var has_sections=(this.container_node.one('.'+CSS_CLASSES.section)!==null);var no_subs;if(has_sections||force_hide===true){no_subs=this.container_node.one('.'+CSS_CLASSES.no_subscribers);if(no_subs!==null){no_subs.remove();}}else{var no_text;if(Y.Object.size(this.subscriber_levels)>0){no_text='No other '+this.subscribers_label+'.';}else{no_text='No '+this.subscribers_label+'.';}
no_subs=Y.Node.create('<div />').addClass(CSS_CLASSES.no_subscribers).set('text',no_text);this.container_node.appendChild(no_subs);}};SubscribersList.prototype._ensureActivityNode=function(){var activity_node=this.container_node.one('.'+CSS_CLASSES.activity);if(activity_node===null){activity_node=Y.Node.create('<div />').addClass(CSS_CLASSES.activity);var progress_icon=Y.Node.create('<img />').set('src','/@@/spinner');activity_node.appendChild(progress_icon);activity_node.appendChild(Y.Node.create('<span />').addClass(CSS_CLASSES.activity_text));this.container_node.prepend(activity_node);}
return activity_node;};SubscribersList.prototype._setActivityErrorIcon=function(node,error){var progress_icon=node.one('img');if(error===true){progress_icon.set('src','/@@/error');}else{progress_icon.set('src','/@@/spinner');}};SubscribersList.prototype._setActivityText=function(node,text){var text_node=node.one('.'+CSS_CLASSES.activity_text);text_node.set('text',' '+text);};SubscribersList.prototype.startActivity=function(text){this.resetNoSubscribers(true);var activity_node=this._ensureActivityNode();this._setActivityErrorIcon(activity_node,false);this._setActivityText(activity_node,text);};SubscribersList.prototype.stopActivity=function(error_text){var activity_node=this.container_node.one('.'+CSS_CLASSES.activity);if(Y.Lang.isString(error_text)){activity_node=this._ensureActivityNode(true);this._setActivityErrorIcon(activity_node,true);this._setActivityText(activity_node,error_text);this.resetNoSubscribers(true);}else{if(activity_node!==null){activity_node.remove();}
this.resetNoSubscribers();}};SubscribersList.prototype._getSectionCSSClass=function(level){level=(level===''?'default':level);return CSS_CLASSES.section+'-'+level.toLowerCase();};SubscribersList.prototype._getSection=function(level){return this.container_node.one('.'+this._getSectionCSSClass(level));};SubscribersList.prototype._createSectionNode=function(level){var node=Y.Node.create('<div />').addClass(CSS_CLASSES.section).addClass(this._getSectionCSSClass(level));if(level!==''){node.appendChild(Y.Node.create('<h3 />').set('text',this.subscriber_levels[level]));}
node.appendChild(Y.Node.create('<ul />').addClass(CSS_CLASSES.list));return node;};SubscribersList.prototype._insertSectionNode=function(level,section_node){if(this.subscriber_level_order.length===0){this.container_node.prepend(section_node);return;}
var index,existing_level;var existing_level_node=null;for(index=0;index<this.subscriber_level_order.length;index++){existing_level=this.subscriber_level_order[index];if(existing_level===level){if(existing_level_node===null){this.container_node.prepend(section_node);}else{existing_level_node.insert(section_node,'after');}
break;}else{var existing_node=this._getSection(existing_level);if(existing_node!==null){existing_level_node=existing_node;}}}};SubscribersList.prototype._getOrCreateSection=function(level){var section_node=this._getSection(level);if(section_node===null){section_node=this._createSectionNode(level);this._insertSectionNode(level,section_node);}
this.resetNoSubscribers();return section_node;};SubscribersList.prototype._sectionNodeHasSubscribers=function(node){var list=node.one('.'+CSS_CLASSES.list);if(list!==null){var has_any=(list.one('.'+CSS_CLASSES.subscriber)!==null);return has_any;}else{Y.error('No div.subscribers-list found inside the passed `node`.');}};SubscribersList.prototype._removeSectionNodeIfEmpty=function(node){if(node!==null&&!node.hasClass(CSS_CLASSES.section)){Y.error('Node is not a section node.');}
if(node!==null&&!this._sectionNodeHasSubscribers(node)){node.remove();this.resetNoSubscribers();}};SubscribersList.prototype._getNodeIdForSubscriberName=function(name){return CSS_CLASSES.subscriber+'-'+Y.lp.names.launchpad_to_css(name);};SubscribersList.prototype._validateSubscriber=function(subscriber){if(!Y.Lang.isString(subscriber.name)){Y.error('No `name` passed in `subscriber`.');}
if(!Y.Lang.isString(subscriber.display_name)){subscriber.display_name=subscriber.name;}
if(!Y.Lang.isString(subscriber.web_link)){subscriber.web_link='/~'+subscriber.name;}
return subscriber;};SubscribersList.prototype._createSubscriberNode=function(subscriber){var subscriber_node=Y.Node.create('<li />').addClass(CSS_CLASSES.subscriber);var subscriber_link=Y.Node.create('<a />');subscriber_link.set('href',subscriber.web_link);var formatted_displayname;if(subscriber.display_name.length<=MAX_DISPLAYNAME_LENGTH){formatted_displayname=subscriber.display_name;}else{formatted_displayname=subscriber.display_name.substring(0,MAX_DISPLAYNAME_LENGTH-3)+'...';}
var subscriber_text=Y.Node.create('<span />').addClass('sprite').set('text',formatted_displayname);if(subscriber.is_team===true){subscriber_text.addClass('team');}else{subscriber_text.addClass('person');}
if(Y.Object.owns(subscriber,'display_subscribed_by')&&Y.Lang.isString(subscriber.display_subscribed_by)){subscriber_link.set('title',subscriber.display_subscribed_by);}
subscriber_link.appendChild(subscriber_text);subscriber_node.appendChild(subscriber_link);return subscriber_node;};SubscribersList.prototype._checkSubscriptionLevel=function(level){if(Y.Object.size(this.subscriber_levels)>0&&!this.subscriber_levels.hasOwnProperty(level)){Y.error('Level "'+level+'" is not an acceptable subscription level.');}};SubscribersList.prototype.addSubscriber=function(subscriber,level,add_new,config){this._checkSubscriptionLevel(level);subscriber=this._validateSubscriber(subscriber);var section_node=this._getOrCreateSection(level);var list_node=section_node.one('.'+CSS_CLASSES.list);var subscriber_id=this._getNodeIdForSubscriberName(subscriber.name);var subscriber_node=this.container_node.one('#'+subscriber_id);if(subscriber_node===null){subscriber_node=this._createSubscriberNode(subscriber);subscriber_node.set('id',subscriber_id);if(add_new===true){list_node.prepend(subscriber_node);}else{list_node.append(subscriber_node);}
if(Y.Lang.isValue(config)&&Y.Lang.isFunction(config.unsubscribe_callback)){this.addUnsubscribeAction(subscriber,config.unsubscribe_callback);}}else{var existing_section=subscriber_node.ancestor('.'+CSS_CLASSES.section);if(existing_section===null){Y.error("Matching subscriber node doesn't seem to be in any "+"subscribers list sections.");}
if(existing_section!==section_node){subscriber_node.remove();this._removeSectionNodeIfEmpty(existing_section);list_node.prepend(subscriber_node);}}
return subscriber_node;};SubscribersList.prototype._getSubscriberNode=function(subscriber){subscriber=this._validateSubscriber(subscriber);var subscriber_id=this._getNodeIdForSubscriberName(subscriber.name);var subscriber_node=this.container_node.one('#'+subscriber_id);if(subscriber_node===null){Y.error('Subscriber is not present in the subscribers list. '+'Please call addSubscriber(subscriber) first.');}
return subscriber_node;};SubscribersList.prototype._getOrCreateActionsNode=function(subscriber_node)
{var actions_node=subscriber_node.one('.'+CSS_CLASSES.actions);if(actions_node===null){actions_node=Y.Node.create('<span />').addClass(CSS_CLASSES.actions).setStyle('float','right');subscriber_node.appendChild(actions_node);}
return actions_node;};SubscribersList.prototype.addUnsubscribeAction=function(subscriber,callback){subscriber=this._validateSubscriber(subscriber);if(!Y.Lang.isFunction(callback)){Y.error('Passed in callback for unsubscribe action '+'is not a function.');}
var subscriber_node=this._getSubscriberNode(subscriber);var actions_node=this._getOrCreateActionsNode(subscriber_node);var unsubscribe_node=actions_node.one('.'+CSS_CLASSES.unsubscribe);if(unsubscribe_node===null){unsubscribe_node=Y.Node.create('<a />').addClass(CSS_CLASSES.unsubscribe).set('href','+subscribe').set('title',this.unsubscribe_label+' '+subscriber.display_name);unsubscribe_node.appendChild(Y.Node.create('<img />').set('src','/@@/remove').set('alt','Remove'));var subscriber_list=this;unsubscribe_node.on('click',function(e){e.halt();callback(subscriber_list,subscriber);});actions_node.appendChild(unsubscribe_node);}};SubscribersList.prototype.removeSubscriber=function(subscriber){subscriber=this._validateSubscriber(subscriber);var subscriber_node=this._getSubscriberNode(subscriber);var existing_section=subscriber_node.ancestor('.'+CSS_CLASSES.section);subscriber_node.remove(true);if(existing_section===null){Y.error("Matching subscriber node doesn't seem to be in any "+"subscribers list sections.");}
this._removeSectionNodeIfEmpty(existing_section);};SubscribersList.prototype.indicateSubscriberActivity=function(subscriber){var subscriber_node=this._getSubscriberNode(subscriber);var progress_node=subscriber_node.one('.'+CSS_CLASSES.subscriber_activity);if(progress_node===null){var actions_node=subscriber_node.one('.'+CSS_CLASSES.actions);if(actions_node!==null){actions_node.setStyle('display','none');}
var progress_icon=Y.Node.create('<img />').set('src','/@@/spinner');progress_node=Y.Node.create('<span />').addClass(CSS_CLASSES.subscriber_activity).setStyle('float','right');progress_node.appendChild(progress_icon);subscriber_node.appendChild(progress_node);}};SubscribersList.prototype.stopSubscriberActivity=function(subscriber,success,callback){var subscriber_node=this._getSubscriberNode(subscriber);var progress_node=subscriber_node.one('.'+CSS_CLASSES.subscriber_activity);if(progress_node!==null){progress_node.remove(true);}
var actions_node=subscriber_node.one('.'+CSS_CLASSES.actions);if(actions_node!==null){actions_node.setStyle('display','inline');}
if(success===true||success===false){var anim;if(success===true){anim=Y.lp.anim.green_flash({node:subscriber_node});}else{anim=Y.lp.anim.red_flash({node:subscriber_node});}
anim.on('end',callback);anim.run();}};},"0.1",{"requires":["node","lp.anim","lp.app.picker","lp.app.errors","lp.client","lp.names"]});
/* lp/bugs/javascript/subscribers-min.js */

YUI.add('lp.bugs.subscribers',function(Y){var namespace=Y.namespace('lp.bugs.subscribers');var subscriber_levels={'Discussion':'Notified of all changes','Details':'Notified of all changes except comments','Lifecycle':'Notified when the bug is closed or reopened','Maybe':'May be notified'};var subscriber_level_order=['Discussion','Details','Lifecycle','Maybe'];function createBugSubscribersLoader(config){var url_data=LP.cache.subscribers_portlet_url_data;if(!Y.Lang.isValue(url_data)){url_data={self_link:LP.cache.context.bug_link,web_link:LP.cache.context.web_link};}
config.subscriber_levels=subscriber_levels;config.subscriber_level_order=subscriber_level_order;config.context=url_data;config.subscribe_someone_else_level='Discussion';config.default_subscriber_level='Maybe';var module=Y.lp.app.subscribers.subscribers_list;return new module.SubscribersLoader(config);}
namespace.createBugSubscribersLoader=createBugSubscribersLoader;},"0.1",{"requires":["lp.app.subscribers.subscribers_list"]});
/* lp/app/javascript/ellipsis-min.js */

YUI.add('lp.app.ellipsis',function(Y){var
fp_epsilon=0.01,fp_equals=function(a,b){return Math.abs(a-b)<=fp_epsilon;},fp_greater=function(a,b){return a-b>=fp_epsilon;},fp_lesser=function(a,b){return a-b<=fp_epsilon;},nativeRule=false,nativeStyles={'white-space':'nowrap','overflow':'hidden'},currentStyle=true;Y.DOM.ellipsis=function(node,conf){conf=conf||{};Y.mix(conf,{'ellipsis':'\u2026','fudge':3,'lines':1,'remember':true,'native':true});var yEl=Y.one(node),dataAttrName='ellipsis-original-text',originalText=conf.remember&&yEl.getData(dataAttrName)||yEl.get('text'),currentLength=originalText.length,charIncrement=currentLength,clone=Y.one(document.createElement(yEl.get('nodeName'))),lineHeight,targetHeight,currentHeight,lastKnownGood;var width=currentStyle?node.offsetWidth:yEl.getComputedStyle('width');if(width==='auto'){width=node.offsetWidth;}
clone.setStyles({'overflow':'hidden','position':'absolute','visibility':'hidden','display':'block','bottom':'-10px','left':'-10px','width':width,'fontSize':currentStyle?node.currentStyle.fontSize:yEl.getComputedStyle('fontSize'),'fontFamily':yEl.getComputedStyle('fontFamily'),'fontWeight':yEl.getComputedStyle('fontWeight'),'letterSpacing':yEl.getComputedStyle('letterSpacing'),'lineHeight':yEl.getComputedStyle('lineHeight')});clone.set('text','some sample text');Y.one('body').append(clone);lineHeight=parseFloat(clone.getComputedStyle('height'));if(Y.DOM.ellipsis.nativeSupport&&conf['native']&&1==conf.lines&&'\u2026'===conf.ellipsis){yEl.setStyles(nativeStyles);yEl.setStyle('height',node.offsetHeight+'px');clone.remove();return;}
clone.setStyle('overflow','visible');targetHeight=conf.lines*lineHeight;clone.set('text',originalText);currentHeight=parseFloat(clone.getComputedStyle('height'));if(fp_lesser(currentHeight,targetHeight)&&originalText.length===yEl.get('text').length){clone.remove();return;}
for(;charIncrement>=1;){charIncrement=Math.floor(charIncrement/2);currentLength+=fp_greater(currentHeight,targetHeight)?-charIncrement:+charIncrement;clone.set('text',originalText.slice(0,currentLength-conf.ellipsis.length)+conf.ellipsis);currentHeight=parseFloat(clone.getComputedStyle('height'));if(fp_equals(currentHeight,targetHeight)||fp_lesser(currentHeight,targetHeight)){lastKnownGood=currentLength;}}
clone.remove();if(conf.remember&&!yEl.getData(dataAttrName)){yEl.setData(dataAttrName,originalText);}
if(originalText.length===(clone.get('text').length-conf.ellipsis.length)){yEl.set('text',originalText);}
else if('undefined'!==typeof lastKnownGood){yEl.set('text',originalText.slice(0,lastKnownGood-conf.ellipsis.length-conf.fudge)+conf.ellipsis);}
return yEl;};Y.Node.importMethod(Y.DOM,'ellipsis');Y.NodeList.importMethod(Y.Node.prototype,'ellipsis');Y.on('domready',function(){var cloned,hidden=Y.Node.create('<div style="visibility:hidden;position:absolute;white-space:nowrap;overflow:hidden;"></div>'),rules=['textOverflow','OTextOverflow'];currentStyle=!!(document.body.currentStyle&&(window.CSSCurrentStyleDeclaration||!window.CSSStyleDeclaration));Y.each(rules,function(rule){hidden.setStyle(rule,'ellipsis');});Y.one('body').appendChild(hidden);cloned=hidden.cloneNode(true);Y.some(rules,function(rule){if('ellipsis'===cloned.getStyle(rule)){nativeRule=rule;nativeStyles[nativeRule]='ellipsis';Y.DOM.ellipsis.nativeSupport=true;return true;}});hidden.remove();hidden=cloned=null;});},"0.1",{"requires":[]});
/* lp/code/javascript/branchmergeproposal.diff-min.js */

YUI.add('lp.code.branchmergeproposal.diff',function(Y){var namespace=Y.namespace('lp.code.branchmergeproposal.diff');var DiffOverlay;DiffOverlay=function(){DiffOverlay.superclass.constructor.apply(this,arguments);Y.after(this._setupDismissDiff,this,'syncUI');};Y.extend(DiffOverlay,Y.lp.ui.PrettyOverlay,{bindUI:function(){this.constructor.superclass.bindUI.call(this);},hide:function(){this.constructor.superclass.hide.call(this);this.get('boundingBox').setStyle('display','none');},show:function(){this.constructor.superclass.show.call(this);this.get('boundingBox').setStyle('display','block');}});DiffOverlay.NAME='diff-overlay';var rendered_overlays={};function display_diff(node,api_url,librarian_url,lp_client){if(rendered_overlays[api_url]!==undefined){rendered_overlays[api_url].show();return;}
var html=['<img src="/@@/spinner" alt="loading..." ','     style="padding-left: 0.5em"/>'].join('');var spinner=Y.Node.create(html);node.appendChild(spinner);var config={on:{success:function(formatted_diff){node.removeChild(spinner);var diff_overlay=new DiffOverlay({headerContent:"<h2>Branch Diff</h2>",bodyContent:Y.Node.create(formatted_diff),align:{node:node,points:[Y.WidgetPositionAlign.TL,Y.WidgetPositionAlign.TL]},progressbar:false});rendered_overlays[api_url]=diff_overlay;diff_overlay.render();},failure:function(){node.removeChild(spinner);document.location=librarian_url;}},accept:Y.lp.client.XHTML};lp_client.get(api_url,config);}
namespace.rendered_overlays=rendered_overlays;namespace.link_popup_diff_onclick=function(node,lp_client){if(lp_client===undefined){lp_client=new Y.lp.client.Launchpad();}
var a=node.one('a.diff-link');if(Y.Lang.isValue(a)){a.addClass('js-action');var librarian_url=a.getAttribute('href');var api_url=node.one('a.api-ref').getAttribute('href');a.on('click',function(e){e.preventDefault();display_diff(a,api_url,librarian_url,lp_client);});}};namespace.connect_diff_links=function(){var lp_client=new Y.lp.client.Launchpad();Y.on('lp:branch-linked',namespace.link_popup_diff_onclick);var nl=Y.all('.popup-diff');if(nl){nl.each(function(node,key,node_list){namespace.link_popup_diff_onclick(node,lp_client);});}};},'0.1',{requires:['event','io','node','lp.ui.overlay','lp.client']});
/* yui/view/view-min.js */
YUI.add("view",function(e,t){function n(){n.superclass.constructor.apply(this,arguments)}e.View=e.extend(n,e.Base,{containerTemplate:"<div/>",events:{},template:"",_allowAdHocAttrs:!0,initializer:function(t){t||(t={}),t.containerTemplate&&(this.containerTemplate=t.containerTemplate),t.template&&(this.template=t.template),this.events=t.events?e.merge(this.events,t.events):this.events,this.after("containerChange",this._afterContainerChange)},destroy:function(e){return e&&(e.remove||e["delete"])&&this.onceAfter("destroy",function(){this._destroyContainer()}),n.superclass.destroy.call(this)},destructor:function(){this.detachEvents(),delete this._container},attachEvents:function(t){var n=this.get("container"),r=e.Object.owns,i,s,o,u;this.detachEvents(),t||(t=this.events);for(u in t){if(!r(t,u))continue;s=t[u];for(o in s){if(!r(s,o))continue;i=s[o],typeof i=="string"&&(i=this[i]);if(!i)continue;this._attachedViewEvents.push(n.delegate(o,i,u,this))}}return this},create:function(t){return t?e.one(t):e.Node.create(this.containerTemplate)},detachEvents:function(){return e.Array.each(this._attachedViewEvents,function(e){e&&e.detach()}),this._attachedViewEvents=[],this},remove:function(){var e=this.get("container");return e&&e.remove(),this},render:function(){return this},_destroyContainer:function(){var e=this.get("container");e&&e.remove(!0)},_getContainer:function(e){return this._container||(e?(this._container=e,this.attachEvents()):(e=this._container=this.create(),this._set("container",e))),e},_afterContainerChange:function(){this.attachEvents(this.events)}},{NAME:"view",ATTRS:{container:{getter:"_getContainer",setter:e.one,writeOnce:!0}},_NON_ATTRS_CFG:["containerTemplate","events","template"]})},"3.10.3",{requires:["base-build","node-event-delegate"]});

/* lp/app/javascript/ui/banner-min.js */

YUI.add('lp.ui.banner',function(Y){var ns=Y.namespace('lp.ui.banner');ns.PRIVATE='private';ns.BETA='beta';ns.Banner=Y.Base.create('banner',Y.Widget,[],{template:['<div class="banner">','<span class="badge {{ banner_type }}">{{ badge_text }}</span>','<span class="banner-content">{{{ content }}}</span>','</div>'].join(''),bindUI:function(){this.on('destroy',function(ev){var body=Y.one('body');var banner_type=this.get('banner_type');body.removeClass(banner_type);var container_class='.'+banner_type+'_banner_container';var container=Y.one(container_class);if(container){Y.one(container_class).remove();}});this.after('contentChange',function(){this.renderUI();});},initialize:function(cfg){},renderUI:function(){var contentBox=this.get('contentBox');contentBox.addClass(this.get('banner_type'));var html=Y.lp.mustache.to_html(this.template,this.getAttrs());contentBox.setHTML(html);var body=Y.one('body');body.addClass(this.get('banner_type'));if(this.get('visible')){this.show();}},show:function(){var _node=this.get('boundingBox')._node;var getComputedStyle=document.defaultView.getComputedStyle;_node.style.display=getComputedStyle(_node).display;return this.set('visible',true);}},{ATTRS:{badge_text:{},content:{},boundingBox:{},banner_type:{},visible:{value:false}}});ns.BetaBanner=Y.Base.create('banner',ns.Banner,[],{},{ATTRS:{badge_text:{value:'BETA!'},content:{getter:function(){var content="Some parts of this page are in beta:&nbsp;";var key;var features=this.get('features');for(key in features){if(features.hasOwnProperty(key)){var obj=features[key];if(obj.is_beta){content=content+['<span class="beta-feature">',obj.title].join('');if(obj.url!==''){content=content+['&nbsp;<a class="info-link" href="',obj.url+'">(read more)</a>'].join('');}
content=content+['</span>'].join('');}}}
return content;}},features:{},banner_type:{value:ns.BETA}}});ns.PrivateBanner=Y.Base.create('banner',ns.Banner,[],{},{ATTRS:{badge_text:{value:''},content:{value:'The information on this page is private.'},banner_type:{value:ns.PRIVATE}}});},'0.1',{requires:['base','node','anim','widget','lp.mustache','yui-log']});
/* lp/app/javascript/views/global-min.js */

YUI.add('lp.views.global',function(Y){var ns=Y.namespace('lp.views'),ui=Y.namespace('lp.ui'),info_type=Y.namespace('lp.app.information_type');ns.Global=Y.Base.create('lp-views-global',Y.View,[],{_events:[],_bind_events:function(){var that=this;this._events.push(Y.on(info_type.EV_ISPUBLIC,function(ev){if(that._private_banner){that._private_banner.hide();that._private_banner.destroy(true);that._private_banner=null;var body=Y.one('body');body.addClass('public');}}));this._events.push(Y.on(info_type.EV_ISPRIVATE,function(ev){if(!that._private_banner){that._private_banner=new ui.banner.PrivateBanner({content:ev.text});var container=Y.Node.create('<div class="private_banner_container">');var body=Y.one('body');body.removeClass('public');that._private_banner.render(container);body.prepend(container);that._private_banner.show();}else{that._private_banner.set('content',ev.text);}}));},_destroy:function(ev){var index;for(index in this._events){event=this._events[index];event.detach();}},_init_banners:function(){var that=this;var is_beta=Y.one('.beta_banner_container');if(is_beta){that._beta_banner=new ui.banner.BetaBanner({features:LP.cache.related_features});that._beta_banner.render(is_beta);Y.after('load',function(ev){that._beta_banner.show();});}
var is_private=Y.one('.private_banner_container');if(is_private){that._private_banner=new ui.banner.PrivateBanner();that._private_banner.render(is_private);Y.on('load',function(ev){that._private_banner.show();});}},initialize:function(cfg){},render:function(){this._bind_events();this.on('destroy',this._destroy,this);this._init_banners();}},{ATTRS:{}});},'0.1',{requires:['base','view','lp.ui.banner','lp.app.information_type']});
