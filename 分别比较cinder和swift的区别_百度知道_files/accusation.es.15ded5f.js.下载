define("question:widget/view/accusation/accusation.es",function(t,e,i){"use strict";var s=t("common:widget/js/util/event/event"),a=t("common:widget/lib/jquery/jquery"),n=t("common:widget/js/ui/dialog/dialog");i.exports={target:a("#js-accuse"),init:function(){this.bindEvents()},initParams:function(t){var e=t.itemid,i=t.typeid,s=t.userid,a=t.qid,n=this.target,c=n.find("#js-accuse-title"),o=n.find("#js-accuse-first-reason");0===i?(F.context("accusePostData",{type:1,qid:e,rid:0,uid:s}),c.html(c.data("question")),o.html(o.data("question"))):(F.context("accusePostData",{type:2,qid:a,rid:e,uid:s}),c.html(c.data("answer")),o.html(o.data("answer")))},bindEvents:function(){var t=this,e=this.target,i=e.find("#js-accuse-closebtn"),c=e.find("#js-accuse-btn-cancel"),o=e.find("#js-accuse-btn-submit"),d=e.find("#js-accuse-content"),u=e.find("#js-accuse-words-current"),l=e.find("#js-errmsg"),r="selected",m="disabled",f=function(){e.find(".js-accuse-type-item").removeClass(r),o.addClass(m),d.val(""),u.html(0)};s.on("action-accuse-show",function(i,a){t.initParams(a.params),e.show(),s.fire("showMask")}).on("action-accuse-close",function(){e.hide(),f(),s.fire("hideMask")});var h=function(){s.fire("action-accuse-close")};i.on("click",h),c.on("click",h),o.on("click",function(t){if(o.hasClass(m))return void t.preventDefault();var s=e.find(".js-accuse-type-item."+r).data("reason"),c=F.context("accusePostData");c.reason=s,c.content=d.val().trim(),a.ajax({url:"/submit/index/report",type:"POST",dataType:"json",data:c,cache:!1,success:function(t){var e=t.errno,s=t.errmsg;switch(i.trigger("click"),e){case 0:new n({content:'<div class="ui-dialog-content-title">举报成功</div><div class="ui-dialog-content-text">我们会尽快处理<br>感谢您对百度知道的支持</div>',width:300,height:150,className:"ui-question-widget",close:function(){window.location.reload(!0)},autoDispose:!0}),setTimeout(function(){n.close()},2e3);break;case 4:new n({content:"您的当日举报量已超上限，感谢您的百度知道的支持。",width:300,height:100,className:"ui-question-widget",close:function(){window.location.reload(!0)},autoDispose:!0});break;case 5:var a=1===c.type?"问题":"回答";new n({content:'<div class="ui-dialog-content-title">您已经举报了该'+a+'</div><div class="ui-dialog-content-text">我们会尽快处理，请不要重复举报</div>',width:300,height:120,className:"ui-question-widget",close:function(){window.location.reload(!0)},autoDispose:!0}),setTimeout(function(){n.close()},2e3);break;default:new n({content:s,width:300,height:100,className:"ui-question-widget",close:function(){window.location.reload(!0)},autoDispose:!0})}}})}),e.on("click",".js-accuse-type-item",function(t){e.find(".js-accuse-type-item").removeClass(r);var i=a(t.target),s=d.val().trim().length;i.addClass(r),500>=s&&o.removeClass(m)}),d.on("input",function(){var t=d.val().trim().length;u.html(t);var i=t-200;i>0?(l.html("您已超出"+i+"个文字"),o.addClass(m)):(l.html(""),e.find(".js-accuse-type-item").hasClass(r)&&o.removeClass(m))})}}});