ViewHistory=function(){this.config={limit:10,storageKey:"viewHistory",primaryKey:"url"},this.cache={localStorage:null,userData:null,attr:null}},ViewHistory.prototype={init:function(t){this.config=t||this.config;var e=this;!window.localStorage&&(this.cache.userData=document.body)&&this.cache.userData.addBehavior&&this.cache.userData.addBehavior("#default#userdata")?(this.cache.userData.load(this.cache.attr="localStorage"),this.cache.localStorage={getItem:function(t){return e.cache.userData.getAttribute(t)},setItem:function(t,i){e.cache.userData.setAttribute(t,i),e.cache.userData.save(e.cache.attr)}}):this.cache.localStorage=window.localStorage},addHistory:function(t){for(var e=this.getHistories(),i=0,a=e.length;i<a;i++)if(t[this.config.primaryKey]&&e[i][this.config.primaryKey]&&t[this.config.primaryKey]===e[i][this.config.primaryKey]){e.splice(i,1);break}e.push(t),this.config.limit>0&&e.length>this.config.limit&&e.splice(0,1);var r=JSON.stringify(e);this.cache.localStorage.setItem(this.config.storageKey,r)},getHistories:function(){var t=this.cache.localStorage.getItem(this.config.storageKey);return t?JSON.parse(t):[]}};ViewHistory=function(){this.config={limit:10,storageKey:"viewHistory",primaryKey:"url"},this.cache={localStorage:null,userData:null,attr:null}},ViewHistory.prototype={init:function(t){this.config=t||this.config;var e=this;!window.localStorage&&(this.cache.userData=document.body)&&this.cache.userData.addBehavior&&this.cache.userData.addBehavior("#default#userdata")?(this.cache.userData.load(this.cache.attr="localStorage"),this.cache.localStorage={getItem:function(t){return e.cache.userData.getAttribute(t)},setItem:function(t,i){e.cache.userData.setAttribute(t,i),e.cache.userData.save(e.cache.attr)}}):this.cache.localStorage=window.localStorage},addHistory:function(t){for(var e=this.getHistories(),i=0,a=e.length;a>i;i++)if(t[this.config.primaryKey]&&e[i][this.config.primaryKey]&&t[this.config.primaryKey]===e[i][this.config.primaryKey]){e.splice(i,1);break}e.push(t),this.config.limit>0&&e.length>this.config.limit&&e.splice(0,1);var c=JSON.stringify(e);this.cache.localStorage.setItem(this.config.storageKey,c)},getHistories:function(){var t=this.cache.localStorage.getItem(this.config.storageKey);return t?JSON.parse(t):[]},clearHistories:function(){this.cache.localStorage.clear()}};