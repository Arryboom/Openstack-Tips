define("question:widget/image-scale/image-scale",function(e,t,i){var o=e("common:widget/js/util/tangram/tangram"),n=function(e){this.body=o("body"),this.selector=e||"image",this.screenSize={},this.win=o(window),this.bindEvent()};n.prototype={updateScreenSize:function(){this.screenSize.width=document.documentElement.clientWidth,this.screenSize.height=document.documentElement.clientHeight,this.screenSize.top=document.documentElement.scrollTop+document.body.scrollTop,this.screenSize.left=document.documentElement.scrollLeft+document.body.scrollLeft},bindEvent:function(){var e=this;e.body.on("click",e.selector,function(t){t.preventDefault(),t.stopImmediatePropagation();var i=t.target||t.srcElement;i&&e.render(i)}),e.body.on("mouseenter",e.selector,function(e){e.preventDefault(),e.stopImmediatePropagation();var t=e.target||e.srcElement;o(t).css({cursor:"zoom-in"})}),e.body.on("mouseleave",e.selector,function(e){e.preventDefault(),e.stopImmediatePropagation();var t=e.target||e.srcElement;o(t).css({cursor:"auto"})}),e.win.on("resize",function(){e.updateScreenSize()})},render:function(e){var t=this;t.updateScreenSize();var i=o(e);t.scrollFn=function(){t.position=i.offset(),t.updateScreenSize()},t.position=i.offset(),t.win.on("scroll",t.scrollFn),t.selfWidth=i.width(),t.selfHeight=i.height(),t.mask?t.mask.show():(t.mask=t.mask||t.getDom("div",{styles:{visibility:"hidden",position:"fixed",zIndex:1100,left:t.position.left-t.screenSize.left,top:t.position.top-t.screenSize.top}}),t.mask.click(function(){t.image.animate({width:t.selfWidth,height:t.selfHeight,left:t.position.left-t.screenSize.left,top:t.position.top-t.screenSize.top,marginLeft:0,marginTop:0},500,function(){t.image.hide(),t.mask.hide(),t.win.off("scroll",t.scrollFn)})})),t.image?(t.image.attr("src",i.attr("src")),t.image.css({width:"auto",height:"auto",left:t.position.left-t.screenSize.left,top:t.position.top-t.screenSize.top}),t.image.show()):(t.image=t.getDom("img",{src:i.attr("src"),styles:{cursor:"zoom-out",position:"fixed",visibility:"hidden",zIndex:1102,left:t.position.left-t.screenSize.left,top:t.position.top-t.screenSize.top}}),t.image.click(function(){t.image.animate({width:t.selfWidth,height:t.selfHeight,left:t.position.left-t.screenSize.left,top:t.position.top-t.screenSize.top,marginLeft:0,marginTop:0},500,function(){t.image.hide(),t.mask.hide(),t.win.off("scroll",t.scrollFn)})})),t.body.append(t.mask),t.body.append(t.image);var n={width:t.image.width(),height:t.image.height()};t.image.css({width:t.selfWidth,height:t.selfHeight,visibility:"visible"}),t.mask.css({top:0,left:0,opacity:.8,width:"100%",height:"100%",visibility:"visible",backgroundColor:"#fff",filter:"alpha(opacity=90)"});var s=0,r=0;n.width>=n.height?(s=n.width>=t.screenSize.width?t.screenSize.width:n.width,r=n.height*s/n.width):(r=n.height>=t.screenSize.height?t.screenSize.height:n.height,s=r*n.width/n.height);var c={left:"50%",top:"50%",width:s,height:r};t.image.animate({top:c.top,left:c.left,width:c.width,height:c.height,marginLeft:"-"+s/2+"px",marginTop:"-"+r/2+"px"},500)},getDom:function(e,t){var i=o("<"+e+"/>");return o.each(t,function(e,t){"styles"!=e&&i.attr(e,t)}),t.styles&&i.css(t.styles),i}},i.exports.init=function(e){return new n(e)}});