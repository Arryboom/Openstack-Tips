define("question:widget/view/accusation/accusation.es",function(t,e,i){"use strict";var s=t("common:widget/js/util/event/event"),n=t("common:widget/lib/jquery/jquery"),a=t("common:widget/js/ui/dialog/dialog");i.exports={target:n("#js-accuse"),init:function(){this.bindEvents()},initParams:function(t){var e=t.itemid,i=t.typeid,s=t.userid,n=t.qid,a=this.target,c=a.find("#js-accuse-title"),o=a.find("#js-accuse-first-reason");0===i?(F.context("accusePostData",{type:1,qid:e,rid:0,uid:s}),c.html(c.data("question")),o.html(o.data("question"))):(F.context("accusePostData",{type:2,qid:n,rid:e,uid:s}),c.html(c.data("answer")),o.html(o.data("answer")))},bindEvents:function(){var t=this,e=this.target,i=e.find("#js-accuse-closebtn"),c=e.find("#js-accuse-btn-cancel"),o=e.find("#js-accuse-btn-submit"),d=e.find("#js-accuse-content"),u=e.find("#js-accuse-words-current"),r=e.find("#js-errmsg"),l="selected",m="disabled",f=function(){e.find(".js-accuse-type-item").removeClass(l),o.addClass(m),d.val(""),u.html(0)};s.on("action-accuse-show",function(i,n){t.initParams(n.params),e.show(),s.fire("showMask")}).on("action-accuse-close",function(){e.hide(),f(),s.fire("hideMask")});var w=function(){s.fire("action-accuse-close")};i.on("click",w),c.on("click",w),o.on("click",function(t){if(o.hasClass(m))return void t.preventDefault();var s=e.find(".js-accuse-type-item."+l).data("reason"),c=F.context("accusePostData");c.reason=s,c.content=d.val().trim(),n.ajax({url:"/submit/index/report",type:"POST",dataType:"json",data:c,cache:!1,success:function(t){var e=t.errno,s=t.errmsg;switch(i.trigger("click"),e){case 0:new a({content:'<div class="ui-dialog-content-title">举报成功</div><div class="ui-dialog-content-text">我们会尽快处理<br>感谢您对百度知道的支持</div>',width:300,height:150,className:"ui-question-widget",close:function(){window.location.reload(!0)},autoDispose:!0}),setTimeout(function(){a.close()},2e3);break;case 4:new a({content:"您的当日举报量已超上限，感谢您的百度知道的支持。",width:300,height:100,className:"ui-question-widget",close:function(){window.location.reload(!0)},autoDispose:!0});break;case 5:var n=1===c.type?"问题":"回答";new a({content:'<div class="ui-dialog-content-title">您已经举报了该'+n+'</div><div class="ui-dialog-content-text">我们会尽快处理，请不要重复举报</div>',width:300,height:120,className:"ui-question-widget",close:function(){window.location.reload(!0)},autoDispose:!0}),setTimeout(function(){a.close()},2e3);break;default:new a({content:s,width:300,height:100,className:"ui-question-widget",close:function(){window.location.reload(!0)},autoDispose:!0})}}})}),e.on("click",".js-accuse-type-item",function(t){e.find(".js-accuse-type-item").removeClass(l);var i=n(t.target),s=d.val().trim().length;i.addClass(l),500>=s&&o.removeClass(m)}).on("click",".tort-entry",function(){var t=F.context("accusePostData");t&&(1===t.type?window.open("/misc/tortreportcontentlist?qid="+t.qid+"&type=1"):2===t.type&&window.open("/misc/tortreportcontentlist?qid="+t.qid+"&rid="+t.rid+"&type=2"),s.fire("action-accuse-close"))}),d.on("input",function(){var t=d.val().trim().length;u.html(t);var i=t-200;i>0?(r.html("您已超出"+i+"个文字"),o.addClass(m)):(r.html(""),e.find(".js-accuse-type-item").hasClass(l)&&o.removeClass(m))})}}});