window.___jsl=window.___jsl||{};window['___jsl']['f'] = ['auth-refresh','core','core.config','core.config.base','core.io','core.json','core.legacy','core.log','core.prefs','core.util','core.util.base','core.util.dom','core.util.event','core.util.onload','core.util.string','core.util.urlparams','domnode','globals','locked-domain','opensocial','opensocial-base','opensocial-jsonrpc','opensocial-reference','rpc','security-token','shindig.auth','shindig.uri','taming'];gadgets=window.gadgets||{};shindig=window.shindig||{};osapi=window.osapi||{};var DOM_ELEMENT_NODE=1,DOM_ATTRIBUTE_NODE=2,DOM_TEXT_NODE=3,DOM_CDATA_SECTION_NODE=4,DOM_ENTITY_REFERENCE_NODE=5,DOM_ENTITY_NODE=6,DOM_PROCESSING_INSTRUCTION_NODE=7,DOM_COMMENT_NODE=8,DOM_DOCUMENT_NODE=9,DOM_DOCUMENT_TYPE_NODE=10,DOM_DOCUMENT_FRAGMENT_NODE=11,DOM_NOTATION_NODE=12;var safeJSON=window.safeJSON,tamings___=window.tamings___||[],bridge___,caja___=window.caja___,___=window.___;window.gadgets.config||(gadgets.config=function(){function l(a,b){for(var e in b)b.hasOwnProperty(e)&&("object"===typeof a[e]&&"object"===typeof b[e]?l(a[e],b[e]):a[e]=b[e])}function q(a){var b="";if(a.nodeType==DOM_TEXT_NODE||a.nodeType==DOM_CDATA_SECTION_NODE)b=a.nodeValue;else if(a.innerText)b=a.innerText;else if(a.innerHTML)b=a.innerHTML;else if(a.firstChild){b=[];for(a=a.firstChild;a;a=a.nextSibling)b.push(q(a));b=b.join("")}return b}function r(a){var b=(f["core.io"]||{}).jsPath||null,e=[],d=
0,c=document.scripts||document.getElementsByTagName("script");if(c&&0!=c.length){for(var h=0;h<c.length;++h){var g=c[h].src,k=null!=b&&g&&g.indexOf(b)||-1;-1!=k&&/.*[.]js.*[?&]c=[01](#|&|$).*/.test(g.substring(k+b.length))&&(e[d++]=c[h])}e.length||(b=c[c.length-1],b.src&&(e[0]=b))}if(e.length)for(b=0;b<e.length;b++){d=q(e[b]);c=void 0;try{c=(new Function("return ("+d+"\n)"))()}catch(n){}if("object"===typeof c)d=c;else{try{c=(new Function("return ({"+d+"\n})"))()}catch(p){}d="object"===typeof c?c:
{}}m.f&&1==m.f.length&&!d[m.f[0]]&&(c={},c[m.f[0]]=d,d=c);l(a,d);(d=window.___cfg)&&l(a,d)}}function p(a){for(var b in k)if(k.hasOwnProperty(b))for(var e=k[b],d=0,c=e.length;d<c;++d)a(b,e[d])}var m,k={},f={},n=!1;return{register:function(a,b,e,d){var c=k[a];c||(c=[],k[a]=c);c.push({validators:b||{},callback:e,callOnUpdate:d});n&&e&&e(f)},get:function(a){return a?f[a]||{}:f},init:function(a,b){m=window.___jsl||{};l(f,a);r(f);l(f,window.___config||{});p(function(a,d){var c=f[a];if(c&&!b){var h=d.validators,
g;for(g in h)if(h.hasOwnProperty(g)&&!h[g](c[g]))throw Error('Invalid config value "'+c[g]+'" for parameter "'+g+'" in component "'+a+'"');}d.callback&&d.callback(f)});n=!0},update:function(a,b){var e=[];p(function(c,d){(a.hasOwnProperty(c)||b&&f&&f[c])&&d.callback&&d.callOnUpdate&&e.push(d.callback)});f=b?{}:f||{};l(f,a);for(var d=0,c=e.length;d<c;++d)e[d](f)},clear:function(){gadgets.warn("This method is for testing.");m=void 0;f={};n=!1}}}());gadgets.log=function(){function d(a,c){"undefined"===typeof b&&(b=window.console?window.console:window.opera?window.opera.postError:null);!(a<e)&&b&&(2===a&&b.warn?b.warn(c):3===a&&b.error?b.error(c):b.log&&b.log(c))}var c=function(a){d(1,a)};gadgets.warn=function(a){d(2,a)};gadgets.error=function(a){d(3,a)};gadgets.setLogLevel=function(a){e=a};c.INFO=1;c.WARNING=2;c.NONE=4;var e=1,b;return c}();gadgets.util=gadgets.util||{};
(function(){var e=null;gadgets.util.getUrlParameters=function(a){var g="undefined"===typeof a;if(null!==e&&g)return e;var f={};a=a||document.location.href;var d=a.indexOf("?"),b=a.indexOf("#");a=(-1===b?a.substr(d+1):[a.substr(d+1,b-d-1),"\x26",a.substr(b+1)].join("")).split("\x26");for(var d=window.decodeURIComponent?decodeURIComponent:unescape,b=0,h=a.length;b<h;++b){var c=a[b].indexOf("\x3d");if(-1!==c){var k=a[b].substring(0,c),c=a[b].substring(c+1),c=c.replace(/\+/g," ");try{f[k]=d(c)}catch(l){}}}g&&
(e=f);return f}})();gadgets.util.getUrlParameters();(function(){gadgets.config.EnumValidator=function(a){var c=[];if(1<arguments.length)for(var b=0,d;d=arguments[b];++b)c.push(d);else c=a;return function(a){for(var b=0;c[b];++b)if(a===c[b])return!0;return!1}};gadgets.config.RegExValidator=function(a){return function(c){return a.test(c)}};gadgets.config.ExistsValidator=function(a){return"undefined"!==typeof a};gadgets.config.NonEmptyStringValidator=function(a){return"string"===typeof a&&0<a.length};gadgets.config.BooleanValidator=function(a){return"boolean"===
typeof a};gadgets.config.LikeValidator=function(a){return function(c){for(var b in a)if(a.hasOwnProperty(b)&&!(0,a[b])(c[b]))return!1;return!0}}})();gadgets.util=gadgets.util||{};gadgets.util.makeClosure=function(e,c,a){for(var d=[],b=2,f=arguments.length;b<f;++b)d.push(arguments[b]);return function(){for(var a=d.slice(),b=0,f=arguments.length;b<f;++b)a.push(arguments[b]);return c.apply(e,a)}};gadgets.util.makeEnum=function(e){var c,a,d={};for(c=0;a=e[c];++c)d[a]=a;return d};gadgets.util.shouldPollXhrReadyStateChange=function(){return document.all&&!document.querySelector?!0:!1};gadgets.util=gadgets.util||{};
(function(){gadgets.util.createElement=function(a){var b;if(!document.body||document.body.namespaceURI)try{b=document.createElementNS("http://www.w3.org/1999/xhtml",a)}catch(d){}return b||document.createElement(a)};gadgets.util.createIframeElement=function(a){var b=gadgets.util.createElement("iframe");try{var d,c=["\x3c","iframe"],g=a||{},e;for(e in g)g.hasOwnProperty(e)&&(c.push(" "),c.push(e),c.push('\x3d"'),c.push(gadgets.util.escapeString(g[e])),c.push('"'));c.push("\x3e\x3c/");c.push("iframe");
c.push("\x3e");d=c.join("");var f=gadgets.util.createElement(d);if(f&&(!b||f.tagName==b.tagName&&f.namespaceURI==b.namespaceURI))b=f}catch(k){}d=b;a=a||{};for(var h in a)a.hasOwnProperty(h)&&(d[h]=a[h]);return b};gadgets.util.getBodyElement=function(){if(document.body)return document.body;try{var a=document.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","body");if(a&&1==a.length)return a[0]}catch(b){}return document.documentElement||document}})();gadgets.util=gadgets.util||{};gadgets.util.attachBrowserEvent=function(a,b,c,d){"undefined"!=typeof a.addEventListener?a.addEventListener(b,c,d):"undefined"!=typeof a.attachEvent?a.attachEvent("on"+b,c):gadgets.warn("cannot attachBrowserEvent: "+b)};gadgets.util.removeBrowserEvent=function(a,b,c,d){a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent?a.detachEvent("on"+b,c):gadgets.warn("cannot removeBrowserEvent: "+b)};gadgets.util=gadgets.util||{};
(function(){var b=[];gadgets.util.registerOnLoadHandler=function(c){b.push(c)};gadgets.util.runOnLoadHandlers=function(){gadgets.util.registerOnLoadHandler=function(a){a()};if(b){for(var c=0,a=b.length;c<a;++c)try{b[c]()}catch(h){gadgets.warn("Could not fire onloadhandler "+h.message)}b=void 0}};(function(){gadgets.util.attachBrowserEvent(document,"DOMContentLoaded",gadgets.util.runOnLoadHandlers,!1);var c=window.onload;window.onload=function(){c&&c();gadgets.util.runOnLoadHandlers()};var a="";window&&
(window.location&&window.location.href)&&(a=gadgets.util.getUrlParameters(window.location.href).libs);if(a=/(?:js\/)([^&|\.]+)/g.exec(a))for(var a=decodeURIComponent(a[1]),b=document.getElementsByTagName("script")||[],d=0;d<b.length;d++){var e=b[d],f=e.src;if(f&&a&&-1!==f.indexOf(a)){var g=e.onload;e.onload=function(){g&&g();gadgets.util.runOnLoadHandlers()}}}})()})();gadgets.util=gadgets.util||{};
(function(){function f(a,d){return String.fromCharCode(d)}var g={"0":!1,10:!0,13:!0,34:!0,39:!0,60:!0,62:!0,92:!0,8232:!0,8233:!0,65282:!0,65287:!0,65308:!0,65310:!0,65340:!0};gadgets.util.escape=function(a,d){if(a){if("string"===typeof a)return gadgets.util.escapeString(a);if("array"===typeof a)for(var b=0,c=a.length;b<c;++b)a[b]=gadgets.util.escape(a[b]);else if("object"===typeof a&&d){b={};for(c in a)a.hasOwnProperty(c)&&(b[gadgets.util.escapeString(c)]=gadgets.util.escape(a[c],!0));return b}}return a};
gadgets.util.escapeString=function(a){if(!a)return a;for(var d=[],b,c,e=0,f=a.length;e<f;++e)b=a.charCodeAt(e),c=g[b],!0===c?d.push("\x26#",b,";"):!1!==c&&d.push(a.charAt(e));return d.join("")};gadgets.util.unescapeString=function(a){return!a?a:a.replace(/&#([0-9]+);/g,f)}})();gadgets.util=gadgets.util||{};
(function(){function f(a){a=(a=a["core.io"])&&a.jsPath;for(var b=document.getElementsByTagName("script"),c=0;a&&c<b.length;c++){var d=b[c].src;if(d&&-1<d.indexOf(a))return e="1"==gadgets.util.getUrlParameters(d).debug}e=!1}function g(a){b=a["core.util"]||{}}var b={},h={},e;gadgets.config&&(gadgets.config.register("core.util",null,g),gadgets.config.register("core.io",void 0,f,f));gadgets.util.getFeatureParameters=function(a){return"undefined"===typeof b[a]?null:b[a]};gadgets.util.hasFeature=function(a){return"undefined"!==
typeof b[a]};gadgets.util.getServices=function(){return h};gadgets.util.isDebug=function(){return e}})();"undefined"===typeof shindig.uri&&(shindig.uri=function(){var E=/^(?:([^:/?#]+):)?(?:\/\/([^/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/;return function(k){function r(a){if(null===a.match(E))throw"Malformed URL: "+a;l=RegExp.$1;m=RegExp.$2;p=RegExp.$3;g=RegExp.$4;h=RegExp.$5}function s(a){for(var b=[],d=0,F=a.length;d<F;++d){var n=a[d][0],c=a[d][1];"undefined"!=typeof c&&b.push(t(n)+(null!==c?"\x3d"+t(c):""))}return b.join("\x26")}function u(){c&&(g=s(c),c=null);return g}function v(){f&&(h=s(f),f=null);
return h}function w(a){c=c||q(g);return x(c,a)}function y(a){f=f||q(h);return x(f,a)}function z(a,b){c=A(c||q(g),a,b);return e}function B(a,b){f=A(f||q(h),a,b);return e}function C(){return[l,""!==l?":":"",""!==m?"//":"",m].join("")}function q(a){var b=[];if(""===a)return b;a=a.split("\x26");for(var d=0,c=a.length;d<c;++d){var n=a[d].split("\x3d"),f=n.shift(),e=null;0<n.length&&(e=n.join("").replace(/\+/g," "));b.push([f,null!=e?G(e):null])}return b}function x(a,b){for(var d=0,c=a.length;d<c;++d)if(a[d][0]==
b)return a[d][1]}function A(a,b,d){var c=b;"string"===typeof b&&(c={},c[b]=d);for(var e in c){b=!1;d=0;for(var f=a.length;!b&&d<f;++d)a[d][0]==e&&(a[d][1]=c[e],b=!0);b||a.push([e,c[e]])}return a}function D(a,b){a=a||"";a[0]===b&&(a=a.substr(b.length));return a}var l="",m="",p="",g="",c=null,h="",f=null,G=window.decodeURIComponent?decodeURIComponent:unescape,t=window.encodeURIComponent?encodeURIComponent:escape,e=null;"object"===typeof k&&"function"===typeof k.toString?r(k.toString()):k&&r(k);return e=
{getSchema:function(){return l},getAuthority:function(){return m},getOrigin:C,getPath:function(){return p},getQuery:u,getFragment:v,getQP:w,getFP:y,setSchema:function(a){l=a;return e},setAuthority:function(a){m=a;return e},setPath:function(a){"undefined"!==typeof a&&null!=a&&(p=("/"===a.charAt(0)?"":"/")+a);return e},setQuery:function(a){c=null;g=D(a,"?");return e},setFragment:function(a){f=null;h=D(a,"#");return e},setQP:z,setFP:B,setExistingP:function(a,b){"undefined"!=typeof w(a,b)&&z(a,b);"undefined"!=
typeof y(a,b)&&B(a,b);return e},removePrefix:function(a){return 0==a.indexOf("http://")?a.substr(7):0==a.indexOf("https://")?a.substr(8):0==a.indexOf("//")?a.substr(2):a},toString:function(){var a=u(),b=v();return[C(),p,""!==a?"?":"",a,""!==b?"#":"",b].join("")}}}}());window.JSON&&(window.JSON.parse&&window.JSON.stringify)&&(gadgets.json=function(){function d(a,b){return this[a]}var e=/___$/;return{parse:function(a){try{return window.JSON.parse(a)}catch(b){return!1}},stringify:function(a){function b(a){return c.call(this,a,d)}var c=window.JSON.stringify,f=Array.prototype.toJSON&&'"[{\\"x\\": 1}]"'===c([{x:1}])?b:c;try{return f(a,function(a,b){return!e.test(a)?b:void 0})}catch(g){return null}}}}());if(!window.JSON||!window.JSON.parse||!window.JSON.stringify)gadgets.json=function(){function c(a){return 10>a?"0"+a:a}function e(a){var d,b,c;d=/[\"\\\x00-\x1f\x7f-\x9f]/g;switch(typeof a){case "string":return d.test(a)?'"'+a.replace(d,function(a){var b=f[a];if(b)return b;b=a.charCodeAt();return"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16)})+'"':'"'+a+'"';case "number":return isFinite(a)?String(a):"null";case "boolean":case "null":return String(a);case "object":if(!a)return"null";d=[];
if("number"===typeof a.length&&!a.propertyIsEnumerable("length")){c=a.length;for(b=0;b<c;b+=1)d.push(e(a[b])||"null");return"["+d.join(",")+"]"}for(b in a)!/___$/.test(b)&&a.hasOwnProperty(b)&&"string"===typeof b&&(c=e(a[b]))&&d.push(e(b)+":"+c);return"{"+d.join(",")+"}"}return""}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",c(this.getUTCMonth()+1),"-",c(this.getUTCDate()),"T",c(this.getUTCHours()),":",c(this.getUTCMinutes()),":",c(this.getUTCSeconds()),"Z"].join("")};var f={"\b":"\\b",
"\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return{stringify:e,parse:function(a){return/^[\],:{}\s]*$/.test(a.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))?eval("("+a+")"):!1}}}();gadgets.json.flatten=function(a){var c={};if(null===a||"undefined"==typeof a)return c;for(var d in a)if(a.hasOwnProperty(d)){var b=a[d];null===b||"undefined"==typeof b||(c[d]="string"===typeof b?b:gadgets.json.stringify(b))}return c};shindig.Auth=function(){function g(a){for(var b=c.split("\x26"),f=0;f<b.length;f++){var d=b[f].split("\x3d");if(2===d.length){var e=d[0],d=d[1];"$"===d&&(d=encodeURIComponent(a[e]),b[f]=e+"\x3d"+d)}}c=b.join("\x26")}var c=null,e=null;gadgets.config.register("shindig.auth",null,function(a){var b=gadgets.util.getUrlParameters();a=a["shindig.auth"]||{};a.authToken?c=a.authToken:b.st&&(c=b.st);null!==c&&g(b);a.trustedJson&&(e=eval("("+a.trustedJson+")"))});return{getSecurityToken:function(){return c},
updateSecurityToken:function(a){c=a},getTrustedData:function(){return e}}};shindig&&!shindig.auth&&(shindig.auth=new shindig.Auth);gadgets.rpctx=gadgets.rpctx||{};
gadgets.rpctx.wpm||(gadgets.rpctx.wpm=function(){function g(a,b,c){"undefined"!=typeof window.addEventListener?window.addEventListener(a,b,c):"undefined"!=typeof window.attachEvent&&window.attachEvent("on"+a,b)}function h(a){var b=gadgets.json.parse(a.data);if(b&&b.f){var c=gadgets.rpc.getTargetOrigin(b.f);(!e||!("undefined"!==typeof a.origin?a.origin!==c:a.domain!==/^.+:\/\/([^:]+).*/.exec(c)[1]))&&f(b,a.origin)}}var f,d,e=!0;return{getCode:function(){return"wpm"},isParentVerifiable:function(){return!0},
init:function(a,b){gadgets.config.register("rpc",null,function(a){if("true"===String((a?a.rpc:{}).disableForceSecure))e=!1});f=a;d=b;g("message",h,!1);d("..",!0);return!0},setup:function(a,b){d(a,!0);return!0},call:function(a,b,c){var d=gadgets.rpc.getTargetOrigin(a),e=gadgets.rpc._getTargetWin(a);d?window.setTimeout(function(){e.postMessage(gadgets.json.stringify(c),d)},0):gadgets.error("No relay set (used as window.postMessage targetOrigin), cannot send cross-domain message");return!0}}}());gadgets.rpctx=gadgets.rpctx||{};
gadgets.rpctx.flash||(gadgets.rpctx.flash=function(){function k(a,b){p[b]=p[b]||function(){a.apply({},arguments)};return q+"."+b}function r(){if(null===c&&document.body&&l){var a=l+"?cb\x3d"+Math.random()+"\x26origin\x3d"+I+"\x26jsl\x3d1",b=document.createElement("div");b.style.height="1px";b.style.width="1px";a='\x3cobject height\x3d"1" width\x3d"1" id\x3d"'+J+'" type\x3d"application/x-shockwave-flash"\x3e\x3cparam name\x3d"allowScriptAccess" value\x3d"always"\x3e\x3c/param\x3e\x3cparam name\x3d"movie" value\x3d"'+a+
'"\x3e\x3c/param\x3e\x3cembed type\x3d"application/x-shockwave-flash" allowScriptAccess\x3d"always" src\x3d"'+a+'" height\x3d"1" width\x3d"1"\x3e\x3c/embed\x3e\x3c/object\x3e';document.body.appendChild(b);b.innerHTML=a;c=b.firstChild}++s;null!==e&&(null!==c||s>=K)?window.clearTimeout(e):e=window.setTimeout(r,t)}function u(){m[".."]||(v(".."),w++,w>=L&&null!==g?(window.clearTimeout(g),g=null):g=window.setTimeout(u,x))}function n(){if(null!==c&&c.setup){for(;0<h.length;){var a=h.shift(),b=a.targetId,
a=a.token;if(void 0===a||null===a||""===a)a=y;c.setup(a,".."===b?gadgets.rpc.RPC_ID:b,".."===b?"INNER":"OUTER")}null!==f&&(window.clearTimeout(f),f=null)}else 0<h.length&&z<M&&(z++,null!==f&&(window.clearTimeout(f),f=null),f=window.setTimeout(n,N))}function A(){n();null!==e&&window.clearTimeout(e);e=null}function B(){!m[".."]&&null===g&&(g=window.setTimeout(u,x))}function C(a,b,e){if(!c||null===c)return!0;b=gadgets.rpc.getTargetOrigin(a);var d=gadgets.rpc.getAuthToken(a);if(void 0===d||null===d||
""===d)d=y;a="sendMessage_"+(".."===a?gadgets.rpc.RPC_ID:a)+"_"+d+"_"+(".."===a?"INNER":"OUTER");d=c[a];if(!d||null===d)return"undefined"!==typeof console&&(null!==console&&"undefined"!==typeof console.log&&null!==console.log)&&console.log("There isn't message handler was found for the target message and then returning false, handleKey \x3d "+a),!1;d.call(c,gadgets.json.stringify(e),b);return!0}function D(a,b,c){var d=gadgets.json.parse(a);(a=d[E])?(F(a,!0),m[a]=!0,".."!==a&&v(a,!0)):window.setTimeout(function(){G(d,
b)},0)}function v(a,b){var c=gadgets.rpc.RPC_ID,d={};d[E]=b?"..":c;d[O]=c;C(a,c,d)}var J="___xpcswf",l=null,H=!1,G=null,F=null,c=null,t=100,K=200,h=[],f=null,N=500,e=null,s=0,E="_scr",O="_pnt",x=100,L=50,w=0,g=null,m={},I=window.location.protocol+"//"+window.location.host,q,y="NOKEY",z=0,M=30,p=function(){window.___jsl=window.___jsl||{};var a=window.___jsl._fm={};q="___jsl._fm";return a}();gadgets.config.register("rpc",null,function(a){H&&(l=a.rpc.commSwf||"//xpc.googleusercontent.com/gadgets/xpc.swf")});
k(A,"ready");k(B,"setupDone");k(D,"receiveMessage");return{getCode:function(){return"flash"},isParentVerifiable:function(){return!0},init:function(a,b){G=a;F=b;return H=!0},setup:function(a,b){h.push({token:b,targetId:a});null===c&&null===e&&(e=window.setTimeout(r,t));n();return!0},call:C,_receiveMessage:D,_ready:A,_setupDone:B}}());gadgets.rpctx=gadgets.rpctx||{};
gadgets.rpctx.frameElement||(gadgets.rpctx.frameElement=function(){function k(a,l,e){try{if(".."!==l){var d=window.frameElement;if("function"===typeof d[b])return"function"!==typeof d[b][c]&&(d[b][c]=function(a){f(gadgets.json.parse(a))}),d[b](gadgets.json.stringify(e)),!0}else{var g=document.getElementById(a);if("function"===typeof g[b]&&"function"===typeof g[b][c])return g[b][c](gadgets.json.stringify(e)),!0}}catch(h){}return!1}var b="__g2c_rpc",c="__c2g_rpc",f,h;return{getCode:function(){return"fe"},
isParentVerifiable:function(){return!1},init:function(a,b){f=a;h=b;return!0},setup:function(a,c){if(".."!==a)try{document.getElementById(a)[b]=function(a){f(gadgets.json.parse(a))}}catch(e){return!1}".."===a&&(h("..",!0),gadgets.util.registerOnLoadHandler(function(){window.setTimeout(function(){gadgets.rpc.call(a,gadgets.rpc.ACK)},500)}));return!0},call:function(a,b,c){return k(a,b,c)}}}());gadgets.rpctx=gadgets.rpctx||{};
gadgets.rpctx.nix||(gadgets.rpctx.nix=function(){function f(){var a=d[".."];if(!a)if(++g>h)gadgets.warn("Nix transport setup failed, falling back..."),e("..",!1);else{if(!a&&(window.opener&&"GetAuthToken"in window.opener)&&(a=window.opener,a.GetAuthToken()==gadgets.rpc.getAuthToken(".."))){var b=gadgets.rpc.getAuthToken("..");a.CreateChannel(window[c]("..",b),b);d[".."]=a;window.opener=null;e("..",!0);return}window.setTimeout(function(){f()},k)}}var c="GRPC____NIXVBS_get_wrapper",h=10,k=500,d={},
e,g=0;return{getCode:function(){return"nix"},isParentVerifiable:function(){return!1},init:function(a,b){e=b;if("unknown"!==typeof window[c]){window.GRPC____NIXVBS_handle_message=function(b){window.setTimeout(function(){a(gadgets.json.parse(b))},0)};window.GRPC____NIXVBS_create_channel=function(a,b,c){gadgets.rpc.getAuthToken(a)===c&&(d[a]=b,e(a,!0))};var l="Class GRPC____NIXVBS_wrapper\n Private m_Intended\nPrivate m_Auth\nPublic Sub SetIntendedName(name)\n If isEmpty(m_Intended) Then\nm_Intended \x3d name\nEnd If\nEnd Sub\nPublic Sub SetAuth(auth)\n If isEmpty(m_Auth) Then\nm_Auth \x3d auth\nEnd If\nEnd Sub\nPublic Sub SendMessage(data)\n GRPC____NIXVBS_handle_message(data)\nEnd Sub\nPublic Function GetAuthToken()\n GetAuthToken \x3d m_Auth\nEnd Function\nPublic Sub CreateChannel(channel, auth)\n Call GRPC____NIXVBS_create_channel(m_Intended, channel, auth)\nEnd Sub\nEnd Class\nFunction "+
c+"(name, auth)\nDim wrap\nSet wrap \x3d New GRPC____NIXVBS_wrapper\nwrap.SetIntendedName name\nwrap.SetAuth auth\nSet "+c+" \x3d wrap\nEnd Function";try{window.execScript(l,"vbscript")}catch(m){return!1}}return!0},setup:function(a,b){if(".."===a)return f(),!0;try{var d=document.getElementById(a),e=window[c](a,b);d.contentWindow.opener=e}catch(g){return!1}return!0},call:function(a,b,c){try{d[a]&&d[a].SendMessage(gadgets.json.stringify(c))}catch(e){return!1}return!0}}}());gadgets.rpctx=gadgets.rpctx||{};
gadgets.rpctx.rmr||(gadgets.rpctx.rmr=function(){function m(a,b,c,e){var d=function(){document.body.appendChild(a);a.src="about:blank";e&&(a.onload=function(){f(e)});a.src=b+"#"+c};document.body?d():gadgets.util.registerOnLoadHandler(function(){d()})}function n(a){var b=null;g[a].searchCounter++;try{var c=gadgets.rpc._getTargetWin(a),b=".."===a?c.frames["rmrtransport-"+gadgets.rpc.RPC_ID]:c.frames["rmrtransport-.."]}catch(e){}c=!1;b&&(c=t(a,b));!c&&!(g[a].searchCounter>u)&&window.setTimeout(function(){n(a)},
v)}function p(a,b,c,e){var d=null;if(d=".."!==c?g[".."]:g[a]){b!==gadgets.rpc.ACK&&d.queue.push(e);if(d.waiting||0===d.queue.length&&!(b===gadgets.rpc.ACK&&e&&!0===e.ackAlone))return!0;0<d.queue.length&&(d.waiting=!0);a=d.relayUri+"#"+l(a);try{d.frame.contentWindow.location=a;var h=10==d.width?20:10;d.frame.style.width=h+"px";d.width=h}catch(q){return!1}}return!0}function l(a){a=g[a];var b={id:a.sendId};if(a){b.d=Array.prototype.slice.call(a.queue,0);var c={s:gadgets.rpc.ACK,id:a.recvId};a.originVerified||
(c.sendToken=a.verifySendToken);a.verifyRecvToken&&(c.recvToken=a.verifyRecvToken);b.d.push(c)}return gadgets.json.stringify(b)}function f(a){for(var b=g[a],c=b.receiveWindow.location.hash.substring(1),e=gadgets.json.parse(decodeURIComponent(c))||{},c=e.d||[],d=!1,h=!1,q=0,e=b.recvId-e.id,f=0;f<c.length;++f){var k=c[f];if(k.s===gadgets.rpc.ACK){r(a,!0);b.verifyRecvToken=k.sendToken;!b.originVerified&&(k.recvToken&&String(k.recvToken)==String(b.verifySendToken))&&(b.originVerified=!0);b.waiting&&(h=
!0);b.waiting=!1;var l=Math.max(0,k.id-b.sendId);b.queue.splice(0,l);b.sendId=Math.max(b.sendId,k.id||0)}else d=!0,++q<=e||(++b.recvId,s(k,b.originVerified?b.relayOrigin:void 0))}if(d||h&&0<b.queue.length)p(a,gadgets.rpc.ACK,".."===a?gadgets.rpc.RPC_ID:"..",{ackAlone:d})}function t(a,b){function c(){f(a)}var e=g[a];try{var d=!1,d="document"in b;if(!d)return!1;d="object"==typeof b.document;if(!d||"about:blank"===b.location.href)return!1}catch(h){return!1}e.receiveWindow=b;"undefined"===typeof b.attachEvent?
b.onresize=c:b.attachEvent("onresize",c);".."===a?m(e.frame,e.relayUri,l(a),a):f(a);return!0}var v=500,u=10,g={},w=gadgets.util.getUrlParameters().parent,s,r;return{getCode:function(){return"rmr"},isParentVerifiable:function(){return!0},init:function(a,b){s=a;r=b;return!0},setup:function(a,b){try{if("object"!==typeof g[a]){var c=document.createElement("iframe"),e=c.style;e.position="absolute";e.top="0px";e.border="0";e.opacity="0";e.width="10px";e.height="1px";c.id="rmrtransport-"+a;c.name=c.id;var d=
gadgets.rpc.getRelayUrl(a),h=gadgets.rpc.getOrigin(w);d||(d=h+"/robots.txt");g[a]={frame:c,receiveWindow:null,relayUri:d,relayOrigin:h,searchCounter:0,width:10,waiting:!0,queue:[],sendId:0,recvId:0,verifySendToken:String(Math.random()),verifyRecvToken:null,originVerified:!1};".."!==a&&m(c,d,l(a));n(a)}}catch(f){return gadgets.warn("Caught exception setting up RMR: "+f),!1}return!0},call:function(a,b,c){return p(a,c.s,b,c)}}}());gadgets.rpctx=gadgets.rpctx||{};
gadgets.rpctx.ifpc||(gadgets.rpctx.ifpc=function(){function m(d){for(var a=[],c=0,b=d.length;c<b;++c)a.push(encodeURIComponent(gadgets.json.stringify(d[c])));return a.join("\x26")}function n(d){for(var a,c=f.length-1;0<=c;--c){var b=f[c];try{if(b&&(b.recyclable||"complete"===b.readyState))if(b.parentNode.removeChild(b),window.ActiveXObject)f[c]=b=null,f.splice(c,1);else{b.recyclable=!1;a=b;break}}catch(g){}}a||(a=document.createElement("iframe"),a.style.border=a.style.width=a.style.height="0px",a.style.visibility=
"hidden",a.style.position="absolute",a.onload=function(){this.recyclable=!0},f.push(a));a.src=d;window.setTimeout(function(){document.body.appendChild(a)},0)}var f=[],k=0,l,e={};return{getCode:function(){return"ifpc"},isParentVerifiable:function(){return!0},init:function(d,a){l=a;l("..",!0);return!0},setup:function(d,a){l(d,!0);return!0},call:function(d,a,c){var b=gadgets.rpc.getRelayUrl(d);++k;if(!b)return gadgets.warn("No relay file assigned for IFPC"),!1;var g=null,h=[];if(c.l)g=[b,"#",m([a,k,
1,0,m([a,c.s,"","",a].concat(c.a))])].join(""),h.push(g);else{g=[b,"#",d,"\x26",a,"@",k,"\x26"].join("");d=encodeURIComponent(gadgets.json.stringify(c));a=2E3-g.length;c=Math.ceil(d.length/a);for(var b=0,e;0<d.length;)e=d.substring(0,a),d=d.substring(a),h.push([g,c,"\x26",b,"\x26",e].join("")),b+=1}do n(h.shift());while(0<h.length);return!0},_receiveMessage:function(d,a){var c=d[1],b=parseInt(d[2],10),g=parseInt(d[3],10),h=d[d.length-1],f=1===b;if(1<b){e[c]||(e[c]=[]);e[c][g]=h;a:{for(b-=1;0<=b;--b)if("undefined"===
typeof e[c][b]){b=!1;break a}b=!0}b&&(h=e[c].join(""),delete e[c],f=!0)}f&&a(gadgets.json.parse(decodeURIComponent(h)))}}}());window.gadgets.rpc||(gadgets.rpc=function(){function A(a,b){if(!r[a]){var c=k;b||(c=u);r[a]=c;for(var d=s[a]||[],e=0;e<d.length;++e){var h=d[e];h.t=l[a];c.call(a,h.f,h)}s[a]=[]}}function V(){function a(){O=!0}P||("undefined"!=typeof window.addEventListener?window.addEventListener("unload",a,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onunload",a),P=!0)}function W(a,b,c,d,e){if(!l[b]||l[b]!==c)gadgets.error("Invalid auth token. "+l[b]+" vs "+c),v(b,B);e.onunload=function(){m[b]&&
!O&&(v(b,Q),gadgets.rpc.removeReceiver(b))};V();d=gadgets.json.parse(decodeURIComponent(d))}function w(a,b){if(a&&"string"===typeof a.s&&"string"===typeof a.f&&a.a instanceof Array){var c=".."===a.f?a.ta:a.f,d=!0;if(".."===a.f)d=!1;else if(osapi&&osapi.globals_inline)for(var e=1,h=a.a.length;e<h;e++)a.a[e]&&"undefined"!==typeof a.a[e].mid&&osapi.globals_inline[a.a[e].mid]&&".."===a.f&&a.ta===osapi.globals_inline[a.a[e].mid].iframeId&&(d=!1);if(!d||"function"!==typeof arbitrate||arbitrate(a.s,c))if(l[a.f]&&
l[a.f]!==a.t&&(gadgets.error("Invalid auth token. "+l[a.f]+" vs "+a.t),v(a.f,B)),"__ack"===a.s)window.setTimeout(function(){A(a.f,!0)},0);else{a.c&&(a.callback=function(b){gadgets.rpc.call(a.f,"__cb",null,a.c,b)});if(b){c=q(b);a.origin=b;d=a.r;if(!d||q(d)!=c)d=b;a[X]=d}c=(n[a.s]||n[""]).apply(a,a.a);a.c&&"undefined"!==typeof c&&gadgets.rpc.call(a.f,"__cb",null,a.c,c)}}}function q(a){if(a){if("*"===a)return a}else return"";a=a.toLowerCase();0==a.indexOf("//")&&(a=window.location.protocol+a);-1==a.indexOf("://")&&
(a=window.location.protocol+"//"+a);var b=a.substring(a.indexOf("://")+3),c=b.indexOf("/");-1!=c&&(b=b.substring(0,c));a=a.substring(0,a.indexOf("://"));var c="",d=b.indexOf(":");if(-1!=d){var e=b.substring(d+1),b=b.substring(0,d);if("http"===a&&"80"!==e||"https"===a&&"443"!==e)c=":"+e}return a+"://"+b+c}function t(a){if("/"==a.charAt(0)){var b=a.indexOf("|"),c=0<b?a.substring(1,b):a.substring(1);a=0<b?a.substring(b+1):null;return{id:c,origin:a}}return null}function C(a){if("undefined"===typeof a||
".."===a){a=window.parent;if(window.location.hash){var b=window.location.hash.substring(1).split("\x26");if(b){for(var c=b.length,d=0;c--;)if(0===b[c].indexOf("embeddedlevel")){d=b[c].split("\x3d")[1];break}if(0<d)for(;d--&&a;)a=a.parent}}return a?a:window.parent}if(b=t(a)){for(a=window;!a.frames[b.id]&&a!==window.top;)a=a.parent;return a.frames[b.id]}a=String(a);return(b=D(a))&&b.contentWindow?b.contentWindow:(b=window.frames[a])&&!b.closed?b:null}function D(a){var b=document.getElementById(a);if(!b)for(var c=
frames.length;c--;)try{if(b=frames[c].document.getElementById(a))break}catch(d){}return b}function R(a,b){if(!0!==m[a]){"undefined"===typeof m[a]&&(m[a]=0);var c=C(a);(".."===a||null!=c)&&!0===k.setup(a,b)?m[a]=!0:!0!==m[a]&&10>m[a]++?window.setTimeout(function(){R(a,b)},500):(r[a]=u,m[a]=!0)}}function Y(a,b){var c=C(a);try{if(!f[a]||f[a]!==x&&c.Function.prototype!==f[a].constructor.prototype){var d=E(a);if(q(d)!==q(window.location.href))return f[a]=x,!1;try{f[a]=c.gadgets.rpc.receiveSameDomain}catch(e){return f[a]=
x,!1}}}catch(h){return!1}return f[a]&&f[a]!==x?(f[a](b),!0):!1}function E(a){(a=F[a])&&"/"===a.substring(0,1)&&(a="/"===a.substring(1,2)?document.location.protocol+a:document.location.protocol+"//"+document.location.host+a);return a}function G(a,b,c){!/http(s)?:\/\/.+/.test(b)&&"*"!==b&&(0==b.indexOf("//")?b=window.location.protocol+b:"/"==b.charAt(0)?b=window.location.protocol+"//"+window.location.host+b:-1==b.indexOf("://")&&(b=window.location.protocol+"//"+b));F[a]=b;"undefined"!==typeof c&&(y[a]=
!!c)}function H(a,b){b=b||"";l[a]=String(b);R(a,b)}function S(a){a=(a.passReferrer||"").split(":",2);z=a[0]||"none";I=a[1]||"origin"}function T(a){"true"===String(a.useLegacyProtocol)&&(k=gadgets.rpctx.ifpc,k.init(w,A))}function Z(a,b){function c(c){c=c?c.rpc:{};S(c);var e=c.parentRelayUrl||"",e=q(p.parent||b)+e;G("..",e,"true"===String(c.useLegacyProtocol));T(c);H("..",a)}!p.parent&&b?c({}):gadgets.config.register("rpc",null,c)}function J(a,b,c){if(".."===a)Z(c||p.rpctoken||p.ifpctok||"",b);else a:{var d=
null;if("/"!=a.charAt(0)){if(!gadgets.util)break a;d=D(a);if(!d)throw Error("Cannot set up gadgets.rpc receiver with ID: "+a+", element not found.");}d=d&&d.src;b=b||gadgets.rpc.getOrigin(d);G(a,b);b=gadgets.util.getUrlParameters(d);H(a,c||b.rpctoken)}}var X="referer",n={},F={},y={},l={},K=0,L={},m={},f={},p={},r={},s={},z=null,I=null,$=!!gadgets.util.getUrlParameters().parent&&window.top!==window.self,M=window.name,v=function(){},Q=1,B=2,N=window.console,U=N&&N.log?function(a){N.log(a)}:function(){},
u=function(){function a(a){return function(){U(a+": call ignored")}}return{getCode:function(){return"noop"},isParentVerifiable:function(){return!0},init:a("init"),setup:a("setup"),call:a("call")}}();gadgets.util&&(p=gadgets.util.getUrlParameters());var O=!1,P=!1,k="flash"==p.rpctx?gadgets.rpctx.flash:"rmr"==p.rpctx?gadgets.rpctx.rmr:"function"===typeof window.postMessage?gadgets.rpctx.wpm:"object"===typeof window.postMessage?gadgets.rpctx.wpm:window.ActiveXObject?gadgets.rpctx.flash?gadgets.rpctx.flash:
gadgets.rpctx.nix:0<navigator.userAgent.indexOf("WebKit")?gadgets.rpctx.rmr:"Gecko"===navigator.product?gadgets.rpctx.frameElement:gadgets.rpctx.ifpc;n[""]=function(){U("Unknown RPC service: "+this.s)};n.__cb=function(a,b){var c=L[a];c&&(delete L[a],c.call(this,b))};var x={};return{config:function(a){"function"===typeof a.securityCallback&&(v=a.securityCallback);"function"===typeof a.arbitrator&&(arbitrate=a.arbitrator)},register:function(a,b){if("__cb"===a||"__ack"===a)throw Error("Cannot overwrite callback/ack service");
if(""===a)throw Error("Cannot overwrite default service: use registerDefault");var c=n[a];n[a]=b;return c},unregister:function(a){if("__cb"===a||"__ack"===a)throw Error("Cannot delete callback/ack service");if(""===a)throw Error("Cannot delete default service: use unregisterDefault");delete n[a]},registerDefault:function(a){n[""]=a},unregisterDefault:function(){delete n[""]},forceParentVerifiable:function(){k.isParentVerifiable()||(k=gadgets.rpctx.ifpc)},call:function(a,b,c,d){a=a||"..";var e="..";
".."===a?e=M:"/"==a.charAt(0)&&(e=gadgets.rpc.getOrigin(window.location.href),e="/"+M+(e?"|"+e:""));++K;c&&(L[K]=c);var h={s:b,f:e,c:c?K:0,a:Array.prototype.slice.call(arguments,3),t:l[a],l:!!y[a],ta:a},g;a:if("bidir"===z||"c2p"===z&&".."===a||"p2c"===z&&".."!==a){g=window.location.href;var f="?";if("query"===I)f="#";else if("hash"===I)break a;f=g.lastIndexOf(f);f=-1===f?g.length:f;g=g.substring(0,f)}else g=null;g&&(h.r=g);!(".."!==a&&null==t(a)&&!D(a))&&!Y(a,h)&&(g=r[a],!g&&null!==t(a)&&(g=k),g?
(y[a]&&(g=gadgets.rpctx.ifpc),!1===g.call(a,e,h)&&(r[a]=u,k.call(a,e,h))):s[a]?s[a].push(h):s[a]=[h])},getRelayUrl:E,setRelayUrl:G,setAuthToken:H,setupReceiver:J,getAuthToken:function(a){return l[a]},removeReceiver:function(a){delete F[a];delete y[a];delete l[a];delete m[a];delete f[a];delete r[a]},getRelayChannel:function(){return k.getCode()},receive:function(a,b){4<a.length?k._receiveMessage(a,w):W.apply(null,a.concat(b))},receiveSameDomain:function(a){a.a=Array.prototype.slice.call(a.a);window.setTimeout(function(){w(a)},
0)},getOrigin:q,getTargetOrigin:function(a){var b=null,b=E(a);b||(b=(b=t(a))?b.origin:".."==a?p.parent:document.getElementById(a).src);return q(b)},init:function(){!1===k.init(w,A)&&(k=u);$?J(".."):(J(".."),gadgets.config.register("rpc",null,function(a){a=a.rpc||{};S(a);T(a)}))},_getTargetWin:C,_parseSiblingId:t,ACK:"__ack",RPC_ID:M||"..",SEC_ERROR_LOAD_TIMEOUT:0,SEC_ERROR_FRAME_PHISH:Q,SEC_ERROR_FORGED_MSG:B}}(),gadgets.rpc.init());var opensocial=opensocial||{};opensocial.requestSendMessage=function(a,b,c,d){return opensocial.Container.get().requestSendMessage(a,b,c,d)};opensocial.requestShareApp=function(a,b,c,d){opensocial.Container.get().requestShareApp(a,b,c,d)};
opensocial.requestCreateActivity=function(a,b,c){!a||!a.getField(opensocial.Activity.Field.TITLE)&&!a.getField(opensocial.Activity.Field.TITLE_ID)?c&&window.setTimeout(function(){c(new opensocial.ResponseItem(null,null,opensocial.ResponseItem.Error.BAD_REQUEST,"You must pass in an activity with a title or title id."))},0):opensocial.Container.get().requestCreateActivity(a,b,c)};opensocial.CreateActivityPriority={HIGH:"HIGH",LOW:"LOW"};opensocial.hasPermission=function(a){return opensocial.Container.get().hasPermission(a)};
opensocial.requestPermission=function(a,b,c){opensocial.Container.get().requestPermission(a,b,c)};opensocial.Permission={VIEWER:"viewer"};opensocial.getEnvironment=function(){return opensocial.Container.get().getEnvironment()};opensocial.newDataRequest=function(){return opensocial.Container.get().newDataRequest()};opensocial.newActivity=function(a){return opensocial.Container.get().newActivity(a)};opensocial.newAlbum=function(a){return opensocial.Container.get().newAlbum(a)};
opensocial.newMediaItem=function(a,b,c){return opensocial.Container.get().newMediaItem(a,b,c)};opensocial.newMessage=function(a,b){return opensocial.Container.get().newMessage(a,b)};opensocial.EscapeType={HTML_ESCAPE:"htmlEscape",NONE:"none"};opensocial.newIdSpec=function(a){return opensocial.Container.get().newIdSpec(a)};opensocial.newNavigationParameters=function(a){return opensocial.Container.get().newNavigationParameters(a)};opensocial.invalidateCache=function(){opensocial.Container.get().invalidateCache()};
Function.prototype.inherits=function(a){function b(){}this.superClass_=b.prototype=a.prototype;this.prototype=new b;this.prototype.constructor=this};opensocial.Activity=function(a){this.fields_=a};opensocial.Activity.Field={TITLE_ID:"titleId",TITLE:"title",TEMPLATE_PARAMS:"templateParams",URL:"url",MEDIA_ITEMS:"mediaItems",BODY_ID:"bodyId",BODY:"body",EXTERNAL_ID:"externalId",STREAM_TITLE:"streamTitle",STREAM_URL:"streamUrl",STREAM_SOURCE_URL:"streamSourceUrl",STREAM_FAVICON_URL:"streamFaviconUrl",PRIORITY:"priority",ID:"id",USER_ID:"userId",APP_ID:"appId",POSTED_TIME:"postedTime",EMBEDS:"embeds"};opensocial.Activity.prototype.getId=function(){return this.getField(opensocial.Activity.Field.ID)};
opensocial.Activity.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.Activity.prototype.setField=function(a,b){return this.fields_[a]=b};opensocial.Address=function(a){this.fields_=a||{}};opensocial.Address.Field={TYPE:"type",UNSTRUCTURED_ADDRESS:"unstructuredAddress",PO_BOX:"poBox",STREET_ADDRESS:"streetAddress",EXTENDED_ADDRESS:"extendedAddress",REGION:"region",LOCALITY:"locality",POSTAL_CODE:"postalCode",COUNTRY:"country",LATITUDE:"latitude",LONGITUDE:"longitude"};opensocial.Address.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.Album=function(a){this.fields_=a||{}};opensocial.Album.Field={DESCRIPTION:"description",ID:"id",LOCATION:"location",MEDIA_ITEM_COUNT:"mediaItemCount",MEDIA_MIME_TYPE:"mediaMimeType",MEDIA_TYPE:"mediaType",OWNER_ID:"ownerId",THUMBNAIL_URL:"thumbnailUrl",TITLE:"title"};opensocial.Album.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.Album.prototype.setField=function(a,b){return this.fields_[a]=b};opensocial.BodyType=function(a){this.fields_=a||{}};opensocial.BodyType.Field={BUILD:"build",HEIGHT:"height",WEIGHT:"weight",EYE_COLOR:"eyeColor",HAIR_COLOR:"hairColor"};opensocial.BodyType.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.Collection=function(b,a,c){this.array_=b||[];this.offset_=a||0;this.totalSize_=c||this.array_.length};opensocial.Collection.prototype.getById=function(b){for(var a=0;a<this.size();a++){var c=this.array_[a];if(c.getId()===b)return c}return null};opensocial.Collection.prototype.size=function(){return this.array_.length};opensocial.Collection.prototype.each=function(b){for(var a=0;a<this.size();a++)b(this.array_[a])};opensocial.Collection.prototype.asArray=function(){return this.array_};
opensocial.Collection.prototype.getTotalSize=function(){return this.totalSize_};opensocial.Collection.prototype.getOffset=function(){return this.offset_};opensocial.Container=function(){};opensocial.Container.container_=null;opensocial.Container.setContainer=function(a){opensocial.Container.container_=a};opensocial.Container.get=function(){return opensocial.Container.container_};opensocial.Container.prototype.getEnvironment=function(){};opensocial.Container.prototype.requestSendMessage=function(a,b,c,d){gadgets.rpc.call(null,"requestSendMessage",c,a,b.toJsonObject(),c,d)};
opensocial.Container.prototype.requestShareApp=function(a,b,c,d){c&&window.setTimeout(function(){c(new opensocial.ResponseItem(null,null,opensocial.ResponseItem.Error.NOT_IMPLEMENTED,null))},0)};opensocial.Container.prototype.requestCreateActivity=function(a,b,c){c&&window.setTimeout(function(){c(new opensocial.ResponseItem(null,null,opensocial.ResponseItem.Error.NOT_IMPLEMENTED,null))},0)};opensocial.Container.prototype.hasPermission=function(a){return!1};
opensocial.Container.prototype.requestPermission=function(a,b,c){c&&window.setTimeout(function(){c(new opensocial.ResponseItem(null,null,opensocial.ResponseItem.Error.NOT_IMPLEMENTED,null))},0)};opensocial.Container.prototype.requestData=function(a,b){};opensocial.Container.prototype.newCreateAlbumRequest=function(a,b){};opensocial.Container.prototype.newCreateMediaItemRequest=function(a,b,c){};opensocial.Container.prototype.newDeleteAlbumRequest=function(a,b){};
opensocial.Container.prototype.newFetchPersonRequest=function(a,b){};opensocial.Container.prototype.newFetchPeopleRequest=function(a,b){};opensocial.Container.prototype.newFetchPersonAppDataRequest=function(a,b,c){};opensocial.Container.prototype.newUpdatePersonAppDataRequest=function(a,b){};opensocial.Container.prototype.newRemovePersonAppDataRequest=function(a){};opensocial.Container.prototype.newUpdateAlbumRequest=function(a,b,c){};
opensocial.Container.prototype.newUpdateMediaItemRequest=function(a,b,c,d){};opensocial.Container.prototype.newFetchActivitiesRequest=function(a,b){};opensocial.Container.prototype.newFetchAlbumsRequest=function(a,b){};opensocial.Container.prototype.newFetchMediaItemsRequest=function(a,b){};opensocial.Container.prototype.newFetchMessageCollectionsRequest=function(a,b){};opensocial.Container.prototype.newFetchMessagesRequest=function(a,b,c){};
opensocial.Container.prototype.newCollection=function(a,b,c){return new opensocial.Collection(a,b,c)};opensocial.Container.prototype.newPerson=function(a,b,c){return new opensocial.Person(a,b,c)};opensocial.Container.prototype.newActivity=function(a){return new opensocial.Activity(a)};opensocial.Container.prototype.newAlbum=function(a){return new opensocial.Album(a)};opensocial.Container.prototype.newMediaItem=function(a,b,c){return new opensocial.MediaItem(a,b,c)};
opensocial.Container.prototype.newMessage=function(a,b){return new opensocial.Message(a,b)};opensocial.Container.prototype.newIdSpec=function(a){return new opensocial.IdSpec(a)};opensocial.Container.prototype.newNavigationParameters=function(a){return new opensocial.NavigationParameters(a)};opensocial.Container.prototype.newResponseItem=function(a,b,c,d){return new opensocial.ResponseItem(a,b,c,d)};opensocial.Container.prototype.newDataResponse=function(a,b){return new opensocial.DataResponse(a,b)};
opensocial.Container.prototype.newDataRequest=function(){return new opensocial.DataRequest};opensocial.Container.prototype.newEnvironment=function(a,b){return new opensocial.Environment(a,b)};opensocial.Container.prototype.invalidateCache=function(){};opensocial.Container.isArray=function(a){return a instanceof Array};opensocial.Container.getField=function(a,b,c){return opensocial.Container.escape(a[b],c,!1)};
opensocial.Container.escape=function(a,b,c){return b&&b[opensocial.DataRequest.DataRequestFields.ESCAPE_TYPE]==opensocial.EscapeType.NONE?a:gadgets.util.escape(a,c)};opensocial.DataRequest=function(){this.requestObjects_=[]};opensocial.DataRequest.prototype.requestObjects_=null;opensocial.DataRequest.prototype.getRequestObjects=function(){return this.requestObjects_};opensocial.DataRequest.prototype.add=function(b,a){return this.requestObjects_.push({key:a,request:b})};opensocial.DataRequest.prototype.send=function(b){opensocial.Container.get().requestData(this,b||function(){})};opensocial.DataRequest.SortOrder={TOP_FRIENDS:"topFriends",NAME:"name"};
opensocial.DataRequest.FilterType={ALL:"all",HAS_APP:"hasApp",TOP_FRIENDS:"topFriends",IS_FRIENDS_WITH:"isFriendsWith"};opensocial.DataRequest.PeopleRequestFields={PROFILE_DETAILS:"profileDetail",SORT_ORDER:"sortOrder",FILTER:"filter",FILTER_OPTIONS:"filterOptions",FIRST:"first",MAX:"max",APP_DATA:"appData",ESCAPE_TYPE:"escapeType"};opensocial.DataRequest.prototype.addDefaultParam=function(b,a,c){b[a]=b[a]||c};
opensocial.DataRequest.prototype.addDefaultProfileFields=function(b){var a=opensocial.DataRequest.PeopleRequestFields;b[a.PROFILE_DETAILS]=(b[a.PROFILE_DETAILS]||[]).concat([opensocial.Person.Field.ID,opensocial.Person.Field.NAME,opensocial.Person.Field.THUMBNAIL_URL])};opensocial.DataRequest.prototype.asArray=function(b){return opensocial.Container.isArray(b)?b:[b]};opensocial.DataRequest.prototype.newCreateAlbumRequest=function(b,a){return opensocial.Container.get().newCreateAlbumRequest(b,a)};
opensocial.DataRequest.prototype.newCreateMediaItemRequest=function(b,a,c){return opensocial.Container.get().newCreateMediaItemRequest(b,a,c)};opensocial.DataRequest.prototype.newDeleteAlbumRequest=function(b,a){return opensocial.Container.get().newDeleteAlbumRequest(b,a)};opensocial.DataRequest.prototype.newFetchPersonRequest=function(b,a){a=a||{};this.addDefaultProfileFields(a);return opensocial.Container.get().newFetchPersonRequest(b,a)};
opensocial.DataRequest.prototype.newFetchPeopleRequest=function(b,a){a=a||{};var c=opensocial.DataRequest.PeopleRequestFields;this.addDefaultProfileFields(a);this.addDefaultParam(a,c.SORT_ORDER,opensocial.DataRequest.SortOrder.TOP_FRIENDS);this.addDefaultParam(a,c.FILTER,opensocial.DataRequest.FilterType.ALL);this.addDefaultParam(a,c.FIRST,0);this.addDefaultParam(a,c.MAX,20);return opensocial.Container.get().newFetchPeopleRequest(b,a)};opensocial.DataRequest.AlbumRequestFields={FIRST:"first",MAX:"max"};
opensocial.DataRequest.MediaItemRequestFields={FIRST:"first",MAX:"max"};opensocial.DataRequest.DataRequestFields={ESCAPE_TYPE:"escapeType"};opensocial.DataRequest.prototype.newFetchPersonAppDataRequest=function(b,a,c){return opensocial.Container.get().newFetchPersonAppDataRequest(b,this.asArray(a),c)};opensocial.DataRequest.prototype.newUpdateAlbumRequest=function(b,a,c){return opensocial.Container.get().newUpdateAlbumRequest(b,a,c)};
opensocial.DataRequest.prototype.newUpdateMediaItemRequest=function(b,a,c,d){return opensocial.Container.get().newUpdateMediaItemRequest(b,a,c,d)};opensocial.DataRequest.prototype.newUpdatePersonAppDataRequest=function(b,a){return opensocial.Container.get().newUpdatePersonAppDataRequest(b,a)};opensocial.DataRequest.prototype.newRemovePersonAppDataRequest=function(b){return opensocial.Container.get().newRemovePersonAppDataRequest(b)};
opensocial.DataRequest.ActivityRequestFields={APP_ID:"appId",FIRST:"first",MAX:"max"};opensocial.DataRequest.prototype.newFetchActivitiesRequest=function(b,a){a=a||{};var c=opensocial.DataRequest.ActivityRequestFields;this.addDefaultParam(a,c.FIRST,0);this.addDefaultParam(a,c.MAX,20);return opensocial.Container.get().newFetchActivitiesRequest(b,a)};
opensocial.DataRequest.prototype.newFetchAlbumsRequest=function(b,a){a=a||{};var c=opensocial.DataRequest.AlbumRequestFields;this.addDefaultParam(a,c.FIRST,0);this.addDefaultParam(a,c.MAX,20);return opensocial.Container.get().newFetchAlbumsRequest(b,a)};
opensocial.DataRequest.prototype.newFetchMediaItemsRequest=function(b,a,c){c=c||{};var d=opensocial.DataRequest.MediaItemRequestFields;this.addDefaultParam(c,d.FIRST,0);this.addDefaultParam(c,d.MAX,20);return opensocial.Container.get().newFetchMediaItemsRequest(b,a,c)};opensocial.DataRequest.prototype.newFetchMessageCollectionsRequest=function(b,a){a=a||{};return opensocial.Container.get().newFetchMessageCollectionsRequest(b,a)};
opensocial.DataRequest.prototype.newFetchMessagesRequest=function(b,a,c){c=c||{};return opensocial.Container.get().newFetchMessagesRequest(b,a,c)};opensocial.DataResponse=function(a,b,c){this.responseItems_=a;this.globalError_=b;this.errorMessage_=c};opensocial.DataResponse.prototype.hadError=function(){return!!this.globalError_};opensocial.DataResponse.prototype.getErrorMessage=function(){return this.errorMessage_};opensocial.DataResponse.prototype.get=function(a){return this.responseItems_[a]};opensocial.Email=function(a){this.fields_=a||{}};opensocial.Email.Field={TYPE:"type",ADDRESS:"address"};opensocial.Email.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.Enum=function(a,b){this.key=a;this.displayValue=b};opensocial.Enum.prototype.getKey=function(){return gadgets.util.escape(this.key)};opensocial.Enum.prototype.getDisplayValue=function(){return gadgets.util.escape(this.displayValue)};opensocial.Enum.Smoker={NO:"NO",YES:"YES",SOCIALLY:"SOCIALLY",OCCASIONALLY:"OCCASIONALLY",REGULARLY:"REGULARLY",HEAVILY:"HEAVILY",QUITTING:"QUITTING",QUIT:"QUIT"};
opensocial.Enum.Drinker={NO:"NO",YES:"YES",SOCIALLY:"SOCIALLY",OCCASIONALLY:"OCCASIONALLY",REGULARLY:"REGULARLY",HEAVILY:"HEAVILY",QUITTING:"QUITTING",QUIT:"QUIT"};opensocial.Enum.Gender={MALE:"MALE",FEMALE:"FEMALE"};opensocial.Enum.LookingFor={DATING:"DATING",FRIENDS:"FRIENDS",RELATIONSHIP:"RELATIONSHIP",NETWORKING:"NETWORKING",ACTIVITY_PARTNERS:"ACTIVITY_PARTNERS",RANDOM:"RANDOM"};opensocial.Enum.Presence={AWAY:"AWAY",CHAT:"CHAT",DND:"DND",OFFLINE:"OFFLINE",ONLINE:"ONLINE",XA:"XA"};opensocial.Environment=function(a,b){this.domain=a;this.supportedFields=b};opensocial.Environment.prototype.getDomain=function(){return this.domain};opensocial.Environment.ObjectType={PERSON:"person",ADDRESS:"address",BODY_TYPE:"bodyType",EMAIL:"email",NAME:"name",ORGANIZATION:"organization",PHONE:"phone",URL:"url",ACTIVITY:"activity",MEDIA_ITEM:"mediaItem",MESSAGE:"message",MESSAGE_TYPE:"messageType",SORT_ORDER:"sortOrder",FILTER_TYPE:"filterType"};
opensocial.Environment.prototype.supportsField=function(a,b){return!!(this.supportedFields[a]||[])[b]};opensocial.IdSpec=function(a){this.fields_=a||{}};opensocial.IdSpec.Field={USER_ID:"userId",GROUP_ID:"groupId",NETWORK_DISTANCE:"networkDistance"};opensocial.IdSpec.PersonId={OWNER:"OWNER",VIEWER:"VIEWER"};opensocial.IdSpec.GroupId={SELF:"SELF",FRIENDS:"FRIENDS",ALL:"ALL"};opensocial.IdSpec.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.IdSpec.prototype.setField=function(a,b){return this.fields_[a]=b};opensocial.MediaItem=function(a,b,c){this.fields_={};if(c)for(var d in c)c.hasOwnProperty(d)&&(this.fields_[d]=c[d]);this.fields_[opensocial.MediaItem.Field.MIME_TYPE]=a;this.fields_[opensocial.MediaItem.Field.URL]=b};opensocial.MediaItem.Type={IMAGE:"image",VIDEO:"video",AUDIO:"audio"};
opensocial.MediaItem.Field={ALBUM_ID:"albumId",CREATED:"created",DESCRIPTION:"description",DURATION:"duration",FILE_SIZE:"fileSize",ID:"id",LANGUAGE:"language",LAST_UPDATED:"lastUpdated",LOCATION:"location",MIME_TYPE:"mimeType",NUM_COMMENTS:"numComments",NUM_VIEWS:"numViews",NUM_VOTES:"numVotes",RATING:"rating",START_TIME:"startTime",TAGGED_PEOPLE:"taggedPeople",TAGS:"tags",THUMBNAIL_URL:"thumbnailUrl",TITLE:"title",TYPE:"type",URL:"url"};
opensocial.MediaItem.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.MediaItem.prototype.setField=function(a,b){return this.fields_[a]=b};opensocial.MessageCollection=function(a){this.fields_=a||{}};opensocial.MessageCollection.Field={ID:"id",TITLE:"title",TOTAL:"total",UNREAD:"unread",UPDATED:"updated",URLS:"urls"};opensocial.MessageCollection.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.MessageCollection.prototype.setField=function(a,b){return this.fields_[a]=b};opensocial.Message=function(a,b){"string"==typeof a?(this.fields_=b||{},this.fields_[opensocial.Message.Field.BODY]=a):this.fields_=a||{}};opensocial.Message.Field={APP_URL:"appUrl",BODY:"body",BODY_ID:"bodyId",COLLECTION_IDS:"collectionIds",ID:"id",PARENT_ID:"parentId",RECIPIENTS:"recipients",SENDER_ID:"senderId",STATUS:"status",TIME_SENT:"timeSent",TITLE:"title",TITLE_ID:"titleId",TYPE:"type",UPDATED:"updated",URLS:"urls"};
opensocial.Message.Type={EMAIL:"email",NOTIFICATION:"notification",PRIVATE_MESSAGE:"privateMessage",PUBLIC_MESSAGE:"publicMessage"};opensocial.Message.Status={NEW:"new",DELETED:"deleted",FLAGGED:"flagged"};opensocial.Message.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.Message.prototype.setField=function(a,b){return this.fields_[a]=b};opensocial.Name=function(a){this.fields_=a||{}};opensocial.Name.Field={FAMILY_NAME:"familyName",GIVEN_NAME:"givenName",ADDITIONAL_NAME:"additionalName",HONORIFIC_PREFIX:"honorificPrefix",HONORIFIC_SUFFIX:"honorificSuffix",UNSTRUCTURED:"unstructured"};opensocial.Name.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.NavigationParameters=function(a){this.fields_=a||{}};opensocial.NavigationParameters.Field={VIEW:"view",OWNER:"owner",PARAMETERS:"parameters"};opensocial.NavigationParameters.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.NavigationParameters.prototype.setField=function(a,b){return this.fields_[a]=b};opensocial.NavigationParameters.DestinationType={VIEWER_DESTINATION:"viewerDestination",RECIPIENT_DESTINATION:"recipientDestination"};opensocial.Organization=function(a){this.fields_=a||{}};opensocial.Organization.Field={NAME:"name",TITLE:"title",DESCRIPTION:"description",FIELD:"field",SUB_FIELD:"subField",START_DATE:"startDate",END_DATE:"endDate",SALARY:"salary",ADDRESS:"address",WEBPAGE:"webpage"};opensocial.Organization.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.Person=function(b,a,c){this.fields_=b||{};this.isOwner_=a;this.isViewer_=c};
opensocial.Person.Field={ID:"id",NAME:"name",NICKNAME:"nickname",THUMBNAIL_URL:"thumbnailUrl",PROFILE_URL:"profileUrl",CURRENT_LOCATION:"currentLocation",ADDRESSES:"addresses",EMAILS:"emails",PHONE_NUMBERS:"phoneNumbers",ABOUT_ME:"aboutMe",STATUS:"status",PROFILE_SONG:"profileSong",PROFILE_VIDEO:"profileVideo",GENDER:"gender",SEXUAL_ORIENTATION:"sexualOrientation",RELATIONSHIP_STATUS:"relationshipStatus",AGE:"age",DATE_OF_BIRTH:"dateOfBirth",BODY_TYPE:"bodyType",ETHNICITY:"ethnicity",SMOKER:"smoker",
DRINKER:"drinker",CHILDREN:"children",PETS:"pets",LIVING_ARRANGEMENT:"livingArrangement",TIME_ZONE:"timeZone",LANGUAGES_SPOKEN:"languagesSpoken",JOBS:"jobs",JOB_INTERESTS:"jobInterests",SCHOOLS:"schools",INTERESTS:"interests",URLS:"urls",MUSIC:"music",MOVIES:"movies",TV_SHOWS:"tvShows",BOOKS:"books",ACTIVITIES:"activities",SPORTS:"sports",HEROES:"heroes",QUOTES:"quotes",CARS:"cars",FOOD:"food",TURN_ONS:"turnOns",TURN_OFFS:"turnOffs",TAGS:"tags",ROMANCE:"romance",SCARED_OF:"scaredOf",HAPPIEST_WHEN:"happiestWhen",
FASHION:"fashion",HUMOR:"humor",LOOKING_FOR:"lookingFor",RELIGION:"religion",POLITICAL_VIEWS:"politicalViews",HAS_APP:"hasApp",NETWORK_PRESENCE:"networkPresence"};opensocial.Person.prototype.getId=function(){return this.getField(opensocial.Person.Field.ID)};var ORDERED_NAME_FIELDS_=[opensocial.Name.Field.HONORIFIC_PREFIX,opensocial.Name.Field.GIVEN_NAME,opensocial.Name.Field.FAMILY_NAME,opensocial.Name.Field.HONORIFIC_SUFFIX,opensocial.Name.Field.ADDITIONAL_NAME];
opensocial.Person.prototype.getDisplayName=function(){var b=this.getField(opensocial.Person.Field.NAME);if(b){var a=b.getField(opensocial.Name.Field.UNSTRUCTURED);if(a)return a;for(var a="",c=0;c<ORDERED_NAME_FIELDS_.length;c++){var d=b.getField(ORDERED_NAME_FIELDS_[c]);d&&(a+=d+" ")}return a.replace(/^\s+|\s+$/g,"")}return this.getField(opensocial.Person.Field.NICKNAME)};opensocial.Person.prototype.getField=function(b,a){return opensocial.Container.getField(this.fields_,b,a)};
opensocial.Person.prototype.getAppData=function(b){};opensocial.Person.prototype.isViewer=function(){return!!this.isViewer_};opensocial.Person.prototype.isOwner=function(){return!!this.isOwner_};opensocial.Phone=function(a){this.fields_=a||{}};opensocial.Phone.Field={TYPE:"type",NUMBER:"number"};opensocial.Phone.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};opensocial.ResponseItem=function(a,b,c,d){this.originalDataRequest_=a;this.data_=b;this.errorCode_=c;this.errorMessage_=d};opensocial.ResponseItem.prototype.hadError=function(){return!!this.errorCode_};opensocial.ResponseItem.Error={NOT_IMPLEMENTED:"notImplemented",UNAUTHORIZED:"unauthorized",FORBIDDEN:"forbidden",BAD_REQUEST:"badRequest",INTERNAL_ERROR:"internalError",LIMIT_EXCEEDED:"limitExceeded"};opensocial.ResponseItem.prototype.getErrorCode=function(){return this.errorCode_};
opensocial.ResponseItem.prototype.getErrorMessage=function(){return this.errorMessage_};opensocial.ResponseItem.prototype.getOriginalDataRequest=function(){return this.originalDataRequest_};opensocial.ResponseItem.prototype.getData=function(){return this.data_};opensocial.Url=function(a){this.fields_=a||{}};opensocial.Url.Field={TYPE:"type",LINK_TEXT:"linkText",ADDRESS:"address"};opensocial.Url.prototype.getField=function(a,b){return opensocial.Container.getField(this.fields_,a,b)};gadgets.rpc.register("update_security_token",function(a){".."===this.f&&shindig.auth.updateSecurityToken(a)});(function(){var e=null,c={},g=gadgets.util.escapeString,k={},h={},l="en",m="US",n=0;gadgets.Prefs=function(){if(!e){var a=gadgets.util.getUrlParameters(),b;for(b in a)a.hasOwnProperty(b)&&(0===b.indexOf("up_")&&3<b.length?c[b.substr(3)]=String(a[b]):"country"===b?m=a[b]:"lang"===b?l=a[b]:"mid"===b&&(n=a[b]));for(var d in h)"undefined"===typeof c[d]&&(c[d]=h[d]);e=this}return e};gadgets.Prefs.setInternal_=function(a,b){var d=!1;if("string"===typeof a){if(!c.hasOwnProperty(a)||c[a]!==b)d=!0;c[a]=b}else for(var f in a)if(a.hasOwnProperty(f)){var e=
a[f];if(!c.hasOwnProperty(f)||c[f]!==e)d=!0;c[f]=e}return d};gadgets.Prefs.setMessages_=function(a){k=a};gadgets.Prefs.setDefaultPrefs_=function(a){h=a};gadgets.Prefs.prototype.getString=function(a){".lang"===a&&(a="lang");return c[a]?g(c[a]):""};gadgets.Prefs.prototype.setDontEscape_=function(){g=function(a){return a}};gadgets.Prefs.prototype.getInt=function(a){a=parseInt(c[a],10);return isNaN(a)?0:a};gadgets.Prefs.prototype.getFloat=function(a){a=parseFloat(c[a]);return isNaN(a)?0:a};gadgets.Prefs.prototype.getBool=
function(a){return(a=c[a])?"true"===a||!0===a||!!parseInt(a,10):!1};gadgets.Prefs.prototype.set=function(a,b){throw Error("setprefs feature required to make this call.");};gadgets.Prefs.prototype.getArray=function(a){if(a=c[a]){a=a.split("|");for(var b=0,d=a.length;b<d;++b)a[b]=g(a[b].replace(/%7C/g,"|"));return a}return[]};gadgets.Prefs.prototype.setArray=function(a,b){throw Error("setprefs feature required to make this call.");};gadgets.Prefs.prototype.getMsg=function(a){return k[a]||""};gadgets.Prefs.prototype.getCountry=
function(){return m};gadgets.Prefs.prototype.getLang=function(){return l};gadgets.Prefs.prototype.getModuleId=function(){return n}})();gadgets.io=function(){function C(){var b;if("undefined"!=typeof shindig&&shindig.xhrwrapper&&shindig.xhrwrapper.createXHR)return shindig.xhrwrapper.createXHR();if("undefined"!=typeof ActiveXObject)try{return(b=new ActiveXObject("Msxml2.XMLHTTP"))||(b=new ActiveXObject("Microsoft.XMLHTTP")),b}catch(d){}if("undefined"!=typeof XMLHttpRequest||window.XMLHttpRequest)return new window.XMLHttpRequest;throw"no xhr available";}function A(b,d,c,a,g){if(4!==b.readyState)return!0;var h;try{if(200!==b.status){var l=
b.responseText,f=l;if(l&&c&&a){var k=q.unparseableCruft,e=l.indexOf(k)+k.length;if(e===k.length){var l=l.substr(e),n=eval("("+l+")");n&&(n=n[a])}if(c.AUTHORIZATION===gadgets.io.AuthorizationType.SSO){var p=c.SSO_REAUTH_DETECTOR;401===b.status?(f=b.statusText?b.statusText:"Unauthorized: check login",h=p&&"function"===typeof p):n&&p&&"function"===typeof p?h=p(n.body,n.rc,n.headers):b.getResponseHeader("content-type")&&0===b.getResponseHeader("content-type").indexOf("application/json")&&(p&&"function"===
typeof p)&&(h=p("",b.status,{}))}}var m=""+b.status;f&&(m=m+" "+f);var r={errors:[m],rc:b.status,text:f};"undefined"!==typeof h&&(r.ssoReauthNeeded=h);t(r,c,a,d,g);u(r);d(r);return!0}}catch(s){return r={errors:[s.number+" Error not specified"],rc:s.number,text:s.description},"undefined"!==typeof h&&(r.ssoReauthNeeded=h),t(r,c,a,d,g),u(r),d(r),!0}return!1}function D(b,d,c,a){A(a,d,c,b)||d(w(c,{body:a.responseText}))}function x(b,d,c,a,g){if(!A(a,d,c,b,g)){a=a.responseText;var h=q.unparseableCruft,
l=a.indexOf(h)+h.length;l<h.length||(a=a.substr(l),a=eval("("+a+")"),a=a[b],a.oauthState&&(s=a.oauthState),a.st&&shindig.auth.updateSecurityToken(a.st),a=w(c,a),t(a,c,b,d,g),u(a),d(a))}}function w(b,d){var c={text:d.body,rc:d.rc||200,headers:d.headers,oauthApprovalUrl:d.oauthApprovalUrl,oauthError:d.oauthError,oauthErrorText:d.oauthErrorText,oauthErrorTrace:d.oauthErrorTrace,oauthErrorUri:d.oauthErrorUri,oauthErrorExplanation:d.oauthErrorExplanation,errors:[],samlApprovalUrl:d.samlApprovalUrl};if(200>
c.rc||400<=c.rc)c.errors=[c.rc+" Error"];else if(c.text)switch(300<=c.rc&&400>c.rc&&(b.CONTENT_TYPE="TEXT"),b.CONTENT_TYPE){case "JSON":case "FEED":c.data=gadgets.json.parse(c.text);c.data||(c.errors.push("500 Failed to parse JSON"),c.rc=500,c.data=null);break;case "DOM":var a;E?(a=new ActiveXObject("Microsoft.XMLDOM"),a.async=!1,a.validateOnParse=!1,a.resolveExternals=!1,a.loadXML(c.text)?c.data=a:(c.errors.push("500 Failed to parse XML"),c.rc=500)):"undefined"!=typeof DOMParser?(a=(new DOMParser).parseFromString(c.text,
"text/xml"),"parsererror"===a.documentElement.nodeName?(c.errors.push("500 Failed to parse XML"),c.rc=500):c.data=a):(c.errors.push("500 Failed to parse XML because no DOM parser was available"),c.rc=500);break;default:c.data=c.text}b.AUTHORIZATION===gadgets.io.AuthorizationType.SSO&&b.SSO_REAUTH_DETECTOR&&"function"===typeof b.SSO_REAUTH_DETECTOR&&(c.ssoReauthNeeded=(0,b.SSO_REAUTH_DETECTOR)(d.body,d.rc,d.headers));return c}function y(b,d,c,a,g,h,l,f,k){var e=C();0==d.indexOf("//")&&(d=document.location.protocol+
d);e.open(g,d,!0);c&&(b=gadgets.util.makeClosure(null,l,b,c,h,e,k),gadgets.util.shouldPollXhrReadyStateChange()?F(e,b):e.onreadystatechange=b);"string"===typeof f&&(f={});f=f||{};null!==a&&(f["Content-Type"]||(f["Content-Type"]="application/x-www-form-urlencoded"));for(var n in f)e.setRequestHeader(n,f[n]);e.send(a)}function F(b,d){var c=B;z[c]=window.setInterval(function(){b&&4===b.readyState&&(window.clearInterval(z[c]),delete z[c],d&&d())},q.xhrPollIntervalMs||50);B++}function v(b){return q.securityTokenInCookie?
"":"\x26st\x3d"+encodeURIComponent(b)}function t(b,d,c,a,g){if(b.samlApprovalUrl&&!0==b.ssoReauthNeeded)if(d.SSO_REAUTH_CALLBACK&&"function"===typeof d.SSO_REAUTH_CALLBACK)(0,d.SSO_REAUTH_CALLBACK)(b);else{b=b.samlApprovalUrl;if(null==b||void 0==b||"META_DATA_REAUTH_URL_NOT_SET"==b)b=gadgets.rpc.call("..","_cre_sso_reauth_cb");null==b||void 0==b||"META_DATA_REAUTH_URL_NOT_SET"==b?console.error("Failed to get valid reauth URL to do login for saml reauth."):confirm("Do you want to do reauth for SAML now?")&&
(d=new cre$.sso.ReauthHandler(function(){},function(){gadgets.io.makeRequest(c,a,g)}),d.setReauthURL(b),d.createHandlerOnClick()(),d.renderComplete())}}function u(b){if(null!=b&&void 0!=b){var d;d=null;b=b.headers;null!=b&&(void 0!=b&&""!=b)&&(d=b["set-cookie"]);if(null!=d&&void 0!=d){d=String(d).split("\x26");b=0;for(var c=d.length;b<c;b++){var a=d[b];"prx_saml_"==a.substring(0,9)&&(-1!==a.indexOf("; HttpOnly")&&(a=a.replace("; HttpOnly","")),document.cookie=a)}}}}var B=0,z={},q={},s,E=window.ActiveXObject?
!0:!1;gadgets.config.register("core.io",null,function(b){q=b["core.io"]||{}});return{makeRequest:function(b,d,c){var a=c||{},g=a.METHOD||"GET",h=a.REFRESH_INTERVAL,l,f;a.AUTHORIZATION&&"NONE"!==a.AUTHORIZATION&&(l=a.AUTHORIZATION.toLowerCase(),f=shindig.auth.getSecurityToken());var k=!0;"undefined"!==typeof a.SIGN_OWNER&&(k=a.SIGN_OWNER);var e=!0;"undefined"!==typeof a.SIGN_VIEWER&&(e=a.SIGN_VIEWER);var n=a.HEADERS||{};"POST"===g&&!n["Content-Type"]&&(n["Content-Type"]="application/x-www-form-urlencoded");
var p=gadgets.util.getUrlParameters(),k={url:b,httpMethod:g,headers:gadgets.io.encodeValues(n,!1),postData:a.POST_DATA||"",authz:l||"",st:f||"",contentType:a.CONTENT_TYPE||"TEXT",numEntries:a.NUM_ENTRIES||"3",getSummaries:!!a.GET_SUMMARIES,signOwner:k,signViewer:e,gadget:p.url,container:p.container||p.synd||"default",bypassSpecCache:gadgets.util.getUrlParameters().nocache||"",getFullHeaders:!!a.GET_FULL_HEADERS};if("oauth"===l||"signed"===l||"oauth2"===l){gadgets.io.oauthReceivedCallbackUrl_&&(k.OAUTH_RECEIVED_CALLBACK=
gadgets.io.oauthReceivedCallbackUrl_,gadgets.io.oauthReceivedCallbackUrl_=null);k.oauthState=s||"";for(var m in a)if(a.hasOwnProperty(m)&&(0===m.indexOf("OAUTH_")||"code"===m))k[m]=a[m]}l=(f=f||shindig.auth.getSecurityToken())?{"X-Shindig-ST":f}:{};f=q.jsonProxyUrl.replace("%host%",document.location.host);a:{if(gadgets.io.preloaded_&&"GET"===k.httpMethod)for(m=0;m<gadgets.io.preloaded_.length;m++)if((e=gadgets.io.preloaded_[m])&&e.id===k.url){delete gadgets.io.preloaded_[m];200!==e.rc?d({rc:e.rc,
errors:[e.rc+" Error"]}):(e.oauthState&&(s=e.oauthState),m=w(a,{body:e.body,rc:e.rc,headers:e.headers,oauthApprovalUrl:e.oauthApprovalUrl,oauthError:e.oauthError,oauthErrorText:e.oauthErrorText,oauthErrorTrace:e.oauthErrorTrace,oauthErrorUri:e.oauthErrorUri,oauthErrorExplanation:e.oauthErrorExplanation,errors:[],samlApprovalUrl:e.samlApprovalUrl}),t(m,a,url,d,c),u(m),d(m));m=!0;break a}m=!1}m||("GET"==g&&"undefined"!=typeof h&&(k.refresh=h),"GET"===g&&!k.authz?(g="?"+gadgets.io.encodeValues(k),h=
f+g,-1!=f.indexOf("url\x3d")&&(h=f+encodeURIComponent(g)),y(b,h,d,null,"GET",a,x,l,c)):(g=gadgets.io.encodeValues(k),y(b,f,d,g,"POST",a,x,l,c)))},makeNonProxiedRequest:function(b,d,c,a){c=c||{};y(b,b,d,c.POST_DATA,c.METHOD,c,D,a)},clearOAuthState:function(){s=void 0},encodeValues:function(b,d){var c=!d,a=[],g=!1,h;for(h in b)b.hasOwnProperty(h)&&!/___$/.test(h)&&(g?a.push("\x26"):g=!0,a.push(c?encodeURIComponent(h):h),a.push("\x3d"),a.push(c?encodeURIComponent(b[h]):b[h]));return a.join("")},getProxyUrl:function(b,
d){var c=q.proxyUrl;if(!c)return c;var a=window.__gadgetIdentifier;a&&q.securityTokenInCookie&&(c=c.replace(/proxy/,"proxy/"+a));var g=d||{},a=g.REFRESH_INTERVAL;"undefined"==typeof a&&(a="3600");var h=g.STREAM;"undefined"==typeof h&&(h=!1);var l=gadgets.util.getUrlParameters(),f=shindig.auth.getSecurityToken(),k=g[gadgets.io.RequestParameters.AUTHORIZATION],e=g[gadgets.io.RequestParameters.OAUTH_SERVICE_NAME],g=g.rewriteMime?"\x26rewriteMime\x3d"+encodeURIComponent(g.rewriteMime):"",n="";k?n=k==
gadgets.io.AuthorizationType.OAUTH||k==gadgets.io.AuthorizationType.OAUTH2?"\x26authz\x3d"+k.toLowerCase()+v(f)+"\x26OAUTH_SERVICE_NAME\x3d"+encodeURIComponent(e):k==gadgets.io.AuthorizationType.SSO?"\x26authz\x3d"+k.toLowerCase()+v(f):!0==q.appendTokenAlways?"\x26authz\x3d"+k.toLowerCase()+v(f):"\x26authz\x3d"+k.toLowerCase():!0==q.appendTokenAlways&&(n=v(f));f=shindig.uri(b).getPath();k="";e=f.lastIndexOf("/");-1!==e&&(k=f.substring(e));c=c.replace("%url%",encodeURIComponent(b)).replace("%host%",
document.location.host).replace("%rawurl%",b).replace("%filename%",k).replace("%refresh%",encodeURIComponent(a)).replace("%gadget%",encodeURIComponent(l.url)).replace("%container%",encodeURIComponent(l.container||l.synd||"default")).replace("%stream%",h?1:0).replace("%authz%",n).replace("%rewriteMime%",g);0==c.indexOf("//")&&(c=window.location.protocol+c);return c},processResponse_:x}}();gadgets.io.RequestParameters=gadgets.util.makeEnum("ALIAS METHOD CONTENT_TYPE POST_DATA HEADERS AUTHORIZATION NUM_ENTRIES GET_SUMMARIES GET_FULL_HEADERS REFRESH_INTERVAL STREAM SIGN_OWNER SIGN_VIEWER OAUTH_SERVICE_NAME OAUTH_USE_TOKEN OAUTH_TOKEN_NAME OAUTH_REQUEST_TOKEN OAUTH_REQUEST_TOKEN_SECRET OAUTH_RECEIVED_CALLBACK SSO_REAUTH_DETECTOR".split(" "));
gadgets.io.MethodType=gadgets.util.makeEnum(["GET","POST","PUT","DELETE","HEAD"]);gadgets.io.ContentType=gadgets.util.makeEnum(["TEXT","DOM","JSON","FEED"]);gadgets.io.AuthorizationType=gadgets.util.makeEnum(["NONE","SIGNED","OAUTH","OAUTH2","SSO"]);window.FieldTranslations=function(){function e(a){a&&(a.key=a.value)}function f(a){a&&(a.address=a.value)}return{translateEnumJson:e,translateUrlJson:f,translateServerPersonToJsPerson:function(a,b){if(a.emails)for(var c=0;c<a.emails.length;c++)a.emails[c].address=a.emails[c].value;if(a.phoneNumbers)for(c=0;c<a.phoneNumbers.length;c++)a.phoneNumbers[c].number=a.phoneNumbers[c].value;a.birthday&&(a.dateOfBirth=a.birthday);a.utcOffset&&(a.timeZone=a.utcOffset);if(a.addresses)for(c=0;c<a.addresses.length;c++)a.addresses[c].unstructuredAddress=
a.addresses[c].formatted;a.gender&&(a.gender={key:"male"==a.gender?"MALE":"female"==a.gender?"FEMALE":null,displayValue:a.gender});f(a.profileSong);f(a.profileVideo);if(a.urls)for(c=0;c<a.urls.length;c++)f(a.urls[c]);e(a.drinker);e(a.lookingFor);e(a.networkPresence);e(a.smoker);if(a.organizations){a.jobs=[];a.schools=[];for(c=0;c<a.organizations.length;c++){var d=a.organizations[c];"job"==d.type?a.jobs.push(d):"school"==d.type&&a.schools.push(d)}}a.name&&(a.name.unstructured=a.name.formatted);a.appData&&
(a.appData=opensocial.Container.escape(a.appData,b,!0))},translateJsPersonFieldsToServerFields:function(a){for(var b=0;b<a.length;b++)"dateOfBirth"==a[b]?a[b]="birthday":"timeZone"==a[b]?a[b]="utcOffset":"jobs"==a[b]?a[b]="organizations":"schools"==a[b]&&(a[b]="organizations");a.push("id");a.push("displayName")},translateIsoStringToDate:function(a){a=a.match(RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})(T([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?"));var b=
0,c=new Date(a[1],0,1);a[3]&&c.setMonth(a[3]-1);a[5]&&c.setDate(a[5]);a[7]&&c.setHours(a[7]);a[8]&&c.setMinutes(a[8]);a[10]&&c.setSeconds(a[10]);a[12]&&c.setMilliseconds(1E3*Number("0."+a[12]));a[14]&&(b=60*Number(a[16])+Number(a[17]),b*="-"==a[15]?1:-1);b-=c.getTimezoneOffset();return new Date(Number(Number(c)+6E4*b))},addAppDataAsProfileFields:function(a){if(a&&a.appData){var b=a.appData;"string"===typeof b&&(b=[b]);for(var c=a.profileDetail||[],d=0;d<b.length;d++)"*"===b[d]?c.push("appData"):c.push("appData."+
b[d]);a.appData=b}},translateStandardArguments:function(a,b){a.first&&(b.startIndex=a.first);a.max&&(b.count=a.max);a.sortOrder&&(b.sortBy=a.sortOrder);a.filter&&(b.filterBy=a.filter);a.filterOp&&(b.filterOp=a.filterOp);a.filterValue&&(b.filterValue=a.filterValue);a.fields&&(b.fields=a.fields)},translateNetworkDistance:function(a,b){a.getField("networkDistance")&&(b.networkDistance=a.getField("networkDistance"))}}}();var JsonMediaItem=function(a){a=a||{};opensocial.MediaItem.call(this,a.mimeType,a.url,a)};JsonMediaItem.inherits(opensocial.MediaItem);JsonMediaItem.prototype.toJsonObject=function(){return JsonMediaItem.copyFields(this.fields_)};JsonMediaItem.copyFields=function(a){var c={},b;for(b in a)c[b]=a[b];return c};var JsonAlbum=function(a){a=a||{};JsonAlbum.constructObject(a,"location",opensocial.Address);opensocial.Album.call(this,a)};JsonAlbum.inherits(opensocial.Album);JsonAlbum.prototype.toJsonObject=function(){return JsonAlbum.copyFields(this.fields_)};JsonAlbum.constructObject=function(a,b,c){var d=a[b];d&&(a[b]=new c(d))};JsonAlbum.copyFields=function(a){var b={},c;for(c in a)b[c]=a[c];return b};var JsonActivity=function(a,b){a=a||{};b||JsonActivity.constructArrayObject(a,"mediaItems",JsonMediaItem);opensocial.Activity.call(this,a)};JsonActivity.inherits(opensocial.Activity);JsonActivity.prototype.toJsonObject=function(){for(var a=JsonActivity.copyFields(this.fields_),b=a.mediaItems||[],c=[],d=0;d<b.length;d++)c[d]=b[d].toJsonObject();a.mediaItems=c;return a};JsonActivity.constructArrayObject=function(a,b,c){if(a=a[b])for(b=0;b<a.length;b++)a[b]=new c(a[b])};
JsonActivity.copyFields=function(a){var b={},c;for(c in a)b[c]=a[c];return b};var JsonPerson=function(a){a=a||{};JsonPerson.constructObject(a,"bodyType",opensocial.BodyType);JsonPerson.constructObject(a,"currentLocation",opensocial.Address);JsonPerson.constructObject(a,"name",opensocial.Name);JsonPerson.constructObject(a,"profileSong",opensocial.Url);JsonPerson.constructObject(a,"profileVideo",opensocial.Url);JsonPerson.constructDate(a,"dateOfBirth");JsonPerson.constructArrayObject(a,"addresses",opensocial.Address);JsonPerson.constructArrayObject(a,"emails",opensocial.Email);
JsonPerson.constructArrayObject(a,"jobs",opensocial.Organization);JsonPerson.constructArrayObject(a,"phoneNumbers",opensocial.Phone);JsonPerson.constructArrayObject(a,"schools",opensocial.Organization);JsonPerson.constructArrayObject(a,"urls",opensocial.Url);JsonPerson.constructEnum(a,"gender");JsonPerson.constructEnum(a,"smoker");JsonPerson.constructEnum(a,"drinker");JsonPerson.constructEnum(a,"networkPresence");JsonPerson.constructEnumArray(a,"lookingFor");opensocial.Person.call(this,a,a.isOwner,
a.isViewer)};JsonPerson.inherits(opensocial.Person);JsonPerson.constructEnum=function(a,b){var c=a[b];c&&(a[b]=new opensocial.Enum(c.key,c.displayValue))};JsonPerson.constructEnumArray=function(a,b){var c=a[b];if(c)for(var d=0;d<c.length;d++)c[d]=new opensocial.Enum(c[d].key,c[d].displayValue)};JsonPerson.constructObject=function(a,b,c){var d=a[b];d&&(a[b]=new c(d))};JsonPerson.constructDate=function(a,b){var c=a[b];c&&(a[b]=FieldTranslations.translateIsoStringToDate(c))};
JsonPerson.constructArrayObject=function(a,b,c){if(a=a[b])for(b=0;b<a.length;b++)a[b]=new c(a[b])};JsonPerson.prototype.getDisplayName=function(){return this.getField("displayName")};JsonPerson.prototype.getAppData=function(a){var b=this.getField("appData");return b&&b[a]};var JsonMessageCollection=function(a){a=a||{};opensocial.MessageCollection.call(this,a)};JsonMessageCollection.inherits(opensocial.MessageCollection);JsonMessageCollection.prototype.toJsonObject=function(){return JsonMessageCollection.copyFields(this.fields_)};JsonMessageCollection.copyFields=function(a){var c={},b;for(b in a)c[b]=a[b];return c};var JsonMessage=function(b,a){a=a||{};opensocial.Message.call(this,b,a)};JsonMessage.inherits(opensocial.Message);JsonMessage.prototype.toJsonObject=function(){return JsonMessage.copyFields(this.fields_)};JsonMessage.copyFields=function(b){var a={},c;for(c in b)a[c]=b[c];return a};var JsonRpcContainer=function(d){opensocial.Container.call(this);this.path_=d.path.replace("%host%",document.location.host);this.invalidatePath_=d.invalidatePath.replace("%host%",document.location.host);var a=d.supportedFields,b={},c;for(c in a)if(a.hasOwnProperty(c)){b[c]={};for(var e=0;e<a[c].length;e++)b[c][a[c][e]]=!0}this.environment_=new opensocial.Environment(d.domain,b);this.useOAuth2=d.useOAuth2;this.securityToken_=shindig.auth.getSecurityToken();gadgets.rpc.register("shindig.requestShareApp_callback",
JsonRpcContainer.requestShareAppCallback_)},JsonRpcRequestItem=function(d,a){this.rpc=d;this.processData=a||function(a){return a};this.processResponse=function(a,c,e,f){var d=e?JsonRpcContainer.translateHttpError(e.code):null;return new opensocial.ResponseItem(a,e?null:this.processData(c),d,f)}};
(function(){var d={};JsonRpcContainer.inherits(opensocial.Container);JsonRpcContainer.prototype.getEnvironment=function(){return this.environment_};JsonRpcContainer.prototype.requestShareApp=function(a,b,c,e){e="cId_"+Math.random();d[e]=c;c=gadgets.util.unescapeString(b.getField(opensocial.Message.Field.BODY));if(!c||0===c.length)b=gadgets.util.unescapeString(b.getField(opensocial.Message.Field.BODY_ID)),c=gadgets.Prefs.getMsg(b);gadgets.rpc.call("..","shindig.requestShareApp",null,e,a,c)};JsonRpcContainer.requestShareAppCallback_=
function(a,b,c,e){if(".."===this.f&&(callback=d[a]))a=d[a]=null,e&&(a={recipientIds:e}),c=new opensocial.ResponseItem(null,a,c),callback(c)};JsonRpcContainer.prototype.requestCreateActivity=function(a,b,c){c=c||function(){};b=opensocial.newDataRequest();var e=opensocial.newIdSpec({userId:"VIEWER"});b.add(this.newCreateActivityRequest(e,a),"key");b.send(function(a){c(a.get("key"))})};JsonRpcContainer.prototype.requestData=function(a,b){b=b||function(){};var c=a.getRequestObjects(),e=c.length;if(0===
e)window.setTimeout(function(){b(new opensocial.DataResponse({},!0))},0);else{for(var f=Array(e),d=0;d<e;d++){var g=c[d];f[d]=g.request.rpc;g.key&&(f[d].id=g.key)}e={CONTENT_TYPE:"JSON",METHOD:"POST",AUTHORIZATION:"SIGNED",POST_DATA:gadgets.json.stringify(f)};f={"Content-Type":"application/json"};d=[this.path_];(g=shindig.auth.getSecurityToken())&&(this.useOAuth2?f.Authorization="OAuth2 "+g:f["X-Shindig-ST"]=g);this.sendRequest(d.join(""),function(a){if(a.errors[0])JsonRpcContainer.generateErrorResponse(a,
c,b);else{a=a.result||a.data;for(var e=!1,f={},d=0;d<a.length;d++)a[a[d].id]=a[d];for(d=0;d<c.length;d++){var k=c[d],h=a[d];if(k.key&&h.id!==k.key)throw"Request key("+k.key+") and response id("+h.id+") do not match";var g="undefined"!=typeof h.result?h.result:h.data,h=h.error,m="";h&&(m=h.message);g=k.request.processResponse(k.request,g,h,m);e=e||g.hadError();k.key&&(f[k.key]=g)}a=new opensocial.DataResponse(f,e);b(a)}},e,f)}};JsonRpcContainer.prototype.sendRequest=function(a,b,c,e){gadgets.io.makeNonProxiedRequest(a,
b,c,e)};JsonRpcContainer.generateErrorResponse=function(a,b,c){a=JsonRpcContainer.translateHttpError(a.rc||a.result.error||a.data.error)||opensocial.ResponseItem.Error.INTERNAL_ERROR;for(var e={},d=0;d<b.length;d++)e[b[d].key]=new opensocial.ResponseItem(b[d].request,null,a);c(new opensocial.DataResponse(e,!0))};JsonRpcContainer.translateHttpError=function(a){if(501==a)return opensocial.ResponseItem.Error.NOT_IMPLEMENTED;if(401==a)return opensocial.ResponseItem.Error.UNAUTHORIZED;if(403==a)return opensocial.ResponseItem.Error.FORBIDDEN;
if(400==a)return opensocial.ResponseItem.Error.BAD_REQUEST;if(500==a)return opensocial.ResponseItem.Error.INTERNAL_ERROR;if(404==a)return opensocial.ResponseItem.Error.BAD_REQUEST;if(417==a)return opensocial.ResponseItem.Error.LIMIT_EXCEEDED};JsonRpcContainer.prototype.makeIdSpec=function(a){return opensocial.newIdSpec({userId:a})};JsonRpcContainer.prototype.translateIdSpec=function(a){var b=a.getField("userId");a=a.getField("groupId");opensocial.Container.isArray(b)||(b=[b]);for(var c=0;c<b.length;c++)"OWNER"===
b[c]?b[c]="@owner":"VIEWER"===b[c]&&(b[c]="@viewer");if("FRIENDS"===a)a="@friends";else if("ALL"==a)a="@all";else if("SELF"===a||!a)a="@self";return{userId:b,groupId:a}};JsonRpcContainer.prototype.newFetchPersonRequest=function(a,b){var c=this.newFetchPeopleRequest(this.makeIdSpec(a),b),e=this;return new JsonRpcRequestItem(c.rpc,function(a){return e.createPersonFromJson(a,b)})};JsonRpcContainer.prototype.newFetchPeopleRequest=function(a,b){var c={method:"people.get"};c.params=this.translateIdSpec(a);
FieldTranslations.addAppDataAsProfileFields(b);FieldTranslations.translateStandardArguments(b,c.params);FieldTranslations.translateNetworkDistance(a,c.params);b.profileDetail&&(FieldTranslations.translateJsPersonFieldsToServerFields(b.profileDetail),c.params.fields=b.profileDetail);var e=this;return new JsonRpcRequestItem(c,function(a){var c;c=a.list?a.list:[a];for(var d=[],l=0;l<c.length;l++)d.push(e.createPersonFromJson(c[l],b));return new opensocial.Collection(d,a.startIndex,a.totalResults)})};
JsonRpcContainer.prototype.createPersonFromJson=function(a,b){FieldTranslations.translateServerPersonToJsPerson(a,b);return new JsonPerson(a)};JsonRpcContainer.prototype.getFieldsList=function(a){return this.hasNoKeys(a)||this.isWildcardKey(a[0])?[]:a};JsonRpcContainer.prototype.hasNoKeys=function(a){return!a||0===a.length};JsonRpcContainer.prototype.isWildcardKey=function(a){return"*"===a};JsonRpcContainer.prototype.newFetchPersonAppDataRequest=function(a,b,c){var e={method:"appdata.get"};e.params=
this.translateIdSpec(a);e.params.appId="@app";e.params.fields=this.getFieldsList(b);FieldTranslations.translateNetworkDistance(a,e.params);return new JsonRpcRequestItem(e,function(a){return opensocial.Container.escape(a,c,!0)})};JsonRpcContainer.prototype.newUpdatePersonAppDataRequest=function(a,b){var c={method:"appdata.update",params:{userId:["@viewer"],groupId:"@self"}};c.params.appId="@app";c.params.data={};c.params.data[a]=b;c.params.fields=a;return new JsonRpcRequestItem(c)};JsonRpcContainer.prototype.newRemovePersonAppDataRequest=
function(a){var b={method:"appdata.delete",params:{userId:["@viewer"],groupId:"@self"}};b.params.appId="@app";b.params.fields=this.getFieldsList(a);return new JsonRpcRequestItem(b)};JsonRpcContainer.prototype.newFetchActivitiesRequest=function(a,b){var c={method:"activities.get"};c.params=this.translateIdSpec(a);c.params.appId="@app";FieldTranslations.translateStandardArguments(b,c.params);FieldTranslations.translateNetworkDistance(a,c.params);return new JsonRpcRequestItem(c,function(a){a=a.list;
for(var c=[],b=0;b<a.length;b++)c.push(new JsonActivity(a[b]));return new opensocial.Collection(c)})};JsonRpcContainer.prototype.newActivity=function(a){return new JsonActivity(a,!0)};JsonRpcContainer.prototype.newAlbum=function(a){return new JsonAlbum(a)};JsonRpcContainer.prototype.newMediaItem=function(a,b,c){c=c||{};c.mimeType=a;c.url=b;return new JsonMediaItem(c)};JsonRpcContainer.prototype.newCreateActivityRequest=function(a,b){var c={method:"activities.create"};c.params=this.translateIdSpec(a);
c.params.appId="@app";FieldTranslations.translateNetworkDistance(a,c.params);c.params.activity=b.toJsonObject();return new JsonRpcRequestItem(c)};JsonRpcContainer.prototype.invalidateCache=function(){var a={CONTENT_TYPE:"JSON",METHOD:"POST",AUTHORIZATION:"SIGNED",POST_DATA:gadgets.json.stringify({method:"cache.invalidate",params:{invalidationKeys:["@viewer"]}})},b={"Content-Type":"application/json"},c=[this.invalidatePath_],e=shindig.auth.getSecurityToken();e&&(this.useOAuth2?b.Authorization="OAuth2 "+
e:b["X-Shindig-ST"]=e);this.sendRequest(c.join(""),null,a,b)}})();JsonRpcContainer.prototype.newMessage=function(d,a){return new JsonMessage(d,a)};JsonRpcContainer.prototype.newMessageCollection=function(d){return new JsonMessageCollection(d)};
JsonRpcContainer.prototype.newFetchMessageCollectionsRequest=function(d,a){var b={method:"messages.get"};b.params=this.translateIdSpec(d);FieldTranslations.translateStandardArguments(a,b.params);return new JsonRpcRequestItem(b,function(a){a=a.list;for(var b=[],d=0;d<a.length;d++)b.push(new JsonMessageCollection(a[d]));return new opensocial.Collection(b)})};
JsonRpcContainer.prototype.newFetchMessagesRequest=function(d,a,b){var c={method:"messages.get"};c.params=this.translateIdSpec(d);c.params.msgCollId=a;FieldTranslations.translateStandardArguments(b,c.params);return new JsonRpcRequestItem(c,function(a){a=a.list;for(var c=[],b=0;b<a.length;b++)c.push(new JsonMessage(a[b]));return new opensocial.Collection(c)})};
JsonRpcContainer.prototype.newCreateAlbumRequest=function(d,a){var b={method:"albums.create"};b.params=this.translateIdSpec(d);b.params.appId="@app";b.params.album=a.toJsonObject();return new JsonRpcRequestItem(b)};JsonRpcContainer.prototype.newDeleteAlbumRequest=function(d,a){var b={method:"albums.delete"};b.params=this.translateIdSpec(d);b.params.appId="@app";b.params.albumId=a;return new JsonRpcRequestItem(b)};
JsonRpcContainer.prototype.newFetchAlbumsRequest=function(d,a){var b={method:"albums.get"};b.params=this.translateIdSpec(d);b.params.appId="@app";FieldTranslations.translateStandardArguments(a,b.params);return new JsonRpcRequestItem(b,function(a){a=a.list;for(var b=[],d=0;d<a.length;d++)b.push(new JsonAlbum(a[d]));return new opensocial.Collection(b)})};
JsonRpcContainer.prototype.newCreateMediaItemRequest=function(d,a,b){var c={method:"mediaItems.create"};c.params=this.translateIdSpec(d);c.params.appId="@app";c.params.albumId=a;c.params.mediaItem=b.toJsonObject();return new JsonRpcRequestItem(c)};
JsonRpcContainer.prototype.newFetchMediaItemsRequest=function(d,a,b){var c={method:"mediaItems.get"};c.params=this.translateIdSpec(d);c.params.appId="@app";c.params.albumId=a;FieldTranslations.translateStandardArguments(b,c.params);return new JsonRpcRequestItem(c,function(a){a=a.list;for(var b=[],c=0;c<a.length;c++)b.push(new JsonMediaItem(a[c]));return new opensocial.Collection(b)})};var requiredConfig={path:gadgets.config.NonEmptyStringValidator,invalidatePath:gadgets.config.NonEmptyStringValidator,domain:gadgets.config.NonEmptyStringValidator,enableCaja:gadgets.config.BooleanValidator,supportedFields:gadgets.config.ExistsValidator};gadgets.config.register("opensocial",requiredConfig,function(a){ShindigContainer=function(){JsonRpcContainer.call(this,a.opensocial)};ShindigContainer.inherits(JsonRpcContainer);opensocial.Container.setContainer(new ShindigContainer)});var JSON=window.JSON||gadgets.json,_IG_Prefs=function(){var b=null,c=function(){b||(b=new gadgets.Prefs,b.setDontEscape_());return b};c._parseURL=gadgets.Prefs.parseUrl;return c}();function _IG_Fetch_wrapper(b,c){b(c.data?c.data:"")}function _IG_FetchContent(b,c,a){a=a||{};a.REFRESH_INTERVAL=a.refreshInterval?a.refreshInterval:3600;for(var e in a){var d=a[e];delete a[e];a[e.toUpperCase()]=d}c=gadgets.util.makeClosure(null,_IG_Fetch_wrapper,c);gadgets.io.makeRequest(b,c,a)}
function _IG_FetchXmlContent(b,c,a){a=a||{};a.REFRESH_INTERVAL=a.refreshInterval?a.refreshInterval:3600;a.CONTENT_TYPE="DOM";c=gadgets.util.makeClosure(null,_IG_Fetch_wrapper,c);gadgets.io.makeRequest(b,c,a)}
function _IG_FetchFeedAsJSON(b,c,a,e,d){d=d||{};d.CONTENT_TYPE="FEED";d.NUM_ENTRIES=a;d.GET_SUMMARIES=e;gadgets.io.makeRequest(b,function(a){a.data=a.data||{};a.errors&&0<a.errors.length&&(a.data.ErrorMsg=a.errors[0]);a.data.link&&(a.data.URL=b);a.data.title&&(a.data.Title=a.data.title);a.data.description&&(a.data.Description=a.data.description);a.data.link&&(a.data.Link=a.data.link);if(a.data.items&&0<a.data.items.length){a.data.Entry=a.data.items;for(var e=0;e<a.data.Entry.length;++e){var d=a.data.Entry[e];
d.Title=d.title;d.Link=d.link;d.Summary=d.summary||d.description;d.Date=d.pubDate}}for(e=0;e<a.data.Entry.length;++e)d=a.data.Entry[e],d.Date/=1E3;c(a.data)},d)}function _IG_GetCachedUrl(b,c){var a=c||{};a.REFRESH_INTERVAL=3600;a.refreshInterval&&(a.REFRESH_INTERVAL=a.refreshInterval);return gadgets.io.getProxyUrl(b,a)}function _IG_GetImageUrl(b,c){return _IG_GetCachedUrl(b,c)}function _IG_GetImage(b){var c=document.createElement("img");c.src=_IG_GetCachedUrl(b);return c}
function _IG_RegisterOnloadHandler(b){gadgets.util.registerOnLoadHandler(b)}function _IG_Callback(b,c){var a=arguments;return function(){var c=Array.prototype.slice.call(arguments);b.apply(null,c.concat(Array.prototype.slice.call(a,1)))}}var _args=gadgets.util.getUrlParameters;function _gel(b){return document.getElementById?document.getElementById(b):null}function _gelstn(b){return"*"===b&&document.all?document.all:document.getElementsByTagName?document.getElementsByTagName(b):[]}
function _gelsbyregex(b,c){for(var a=_gelstn(b),e=[],d=0,f=a.length;d<f;++d)c.test(a[d].id)&&e.push(a[d]);return e}function _esc(b){return window.encodeURIComponent?encodeURIComponent(b):escape(b)}function _unesc(b){return window.decodeURIComponent?decodeURIComponent(b):unescape(b)}function _hesc(b){return gadgets.util.escapeString(b)}function _striptags(b){return b.replace(/<\/?[^>]+>/g,"")}function _trim(b){return b.replace(/^\s+|\s+$/g,"")}
function _toggle(b){b="string"===typeof b?_gel(b):b;null!==b&&(0===b.style.display.length||"block"===b.style.display?b.style.display="none":"none"===b.style.display&&(b.style.display="block"))}var _uid=function(){var b=0;return function(){return b++}}();function _min(b,c){return b<c?b:c}function _max(b,c){return b>c?b:c}function _exportSymbols(b,c){for(var a=window,e=b.split("."),d=0,f=e.length;d<f;d++){var g=e[d];a[g]=a[g]||{};a=a[g]}e=0;for(d=c.length;e<d;e+=2)a[c[e]]=c[e+1]}
function _IG_AddDOMEventHandler(b,c,a){gadgets.warn("_IG_AddDOMEventHandler not implemented - see SHINDIG-198")};(function(){var n=null,e={f:{NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10},k:{"*::class":9,"*::dir":0,"*::id":4,"*::lang":0,"*::onclick":2,"*::ondblclick":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::onscroll":2,"*::style":3,"*::title":0,"a::accesskey":0,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,
"a::onblur":2,"a::onfocus":2,"a::rel":0,"a::rev":0,"a::shape":0,"a::tabindex":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,"area::href":1,"area::nohref":0,"area::onblur":2,"area::onfocus":2,"area::shape":0,"area::tabindex":0,"area::target":10,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::tabindex":0,"button::type":0,"button::value":0,"caja-v-body::alink":0,
"caja-v-body::background":1,"caja-v-body::bgcolor":0,"caja-v-body::link":0,"caja-v-body::onload":2,"caja-v-body::onunload":2,"caja-v-body::text":0,"caja-v-body::vlink":0,"caja-v-html::version":0,"canvas::height":0,"canvas::width":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,"colgroup::width":0,"del::cite":1,"del::datetime":0,"dir::compact":0,
"div::align":0,"dl::compact":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::onreset":2,"form::onsubmit":2,"form::target":10,"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"iframe::align":0,"iframe::frameborder":0,"iframe::height":0,"iframe::marginheight":0,"iframe::marginwidth":0,"iframe::width":0,
"img::align":0,"img::alt":0,"img::border":0,"img::height":0,"img::hspace":0,"img::ismap":0,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::align":0,"input::alt":0,"input::autocomplete":0,"input::checked":0,"input::disabled":0,"input::ismap":0,"input::maxlength":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::readonly":0,"input::size":0,"input::src":1,"input::tabindex":0,
"input::type":0,"input::usemap":11,"input::value":0,"ins::cite":1,"ins::datetime":0,"label::accesskey":0,"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"ol::compact":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"p::align":0,"pre::width":0,"q::cite":1,"select::disabled":0,"select::multiple":0,
"select::name":8,"select::onblur":2,"select::onchange":2,"select::onfocus":2,"select::size":0,"select::tabindex":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,
"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,"textarea::accesskey":0,"textarea::cols":0,"textarea::disabled":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::readonly":0,"textarea::rows":0,"textarea::tabindex":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,
"th::rowspan":0,"th::scope":0,"th::valign":0,"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"ul::compact":0,"ul::type":0},d:{OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128,VIRTUALIZED:256},e:{a:0,abbr:0,acronym:0,address:0,applet:16,area:2,article:16,aside:16,audio:16,b:0,base:18,basefont:18,bdi:16,bdo:0,big:0,blockquote:0,body:305,br:2,button:0,"caja-v-body":1,
"caja-v-head":1,"caja-v-html":1,"caja-v-title":0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,data:16,datalist:16,dd:1,del:0,details:16,dfn:0,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,figcaption:16,figure:16,font:0,footer:16,form:0,frame:18,frameset:16,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:305,header:16,hgroup:16,hr:2,html:305,i:0,iframe:4,img:2,input:2,ins:0,isindex:18,kbd:0,label:0,legend:0,li:1,link:18,map:0,mark:16,menu:0,meta:18,meter:16,nav:0,nobr:0,noembed:4,noframes:20,noscript:20,
object:16,ol:0,optgroup:0,option:1,output:16,p:1,param:18,pre:0,progress:16,q:0,s:0,samp:0,script:84,section:16,select:0,small:0,span:0,strike:0,strong:0,style:148,sub:0,summary:16,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,time:16,title:280,tr:1,tt:0,u:0,ul:0,"var":0,video:16},A:{NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2},w:{"a::href":2,"area::href":2,"blockquote::cite":0,"body::background":1,"caja-v-body::background":1,"del::cite":0,"form::action":2,"img::src":1,"input::src":1,
"ins::cite":0,"q::cite":0},z:{UNSANDBOXED:2,SANDBOXED:1,DATA:0},v:{"a::href":2,"area::href":2,"blockquote::cite":2,"body::background":1,"caja-v-body::background":1,"del::cite":2,"form::action":2,"img::src":1,"input::src":1,"ins::cite":2,"q::cite":2}};e.ATTRIBS=e.k;e.ELEMENTS=e.e;e.URIEFFECTS=e.w;e.LOADERTYPES=e.v;e.atype=e.f;e.eflags=e.d;e.ltypes=e.z;e.ueffects=e.A;"undefined"!==typeof window&&(window.html4=e);var e=function(l){function e(a,d){var b;b=d.toLowerCase();if(x.hasOwnProperty(b))b=x[b];
else{var g=b.match(s);b=g?String.fromCharCode(parseInt(g[1],10)):(g=b.match(U))?String.fromCharCode(parseInt(g[1],16)):""}return b}function y(a){return a.replace(V,e)}function B(a){return(""+a).replace(W,"\x26amp;").replace(C,"\x26lt;").replace(D,"\x26gt;").replace(X,"\x26#34;")}function E(a){return a.replace(Y,"\x26amp;$1").replace(C,"\x26lt;").replace(D,"\x26gt;")}function F(a){var d={l:a.l||a.cdata,m:a.m||a.comment,n:a.n||a.endDoc,h:a.h||a.endTag,c:a.c||a.pcdata,r:a.r||a.rcdata,t:a.t||a.startDoc,
j:a.j||a.startTag};return function(a,g){var c,m=/(<\/|<\!--|<[!?]|[&<>])/g;c=a+"";if(Z)c=c.split(m);else{for(var f=[],h=0,l;(l=m.exec(c))!==n;)f.push(c.substring(h,l.index)),f.push(l[0]),h=l.index+l[0].length;f.push(c.substring(h));c=f}G(d,c,0,{g:!1,o:!1},g)}}function q(a,d,b,g,c){return function(){G(a,d,b,g,c)}}function G(a,d,b,g,c){try{a.t&&0==b&&a.t(c);for(var m,f,h,t=d.length;b<t;){var H=d[b++],k=d[b];switch(H){case "\x26":$.test(k)?(a.c&&a.c("\x26"+k,c,p,q(a,d,b,g,c)),b++):a.c&&a.c("\x26amp;",
c,p,q(a,d,b,g,c));break;case "\x3c/":if(m=/^([-\w:]+)[^\'\"]*/.exec(k))if(m[0].length===k.length&&"\x3e"===d[b+1])b+=2,h=m[1].toLowerCase(),a.h&&a.h(h,c,p,q(a,d,b,g,c));else{var e=d,n=b,u=a,r=c,A=p,z=g,w=I(e,n);w?(u.h&&u.h(w.name,r,A,q(u,e,n,z,r)),b=w.next):b=e.length}else a.c&&a.c("\x26lt;/",c,p,q(a,d,b,g,c));break;case "\x3c":if(m=/^([-\w:]+)\s*\/?/.exec(k))if(m[0].length===k.length&&"\x3e"===d[b+1]){b+=2;h=m[1].toLowerCase();a.j&&a.j(h,[],c,p,q(a,d,b,g,c));var s=l.e[h];s&J&&(b=K(d,{name:h,next:b,
d:s},a,c,p,g))}else{var e=d,n=a,u=c,r=p,A=g,v=I(e,b);v?(n.j&&n.j(v.name,v.B,u,r,q(n,e,v.next,A,u)),b=v.d&J?K(e,v,n,u,r,A):v.next):b=e.length}else a.c&&a.c("\x26lt;",c,p,q(a,d,b,g,c));break;case "\x3c!--":if(!g.o){for(f=b+1;f<t&&!("\x3e"===d[f]&&/--$/.test(d[f-1]));f++);if(f<t){if(a.m){var x=d.slice(b,f).join("");a.m(x.substr(0,x.length-2),c,p,q(a,d,f+1,g,c))}b=f+1}else g.o=!0}g.o&&a.c&&a.c("\x26lt;!--",c,p,q(a,d,b,g,c));break;case "\x3c!":if(/^\w/.test(k)){if(!g.g){for(f=b+1;f<t&&"\x3e"!==d[f];f++);
f<t?b=f+1:g.g=!0}g.g&&a.c&&a.c("\x26lt;!",c,p,q(a,d,b,g,c))}else a.c&&a.c("\x26lt;!",c,p,q(a,d,b,g,c));break;case "\x3c?":if(!g.g){for(f=b+1;f<t&&"\x3e"!==d[f];f++);f<t?b=f+1:g.g=!0}g.g&&a.c&&a.c("\x26lt;?",c,p,q(a,d,b,g,c));break;case "\x3e":a.c&&a.c("\x26gt;",c,p,q(a,d,b,g,c));break;case "":break;default:a.c&&a.c(H,c,p,q(a,d,b,g,c))}}a.n&&a.n(c)}catch(y){if(y!==p)throw y;}}function K(a,d,b,g,c,m){var f=a.length;z.hasOwnProperty(d.name)||(z[d.name]=RegExp("^"+d.name+"(?:[\\s\\/]|$)","i"));for(var h=
z[d.name],k=d.next,e=d.next+1;e<f&&!("\x3c/"===a[e-1]&&h.test(a[e]));e++);e<f&&(e-=1);f=a.slice(k,e).join("");if(d.d&l.d.CDATA)b.l&&b.l(f,g,c,q(b,a,e,m,g));else if(d.d&l.d.RCDATA)b.r&&b.r(E(f),g,c,q(b,a,e,m,g));else throw Error("bug");return e}function I(a,d){var b=/^([-\w:]+)/.exec(a[d]),g={};g.name=b[1].toLowerCase();g.d=l.e[g.name];for(var c=a[d].substr(b[0].length),m=d+1,f=a.length;m<f&&"\x3e"!==a[m];m++)c+=a[m];if(!(f<=m)){for(var h=[];""!==c;)if(b=aa.exec(c))if(b[4]&&!b[5]||b[6]&&!b[7]){for(var b=
b[4]||b[6],e=!1,c=[c,a[m++]];m<f;m++){if(e){if("\x3e"===a[m])break}else 0<=a[m].indexOf(b)&&(e=!0);c.push(a[m])}if(f<=m)break;c=c.join("")}else{var e=b[1].toLowerCase(),k;if(b[2]){k=b[3];var n=k.charCodeAt(0);if(34===n||39===n)k=k.substr(1,k.length-2);k=y(k.replace(ba,""))}else k=e;h.push(e,k);c=c.substr(b[0].length)}else c=c.replace(/^[\s\S][^a-z\s]*/,"");g.B=h;g.next=m+1;return g}}function L(a){function d(a,b){g||b.push(a)}var b,g;return F({startDoc:function(){b=[];g=!1},startTag:function(c,d,f){if(!g&&
l.e.hasOwnProperty(c)){var h=l.e[c];if(!(h&l.d.FOLDABLE))if(d=a(c,d)){h&l.d.EMPTY||b.push(c);f.push("\x3c",c);c=0;for(h=d.length;c<h;c+=2){var e=d[c],k=d[c+1];k!==n&&void 0!==k&&f.push(" ",e,'\x3d"',B(k),'"')}f.push("\x3e")}else g=!(h&l.d.EMPTY)}},endTag:function(a,d){if(g)g=!1;else if(l.e.hasOwnProperty(a)){var f=l.e[a];if(!(f&(l.d.EMPTY|l.d.FOLDABLE))){if(f&l.d.OPTIONAL_ENDTAG)for(f=b.length;0<=--f;){var h=b[f];if(h===a)break;if(!(l.e[h]&l.d.OPTIONAL_ENDTAG))return}else for(f=b.length;0<=--f&&b[f]!==
a;);if(!(0>f)){for(var e=b.length;--e>f;)h=b[e],l.e[h]&l.d.OPTIONAL_ENDTAG||d.push("\x3c/",h,"\x3e");b.length=f;d.push("\x3c/",a,"\x3e")}}}},pcdata:d,rcdata:d,cdata:d,endDoc:function(a){for(;b.length;b.length--)a.push("\x3c/",b[b.length-1],"\x3e")}})}function M(a,d,b,g,c){if(!c)return n;var e=(""+a).match(ca);return e&&(!e[1]||da.test(e[1]))?c(a,d,b,g):n}function r(a,d,b,g,c){b||a(d+" removed",{C:"removed",tagName:d});if(g!==c){var e="changed";g&&!c?e="removed":!g&&c&&(e="added");a(d+"."+b+" "+e,
{C:e,tagName:d,G:b,oldValue:g,newValue:c})}}function N(a,d,b){d=d+"::"+b;if(a.hasOwnProperty(d))return a[d];d="*::"+b;if(a.hasOwnProperty(d))return a[d]}function O(a,d,b,g,c){for(var e=0;e<d.length;e+=2){var f=d[e],h=d[e+1],k=h,q=n,p;if((p=a+"::"+f,l.k.hasOwnProperty(p))||(p="*::"+f,l.k.hasOwnProperty(p)))q=l.k[p];if(q!==n)switch(q){case l.f.NONE:break;case l.f.SCRIPT:h=n;c&&r(c,a,f,k,h);break;case l.f.STYLE:if("undefined"===typeof w){h=n;c&&r(c,a,f,k,h);break}var s=[];w(h,{H:function(a,c){var d=
a.toLowerCase(),e=P[d];e&&(Q(d,e,c,b?function(a){return M(a,l.A.D,l.z.F,{TYPE:"CSS",CSS_PROP:d},b)}:n),s.push(a+": "+c.join(" ")))}});h=0<s.length?s.join(" ; "):n;c&&r(c,a,f,k,h);break;case l.f.ID:case l.f.IDREF:case l.f.IDREFS:case l.f.GLOBAL_NAME:case l.f.LOCAL_NAME:case l.f.CLASSES:h=g?g(h):h;c&&r(c,a,f,k,h);break;case l.f.URI:h=M(h,N(l.w,a,f),N(l.v,a,f),{TYPE:"MARKUP",XML_ATTR:f,XML_TAG:a},b);c&&r(c,a,f,k,h);break;case l.f.URI_FRAGMENT:h&&"#"===h.charAt(0)?(h=h.substring(1),h=g?g(h):h,h!==n&&
void 0!==h&&(h="#"+h)):h=n;c&&r(c,a,f,k,h);break;default:h=n,c&&r(c,a,f,k,h)}else h=n,c&&r(c,a,f,k,h);d[e+1]=h}return d}function R(a,d,b){return function(e,c){if(l.e[e]&l.d.UNSAFE)b&&r(b,e,void 0,void 0,void 0);else return O(e,c,a,d,b)}}function S(a,d){var b=[];L(d)(a,b);return b.join("")}var w,Q,P;"undefined"!==typeof window&&(w=window.parseCssDeclarations,Q=window.sanitizeCssProperty,P=window.cssSchema);var x={lt:"\x3c",gt:"\x3e",amp:"\x26",nbsp:"\u00a0",quot:'"',apos:"'"},s=/^#(\d+)$/,U=/^#x([0-9A-Fa-f]+)$/,
ba=/\0/g,V=/&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g,$=/^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/,W=/&/g,Y=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,C=/[<]/g,D=/>/g,X=/\"/g,aa=/^\s*([-.:\w]+)(?:\s*(=)\s*((")[^"]*("|$)|(')[^']*('|$)|(?=[a-z][-\w]*\s*=)|[^"'\s]*))?/i,Z=3==="a,b".split(/(,)/).length,J=l.d.CDATA|l.d.RCDATA,p={},z={},T=/^caja-v-(.*)$/i,ca=/^(?:([^:/?# ]+):)?/,da=/^(?:https?|mailto)$/i,k={};k.I=k.escapeAttrib=B;k.K=k.makeHtmlSanitizer=L;k.L=k.makeSaxParser=F;k.M=k.makeTagPolicy=R;k.N=k.normalizeRCData=
E;k.P=k.sanitize=function(a,d,b,e){return S(a,R(d,b,e))};k.Q=k.sanitizeAttribs=O;k.R=k.sanitizeWithPolicy=S;k.S=k.unescapeEntities=y;k.J=k.isVirtualizedElementName=function(a){return T.test(a)};k.O=k.realToVirtualElementName=function(a){var d=T.exec(a);return d?d[1]:a};k.T=k.virtualToRealElementName=function(a){return Object.prototype.hasOwnProperty.call(l.e,a)&&l.e[a]&l.d.VIRTUALIZED?"caja-v-"+a:a};return k}(e),s=e.sanitize;"undefined"!==typeof window&&(window.html=e,window.html_sanitize=s)})();window['___jsl']['l'] = (window['___jsl']['l'] || []).concat(['core','opensocial','rpc','shindig.uri']);