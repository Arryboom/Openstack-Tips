window,define(["jquery","lodash","chrome_lib","nimbus/tour","jsUri"],function(a,o,t,s,e){var i=3e3;function r(){var a=t.store.local.get("dismissedToasts");return a||(t.store.local.set("dismissedToasts",[]),a=t.store.local.get("dismissedToasts")),a}function d(o){var s=o.attr("id");o.find(".btn, button, .close").on("click",function(i){o.removeClass("show");var d,n,l=a(this),c=l.attr("href");new e(c),new e(window.location.href),(l.hasClass("close")||l.hasClass("dismiss")||l.hasClass("done"))&&(i.preventDefault(),"autotoast"===o.attr("data-action")&&(d=s,(n=r()).push(d),t.store.local.set("dismissedToasts",n)),l.hasClass("done")&&c&&(window.location.href=c))})}function n(a){a.addClass("show")}function l(o,t){var s=a("body");o.on("click",function(s){s.preventDefault(),function(o,t){var s=a("body"),e=o.attr("title"),i="",r=!1;if(null!==t.match(/\.(jpeg|jpg|gif|png)/))i='<img src="'+t+'" alt="'+e+'">',r=!0;else{var d=t.match(/youtube\.com\/(watch\?v=|embed\/)(\w*)[\&\?](.*\=.*)/);if(null!=d){var n=o.attr("data-aspect-ratio");void 0==n&&(n="16:9"),i='<div class="video-wrapper" data-aspect-ratio="'+n+'"><iframe width="560" height="315" src="https://www.youtube.com/embed/'+d[2]+"?"+d[3]+'&rel=0" target="_parent" frameborder="0" allowfullscreen></iframe></div>',r=!0}}r&&(s.addClass("zoom-open"),s.append('<div class="zoom-modal in" tabindex="-1" role="dialog"><div class="zoom-wrap"><button type="button" class="close" aria-hidden="true">Ã—</button><div class="zoom-body">'+i+"</div></div></div>"),s.append('<div class="zoom-backdrop in"></div>'))}(o,t)}),s.on("click",function(o){var t=a(o.target),e=t.attr("class");("close"===e&&t.parent().hasClass("zoom-wrap")||"zoom-modal in"===e||"zoom-backdrop in"===e)&&(a(".zoom-modal, .zoom-backdrop").remove(),s.removeClass("zoom-open"))})}a("[data-action]").each(function(){var t,s,e,c,m,p,u=a(this),f=u.attr("data-action");"toast"===f?(t=a(u.attr("href")),s=t,u.on("click",function(a){a.preventDefault(),n(s)}),d(s)):"autotoast"===f?(e=u,c=r(),m=e.attr("id"),p=e.attr("data-toast-delay")||i,-1===c.indexOf(m)&&o.delay(o.partial(n,e),p),d(e)):"zoom"===f?(href=u.attr("href"),l(u,href)):"modal"===f&&function(){a("[data-cp-modal-target]").on("click",function(o){o.preventDefault();var t=a(a(this).attr("data-cp-modal-target"));t.addClass("in"),t.next(".cp-modal-backdrop").addClass("in")});var o=a("body");o.on("click",function(t){var s=a(t.target),e=s.attr("class");(s.hasClass("cp-modal-close")||"cp-modal in"===e||"cp-modal-backdrop in"===e)&&(a(".cp-modal, .cp-modal-backdrop").removeClass("in"),o.removeClass("cp-modal-open"))})}()})});
//# sourceMappingURL=data-action.js.map